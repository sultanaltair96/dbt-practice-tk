[0m23:36:58.270724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019319DE31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931B198C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931B198A90>]}


============================== 23:36:58.274661 | aadc16c5-ad23-47e8-ade0-c5c66a3c98e9 ==============================
[0m23:36:58.274661 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:36:58.275661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:36:58.751833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aadc16c5-ad23-47e8-ade0-c5c66a3c98e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019317273490>]}
[0m23:36:58.861282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aadc16c5-ad23-47e8-ade0-c5c66a3c98e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931A84B880>]}
[0m23:36:58.884800 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:36:59.174137 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:36:59.176160 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:36:59.176160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aadc16c5-ad23-47e8-ade0-c5c66a3c98e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931B3E5CF0>]}
[0m23:37:01.797242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aadc16c5-ad23-47e8-ade0-c5c66a3c98e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931CA6D900>]}
[0m23:37:01.895754 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:37:01.898762 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:37:01.926764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aadc16c5-ad23-47e8-ade0-c5c66a3c98e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931CA64B50>]}
[0m23:37:01.927756 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 428 macros
[0m23:37:01.928757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aadc16c5-ad23-47e8-ade0-c5c66a3c98e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931CA39ED0>]}
[0m23:37:01.930753 [info ] [MainThread]: 
[0m23:37:01.930753 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:37:01.931754 [info ] [MainThread]: 
[0m23:37:01.931754 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:37:01.933764 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla'
[0m23:37:02.735933 [debug] [ThreadPool]: Using duckdb connection "list_tesla"
[0m23:37:02.735933 [debug] [ThreadPool]: On list_tesla: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla"'
    
  
  
[0m23:37:02.736932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:08.766493 [debug] [ThreadPool]: SQL status: OK in 6.029 seconds
[0m23:37:08.768493 [debug] [ThreadPool]: On list_tesla: Close
[0m23:37:08.769493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla, now create_tesla_main)
[0m23:37:08.769493 [debug] [ThreadPool]: Creating schema "database: "tesla"
schema: "main"
"
[0m23:37:08.775499 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:37:08.775499 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla'
        and type='sqlite'
    
  
[0m23:37:08.776499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:08.777499 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:08.778503 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:37:08.778503 [debug] [ThreadPool]: On create_tesla_main: BEGIN
[0m23:37:08.779499 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:08.779499 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:37:08.780503 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
    
        create schema if not exists "tesla"."main"
    
[0m23:37:08.781758 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:08.781758 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:37:08.782764 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:37:08.782764 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:37:08.783763 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:08.783763 [debug] [ThreadPool]: On create_tesla_main: Close
[0m23:37:08.789294 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:37:08.794281 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:37:08.795281 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:37:08.795281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:08.796281 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:08.796281 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:37:08.796281 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:37:08.812300 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m23:37:08.814303 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:37:08.815299 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:37:08.815299 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:37:08.816300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aadc16c5-ad23-47e8-ade0-c5c66a3c98e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931C998EB0>]}
[0m23:37:08.817299 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:08.817299 [debug] [MainThread]: On master: BEGIN
[0m23:37:08.817299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:08.818299 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:37:08.818299 [debug] [MainThread]: On master: COMMIT
[0m23:37:08.819299 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:08.819299 [debug] [MainThread]: On master: COMMIT
[0m23:37:08.819299 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:37:08.820412 [debug] [MainThread]: On master: Close
[0m23:37:08.852454 [debug] [Thread-1 (]: Began running node seed.project_tesla.tesla_results
[0m23:37:08.853456 [info ] [Thread-1 (]: 1 of 1 START seed file main.tesla_results ...................................... [RUN]
[0m23:37:08.854471 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.project_tesla.tesla_results'
[0m23:37:08.854471 [debug] [Thread-1 (]: Began compiling node seed.project_tesla.tesla_results
[0m23:37:08.855465 [debug] [Thread-1 (]: Began executing node seed.project_tesla.tesla_results
[0m23:37:34.749511 [debug] [Thread-1 (]: Using duckdb connection "seed.project_tesla.tesla_results"
[0m23:37:34.750516 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: BEGIN
[0m23:37:34.750516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:37:34.752512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:34.752512 [debug] [Thread-1 (]: Using duckdb connection "seed.project_tesla.tesla_results"
[0m23:37:34.753516 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "seed.project_tesla.tesla_results"} */

    create table "tesla"."main"."tesla_results" ("country" text,"trim_name" text,"in_transit" boolean,"cpo_refurbishment_status" text,"city" text,"country_code" text,"country_of_origin" text,"model" text,"year" int,"vin" text,"price" float,"color" text,"original_delivery_date" timestamp without time zone,"odometer" float,"title_sub_type" text,"vrl_name" text,"battery_warranty_exp_date" timestamp without time zone,"warranty_battery_is_expired" boolean,"vehicle_history" text,"odometer_type" text,"current_time" timestamp without time zone)
  
[0m23:37:34.757568 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:37:34.779512 [debug] [Thread-1 (]: Using duckdb connection "seed.project_tesla.tesla_results"
[0m23:37:34.780515 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: 
          COPY "tesla"."main"."tesla_results" FROM 'C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\seeds\tesla_results.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m23:37:35.020756 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: 
          COPY "tesla"."main"."tesla_results" FROM 'C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\seeds\tesla_results.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m23:37:35.021757 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:37:35.022756 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: ROLLBACK
[0m23:37:35.047755 [debug] [Thread-1 (]: Failed to rollback 'seed.project_tesla.tesla_results'
[0m23:37:35.048755 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: Close
[0m23:37:35.066755 [debug] [Thread-1 (]: Runtime Error in seed tesla_results (seeds\tesla_results.csv)
  Conversion Error: CSV Error on Line: 33837
  Original Line: Austria,{'DE': {'de': 'Performance Allradantrieb'}},False,Complete,Salzburg,AT,DE,my,2022,XP7YGCEL7NB011488,{'DE': 43500},['WHITE'],2022-06-29T00:00:00,41765,['FIRSTREG'],Salzburg,2030-06-29T00:00:00Z,False,CLEAN,Km,2025-02-17 17:10:02
  Error when converting column "price". Could not convert string "{'DE': 43500}" to 'FLOAT'
  
  Column price is being converted as type FLOAT
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\seeds\tesla_results.csv
    delimiter = , (Set By User)
    quote = " (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 8 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 10 Set type: FLOAT Sniffed type: BIGINT
  Column at position: 13 Set type: FLOAT Sniffed type: BIGINT
  Column at position: 16 Set type: TIMESTAMP Sniffed type: TIMESTAMP WITH TIME ZONE
  
  
[0m23:37:35.069754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aadc16c5-ad23-47e8-ade0-c5c66a3c98e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931729DA80>]}
[0m23:37:35.070755 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file main.tesla_results .............................. [[31mERROR[0m in 26.21s]
[0m23:37:35.072755 [debug] [Thread-1 (]: Finished running node seed.project_tesla.tesla_results
[0m23:37:35.072755 [debug] [Thread-7 (]: Marking all children of 'seed.project_tesla.tesla_results' to be skipped because of status 'error'.  Reason: Runtime Error in seed tesla_results (seeds\tesla_results.csv)
  Conversion Error: CSV Error on Line: 33837
  Original Line: Austria,{'DE': {'de': 'Performance Allradantrieb'}},False,Complete,Salzburg,AT,DE,my,2022,XP7YGCEL7NB011488,{'DE': 43500},['WHITE'],2022-06-29T00:00:00,41765,['FIRSTREG'],Salzburg,2030-06-29T00:00:00Z,False,CLEAN,Km,2025-02-17 17:10:02
  Error when converting column "price". Could not convert string "{'DE': 43500}" to 'FLOAT'
  
  Column price is being converted as type FLOAT
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\seeds\tesla_results.csv
    delimiter = , (Set By User)
    quote = " (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 8 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 10 Set type: FLOAT Sniffed type: BIGINT
  Column at position: 13 Set type: FLOAT Sniffed type: BIGINT
  Column at position: 16 Set type: TIMESTAMP Sniffed type: TIMESTAMP WITH TIME ZONE
  
  .
[0m23:37:35.075766 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:35.075766 [debug] [MainThread]: On master: BEGIN
[0m23:37:35.076755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:35.077770 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:37:35.078756 [debug] [MainThread]: On master: COMMIT
[0m23:37:35.078756 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:35.078756 [debug] [MainThread]: On master: COMMIT
[0m23:37:35.079755 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:37:35.080756 [debug] [MainThread]: On master: Close
[0m23:37:35.080756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:35.081754 [debug] [MainThread]: Connection 'create_tesla_main' was properly closed.
[0m23:37:35.081754 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:37:35.082756 [debug] [MainThread]: Connection 'seed.project_tesla.tesla_results' was properly closed.
[0m23:37:35.082756 [info ] [MainThread]: 
[0m23:37:35.083756 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 33.15 seconds (33.15s).
[0m23:37:35.084758 [debug] [MainThread]: Command end result
[0m23:37:35.119957 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:37:35.122918 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:37:35.134702 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:37:35.135220 [info ] [MainThread]: 
[0m23:37:35.136258 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:37:35.136808 [info ] [MainThread]: 
[0m23:37:35.137880 [error] [MainThread]: [31mFailure in seed tesla_results (seeds\tesla_results.csv)[0m
[0m23:37:35.138974 [error] [MainThread]:   Runtime Error in seed tesla_results (seeds\tesla_results.csv)
  Conversion Error: CSV Error on Line: 33837
  Original Line: Austria,{'DE': {'de': 'Performance Allradantrieb'}},False,Complete,Salzburg,AT,DE,my,2022,XP7YGCEL7NB011488,{'DE': 43500},['WHITE'],2022-06-29T00:00:00,41765,['FIRSTREG'],Salzburg,2030-06-29T00:00:00Z,False,CLEAN,Km,2025-02-17 17:10:02
  Error when converting column "price". Could not convert string "{'DE': 43500}" to 'FLOAT'
  
  Column price is being converted as type FLOAT
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\seeds\tesla_results.csv
    delimiter = , (Set By User)
    quote = " (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 8 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 10 Set type: FLOAT Sniffed type: BIGINT
  Column at position: 13 Set type: FLOAT Sniffed type: BIGINT
  Column at position: 16 Set type: TIMESTAMP Sniffed type: TIMESTAMP WITH TIME ZONE
  
  
[0m23:37:35.139547 [info ] [MainThread]: 
[0m23:37:35.140649 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:37:35.142329 [debug] [MainThread]: Command `dbt seed` failed at 23:37:35.141730 after 36.98 seconds
[0m23:37:35.142832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019319DE31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931CC876D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931A111870>]}
[0m23:37:35.143374 [debug] [MainThread]: Flushing usage events
[0m23:37:35.567213 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:17.272924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE9AAC31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE9BE88C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE9BE88A90>]}


============================== 23:38:17.277928 | 23c8caec-d30c-40fb-8b04-5bb3448494d4 ==============================
[0m23:38:17.277928 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:38:17.278928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:38:17.653502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23c8caec-d30c-40fb-8b04-5bb3448494d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE97F53490>]}
[0m23:38:17.741514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23c8caec-d30c-40fb-8b04-5bb3448494d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE9B52B880>]}
[0m23:38:17.746516 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:38:17.966690 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:38:18.112077 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:38:18.113077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23c8caec-d30c-40fb-8b04-5bb3448494d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE9BF579A0>]}
[0m23:38:19.160623 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tesla_vehicles (models\staging\stg_tesla_vehicles.sql)
  tag name expected
    line 26
      when price like '{%' then
[0m23:38:19.162380 [debug] [MainThread]: Command `dbt seed` failed at 23:38:19.162380 after 2.01 seconds
[0m23:38:19.163385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE9AAC31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE9D573A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE9D570FD0>]}
[0m23:38:19.163385 [debug] [MainThread]: Flushing usage events
[0m23:38:19.532961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:39.880944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED1DD3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED4160CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED4160AC0>]}


============================== 23:38:39.884950 | 2675abad-1e67-4b27-b2c2-7e68e52146fd ==============================
[0m23:38:39.884950 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:38:39.885941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:38:40.256287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2675abad-1e67-4b27-b2c2-7e68e52146fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED40C7EB0>]}
[0m23:38:40.350808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2675abad-1e67-4b27-b2c2-7e68e52146fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED411E590>]}
[0m23:38:40.353818 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:38:40.585294 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:38:40.734854 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:38:40.735847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2675abad-1e67-4b27-b2c2-7e68e52146fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED380A650>]}
[0m23:38:42.295699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2675abad-1e67-4b27-b2c2-7e68e52146fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED589F700>]}
[0m23:38:42.393157 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:38:42.395157 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:38:42.425155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2675abad-1e67-4b27-b2c2-7e68e52146fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED56AC370>]}
[0m23:38:42.426166 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 428 macros
[0m23:38:42.426166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2675abad-1e67-4b27-b2c2-7e68e52146fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED4260C70>]}
[0m23:38:42.428162 [info ] [MainThread]: 
[0m23:38:42.429160 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:38:42.430157 [info ] [MainThread]: 
[0m23:38:42.431156 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:38:42.432166 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla'
[0m23:38:42.512704 [debug] [ThreadPool]: Using duckdb connection "list_tesla"
[0m23:38:42.513242 [debug] [ThreadPool]: On list_tesla: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla"'
    
  
  
[0m23:38:42.513771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:43.201631 [debug] [ThreadPool]: SQL status: OK in 0.688 seconds
[0m23:38:43.203620 [debug] [ThreadPool]: On list_tesla: Close
[0m23:38:43.204476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla, now create_tesla_main)
[0m23:38:43.204476 [debug] [ThreadPool]: Creating schema "database: "tesla"
schema: "main"
"
[0m23:38:43.210557 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:38:43.210557 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla'
        and type='sqlite'
    
  
[0m23:38:43.211515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:43.212513 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:38:43.213489 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:38:43.213489 [debug] [ThreadPool]: On create_tesla_main: BEGIN
[0m23:38:43.214489 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:38:43.214489 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:38:43.215503 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
    
        create schema if not exists "tesla"."main"
    
[0m23:38:43.215503 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:38:43.216486 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:38:43.216486 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:38:43.217487 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:38:43.217487 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:38:43.218495 [debug] [ThreadPool]: On create_tesla_main: Close
[0m23:38:43.223357 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:38:43.228410 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:38:43.228410 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:38:43.229392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:43.230290 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:38:43.230290 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:38:43.230290 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:38:43.242353 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m23:38:43.243290 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:38:43.245059 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:38:43.245059 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:38:43.246376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2675abad-1e67-4b27-b2c2-7e68e52146fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED56AC340>]}
[0m23:38:43.246376 [debug] [MainThread]: Using duckdb connection "master"
[0m23:38:43.247466 [debug] [MainThread]: On master: BEGIN
[0m23:38:43.247466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:43.248382 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:38:43.248382 [debug] [MainThread]: On master: COMMIT
[0m23:38:43.249380 [debug] [MainThread]: Using duckdb connection "master"
[0m23:38:43.249380 [debug] [MainThread]: On master: COMMIT
[0m23:38:43.250380 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:38:43.250380 [debug] [MainThread]: On master: Close
[0m23:38:43.254882 [debug] [Thread-1 (]: Began running node seed.project_tesla.tesla_results
[0m23:38:43.255883 [info ] [Thread-1 (]: 1 of 1 START seed file main.tesla_results ...................................... [RUN]
[0m23:38:43.256882 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.project_tesla.tesla_results'
[0m23:38:43.256882 [debug] [Thread-1 (]: Began compiling node seed.project_tesla.tesla_results
[0m23:38:43.257891 [debug] [Thread-1 (]: Began executing node seed.project_tesla.tesla_results
[0m23:39:10.881187 [debug] [Thread-1 (]: Using duckdb connection "seed.project_tesla.tesla_results"
[0m23:39:10.882188 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: BEGIN
[0m23:39:10.882188 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:39:10.884188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:39:10.884188 [debug] [Thread-1 (]: Using duckdb connection "seed.project_tesla.tesla_results"
[0m23:39:10.885187 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "seed.project_tesla.tesla_results"} */

    create table "tesla"."main"."tesla_results" ("country" text,"trim_name" text,"in_transit" boolean,"cpo_refurbishment_status" text,"city" text,"country_code" text,"country_of_origin" text,"model" text,"year" integer,"vin" text,"price" varchar,"color" text,"original_delivery_date" timestamp without time zone,"odometer" varchar,"title_sub_type" text,"vrl_name" text,"battery_warranty_exp_date" timestamp without time zone,"warranty_battery_is_expired" boolean,"vehicle_history" text,"odometer_type" text,"current_time" timestamp without time zone)
  
[0m23:39:10.890186 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:39:10.912699 [debug] [Thread-1 (]: Using duckdb connection "seed.project_tesla.tesla_results"
[0m23:39:10.913699 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: 
          COPY "tesla"."main"."tesla_results" FROM 'C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\seeds\tesla_results.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m23:39:12.128604 [debug] [Thread-1 (]: SQL status: OK in 1.214 seconds
[0m23:39:12.135668 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.project_tesla.tesla_results"
[0m23:39:12.159685 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: COMMIT
[0m23:39:12.159685 [debug] [Thread-1 (]: Using duckdb connection "seed.project_tesla.tesla_results"
[0m23:39:12.160686 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: COMMIT
[0m23:39:12.177719 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m23:39:12.180727 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: Close
[0m23:39:12.183727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2675abad-1e67-4b27-b2c2-7e68e52146fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED5DD9B70>]}
[0m23:39:12.183727 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.tesla_results .................................. [[32mCREATE 364744[0m in 28.92s]
[0m23:39:12.185738 [debug] [Thread-1 (]: Finished running node seed.project_tesla.tesla_results
[0m23:39:12.186739 [debug] [MainThread]: Using duckdb connection "master"
[0m23:39:12.186739 [debug] [MainThread]: On master: BEGIN
[0m23:39:12.187729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:39:12.188728 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:39:12.188728 [debug] [MainThread]: On master: COMMIT
[0m23:39:12.188728 [debug] [MainThread]: Using duckdb connection "master"
[0m23:39:12.189728 [debug] [MainThread]: On master: COMMIT
[0m23:39:12.189728 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:39:12.189728 [debug] [MainThread]: On master: Close
[0m23:39:12.190735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:12.190735 [debug] [MainThread]: Connection 'create_tesla_main' was properly closed.
[0m23:39:12.191729 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:39:12.191729 [debug] [MainThread]: Connection 'seed.project_tesla.tesla_results' was properly closed.
[0m23:39:12.191729 [info ] [MainThread]: 
[0m23:39:12.193234 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 29.76 seconds (29.76s).
[0m23:39:12.194240 [debug] [MainThread]: Command end result
[0m23:39:12.221240 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:39:12.225240 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:39:12.235239 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:39:12.236239 [info ] [MainThread]: 
[0m23:39:12.237239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:39:12.238239 [info ] [MainThread]: 
[0m23:39:12.239243 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:39:12.241252 [debug] [MainThread]: Command `dbt seed` succeeded at 23:39:12.241252 after 32.47 seconds
[0m23:39:12.242253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED1DD3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED30D6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED5F1CA90>]}
[0m23:39:12.243240 [debug] [MainThread]: Flushing usage events
[0m23:39:12.645298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:39:32.918565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74D1C31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74E580C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74E580A90>]}


============================== 23:39:32.923573 | 5caead74-a66e-475b-be1b-3a2a664ee2ae ==============================
[0m23:39:32.923573 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:39:32.923573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:39:33.253119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5caead74-a66e-475b-be1b-3a2a664ee2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74A643490>]}
[0m23:39:33.340638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5caead74-a66e-475b-be1b-3a2a664ee2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74E5826B0>]}
[0m23:39:33.344638 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:39:33.554351 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:39:33.779945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:39:33.780945 [debug] [MainThread]: Partial parsing: updated file: project_tesla://models\staging\stg_tesla_vehicles.sql
[0m23:39:34.362242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5caead74-a66e-475b-be1b-3a2a664ee2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74FE702E0>]}
[0m23:39:34.481786 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:39:34.483788 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:39:34.512163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5caead74-a66e-475b-be1b-3a2a664ee2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74E7ED540>]}
[0m23:39:34.513163 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 428 macros
[0m23:39:34.514163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5caead74-a66e-475b-be1b-3a2a664ee2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74FB55540>]}
[0m23:39:34.516164 [info ] [MainThread]: 
[0m23:39:34.516164 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:39:34.517162 [info ] [MainThread]: 
[0m23:39:34.517162 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:39:34.523163 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla'
[0m23:39:34.602180 [debug] [ThreadPool]: Using duckdb connection "list_tesla"
[0m23:39:34.603189 [debug] [ThreadPool]: On list_tesla: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla"'
    
  
  
[0m23:39:34.604188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:35.343971 [debug] [ThreadPool]: SQL status: OK in 0.740 seconds
[0m23:39:35.344980 [debug] [ThreadPool]: On list_tesla: Close
[0m23:39:35.345971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla, now create_tesla_main)
[0m23:39:35.345971 [debug] [ThreadPool]: Creating schema "database: "tesla"
schema: "main"
"
[0m23:39:35.351987 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:39:35.352972 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla'
        and type='sqlite'
    
  
[0m23:39:35.352972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:35.353971 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:39:35.354980 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:39:35.355983 [debug] [ThreadPool]: On create_tesla_main: BEGIN
[0m23:39:35.355983 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:39:35.356971 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:39:35.356971 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
    
        create schema if not exists "tesla"."main"
    
[0m23:39:35.357980 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:39:35.357980 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:39:35.358980 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:39:35.358980 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:39:35.359972 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:39:35.359972 [debug] [ThreadPool]: On create_tesla_main: Close
[0m23:39:35.360980 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:39:35.365972 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:39:35.366981 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:39:35.366981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:35.367971 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:39:35.367971 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:39:35.367971 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:39:35.379980 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m23:39:35.380972 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:39:35.382971 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:39:35.382971 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:39:35.384294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5caead74-a66e-475b-be1b-3a2a664ee2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74E4E43D0>]}
[0m23:39:35.384294 [debug] [MainThread]: Using duckdb connection "master"
[0m23:39:35.384294 [debug] [MainThread]: On master: BEGIN
[0m23:39:35.385383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:39:35.385383 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:39:35.386301 [debug] [MainThread]: On master: COMMIT
[0m23:39:35.386301 [debug] [MainThread]: Using duckdb connection "master"
[0m23:39:35.386301 [debug] [MainThread]: On master: COMMIT
[0m23:39:35.387360 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:39:35.387360 [debug] [MainThread]: On master: Close
[0m23:39:35.392212 [debug] [Thread-1 (]: Began running node model.project_tesla.stg_tesla_vehicles
[0m23:39:35.393222 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_tesla_vehicles ............................ [RUN]
[0m23:39:35.394229 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.project_tesla.stg_tesla_vehicles'
[0m23:39:35.394229 [debug] [Thread-1 (]: Began compiling node model.project_tesla.stg_tesla_vehicles
[0m23:39:35.402228 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.stg_tesla_vehicles"
[0m23:39:35.403239 [debug] [Thread-1 (]: Began executing node model.project_tesla.stg_tesla_vehicles
[0m23:39:35.429782 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_tesla.stg_tesla_vehicles"
[0m23:39:35.431771 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m23:39:35.432767 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: BEGIN
[0m23:39:35.432767 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:39:35.433775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:39:35.433775 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m23:39:35.434766 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.stg_tesla_vehicles"} */

  
  create view "tesla"."main"."stg_tesla_vehicles__dbt_tmp" as (
    

with source_data as (
    select * from "tesla"."main"."tesla_results"
),

staged as (
    select
        -- Basic vehicle information
        trim(model) as model,
        trim(trim_name) as trim_name,
        year,
        vin,
        
        -- Location information
        trim(country) as country,
        trim(country_code) as country_code,
        trim(city) as city,
        
        -- Price and metrics
        -- Extract numeric price from string
        regexp_extract(price, '[0-9]+') as price_str,
        try_cast(regexp_extract(price, '[0-9]+') as float) as price,
        try_cast(odometer as float) as odometer,
        
        -- Dates
        try_cast(original_delivery_date as timestamp) as delivery_date,
        try_cast(battery_warranty_exp_date as timestamp) as warranty_expiry_date,
        "current_time" as record_time_str,
        
        -- Additional attributes
        trim(color) as color,
        trim(vehicle_history) as vehicle_history,
        case 
            when vehicle_history is null then false
            when lower(vehicle_history) like '%accident%' then true
            else false
        end as had_accident,
        
        -- Status flags
        in_transit,
        trim(cpo_refurbishment_status) as refurbishment_status
    from source_data
)

select * from staged
  );

[0m23:39:35.437922 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:39:35.443928 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m23:39:35.443928 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.stg_tesla_vehicles"} */
alter view "tesla"."main"."stg_tesla_vehicles__dbt_tmp" rename to "stg_tesla_vehicles"
[0m23:39:35.445928 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:39:35.454928 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: COMMIT
[0m23:39:35.455928 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m23:39:35.455928 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: COMMIT
[0m23:39:35.461455 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:39:35.466021 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m23:39:35.466021 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.stg_tesla_vehicles"} */
drop view if exists "tesla"."main"."stg_tesla_vehicles__dbt_backup" cascade
[0m23:39:35.468031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:39:35.470028 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: Close
[0m23:39:35.472399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5caead74-a66e-475b-be1b-3a2a664ee2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7501F4A60>]}
[0m23:39:35.472399 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_tesla_vehicles ....................... [[32mOK[0m in 0.08s]
[0m23:39:35.474408 [debug] [Thread-1 (]: Finished running node model.project_tesla.stg_tesla_vehicles
[0m23:39:35.475414 [debug] [Thread-3 (]: Began running node model.project_tesla.tesla_analysis
[0m23:39:35.476407 [info ] [Thread-3 (]: 2 of 2 START sql table model main.tesla_analysis ............................... [RUN]
[0m23:39:35.476407 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_analysis'
[0m23:39:35.477486 [debug] [Thread-3 (]: Began compiling node model.project_tesla.tesla_analysis
[0m23:39:35.480405 [debug] [Thread-3 (]: Writing injected SQL for node "model.project_tesla.tesla_analysis"
[0m23:39:35.481406 [debug] [Thread-3 (]: Began executing node model.project_tesla.tesla_analysis
[0m23:39:35.498426 [debug] [Thread-3 (]: Writing runtime sql for node "model.project_tesla.tesla_analysis"
[0m23:39:35.500421 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:39:35.500421 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: BEGIN
[0m23:39:35.501422 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:39:35.502423 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:39:35.502423 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:39:35.503423 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_analysis"} */

  
    
    

    create  table
      "tesla"."main"."tesla_analysis__dbt_tmp"
  
    as (
      

with stg_tesla as (
    select * from "tesla"."main"."stg_tesla_vehicles"
),

country_stats as (
    select
        country,
        count(*) as total_vehicles,
        round(avg(price), 2) as avg_price,
        round(avg(odometer), 2) as avg_odometer,
        count(case when had_accident then 1 end) as vehicles_with_accidents,
        round(count(case when had_accident then 1 end) * 100.0 / count(*), 2) as accident_percentage
    from stg_tesla
    group by country
),

model_analysis as (
    select
        model,
        trim_name,
        count(*) as total_count,
        round(avg(price), 2) as avg_price,
        min(price) as min_price,
        max(price) as max_price,
        round(avg(odometer), 2) as avg_odometer
    from stg_tesla
    group by model, trim_name
)

select 
    'country_stats' as analysis_type,
    country as dimension,
    total_vehicles as count,
    avg_price,
    null as min_price,
    null as max_price,
    avg_odometer,
    vehicles_with_accidents,
    accident_percentage,
    null as trim_name
from country_stats

union all

select
    'model_analysis' as analysis_type,
    model as dimension,
    total_count as count,
    avg_price,
    min_price,
    max_price,
    avg_odometer,
    null as vehicles_with_accidents,
    null as accident_percentage,
    trim_name
from model_analysis
    );
  
  
[0m23:39:35.593637 [debug] [Thread-3 (]: SQL status: OK in 0.089 seconds
[0m23:39:35.598007 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:39:35.599059 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_analysis"} */
alter table "tesla"."main"."tesla_analysis__dbt_tmp" rename to "tesla_analysis"
[0m23:39:35.600115 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:39:35.606159 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: COMMIT
[0m23:39:35.606724 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:39:35.607297 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: COMMIT
[0m23:39:35.614292 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m23:39:35.617064 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:39:35.617624 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_analysis"} */
drop table if exists "tesla"."main"."tesla_analysis__dbt_backup" cascade
[0m23:39:35.618713 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m23:39:35.619821 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: Close
[0m23:39:35.620945 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5caead74-a66e-475b-be1b-3a2a664ee2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74C045540>]}
[0m23:39:35.621482 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.tesla_analysis .......................... [[32mOK[0m in 0.14s]
[0m23:39:35.623108 [debug] [Thread-3 (]: Finished running node model.project_tesla.tesla_analysis
[0m23:39:35.624191 [debug] [MainThread]: Using duckdb connection "master"
[0m23:39:35.624722 [debug] [MainThread]: On master: BEGIN
[0m23:39:35.625274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:39:35.625814 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:39:35.626367 [debug] [MainThread]: On master: COMMIT
[0m23:39:35.626367 [debug] [MainThread]: Using duckdb connection "master"
[0m23:39:35.626913 [debug] [MainThread]: On master: COMMIT
[0m23:39:35.627918 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:39:35.628496 [debug] [MainThread]: On master: Close
[0m23:39:35.629002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:35.629531 [debug] [MainThread]: Connection 'create_tesla_main' was properly closed.
[0m23:39:35.629531 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:39:35.630084 [debug] [MainThread]: Connection 'model.project_tesla.stg_tesla_vehicles' was properly closed.
[0m23:39:35.630625 [debug] [MainThread]: Connection 'model.project_tesla.tesla_analysis' was properly closed.
[0m23:39:35.630625 [info ] [MainThread]: 
[0m23:39:35.631151 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m23:39:35.632159 [debug] [MainThread]: Command end result
[0m23:39:35.655264 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:39:35.658261 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:39:35.664264 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:39:35.665264 [info ] [MainThread]: 
[0m23:39:35.666264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:39:35.667261 [info ] [MainThread]: 
[0m23:39:35.667261 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:39:35.669262 [debug] [MainThread]: Command `dbt run` succeeded at 23:39:35.669262 after 2.84 seconds
[0m23:39:35.669262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74D1C31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74E7ED540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74E5826B0>]}
[0m23:39:35.670268 [debug] [MainThread]: Flushing usage events
[0m23:39:36.069779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:39:42.828150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180F21A3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180F3564E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180F3564C40>]}


============================== 23:39:42.832151 | 7baf978f-8fed-4dc2-8014-496f5ad652b7 ==============================
[0m23:39:42.832151 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:39:42.833150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:39:43.181631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7baf978f-8fed-4dc2-8014-496f5ad652b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180F368B850>]}
[0m23:39:43.270158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7baf978f-8fed-4dc2-8014-496f5ad652b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180F3566860>]}
[0m23:39:43.273151 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:39:43.471667 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:39:43.669516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:39:43.670525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:39:43.743076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7baf978f-8fed-4dc2-8014-496f5ad652b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180F4BB8DF0>]}
[0m23:39:43.890177 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:39:43.892174 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:39:43.925631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7baf978f-8fed-4dc2-8014-496f5ad652b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180F35E96F0>]}
[0m23:39:43.925631 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 428 macros
[0m23:39:43.926635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7baf978f-8fed-4dc2-8014-496f5ad652b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180F3564BE0>]}
[0m23:39:43.928627 [info ] [MainThread]: 
[0m23:39:43.928627 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:39:43.929563 [info ] [MainThread]: 
[0m23:39:43.930560 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:39:43.935568 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:39:44.008585 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:39:44.009586 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:39:44.009586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:44.092565 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m23:39:44.093570 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:39:44.094566 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:39:44.109578 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m23:39:44.111570 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:39:44.112578 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:39:44.112578 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:39:44.114571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7baf978f-8fed-4dc2-8014-496f5ad652b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180F34F7B20>]}
[0m23:39:44.114571 [debug] [MainThread]: Using duckdb connection "master"
[0m23:39:44.115582 [debug] [MainThread]: On master: BEGIN
[0m23:39:44.115582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:39:44.116665 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:39:44.116665 [debug] [MainThread]: On master: COMMIT
[0m23:39:44.117675 [debug] [MainThread]: Using duckdb connection "master"
[0m23:39:44.117675 [debug] [MainThread]: On master: COMMIT
[0m23:39:44.118665 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:39:44.118665 [debug] [MainThread]: On master: Close
[0m23:39:44.123665 [debug] [Thread-1 (]: Began running node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:39:44.123665 [debug] [Thread-2 (]: Began running node test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023
[0m23:39:44.124666 [debug] [Thread-3 (]: Began running node test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae
[0m23:39:44.124666 [debug] [Thread-4 (]: Began running node test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e
[0m23:39:44.125742 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_tesla_vehicles_vin .............................. [RUN]
[0m23:39:44.126249 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_tesla_data_tesla_results_vin ................. [RUN]
[0m23:39:44.126793 [info ] [Thread-3 (]: 3 of 4 START test source_unique_tesla_data_tesla_results_vin ................... [RUN]
[0m23:39:44.128384 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f'
[0m23:39:44.127863 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_tesla_vehicles_vin ................................ [RUN]
[0m23:39:44.129471 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023'
[0m23:39:44.130015 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae'
[0m23:39:44.130605 [debug] [Thread-1 (]: Began compiling node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:39:44.131110 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e'
[0m23:39:44.131635 [debug] [Thread-2 (]: Began compiling node test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023
[0m23:39:44.132153 [debug] [Thread-3 (]: Began compiling node test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae
[0m23:39:44.148270 [debug] [Thread-1 (]: Writing injected SQL for node "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:39:44.148791 [debug] [Thread-4 (]: Began compiling node test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e
[0m23:39:44.156133 [debug] [Thread-2 (]: Writing injected SQL for node "test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023"
[0m23:39:44.162248 [debug] [Thread-3 (]: Writing injected SQL for node "test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae"
[0m23:39:44.166596 [debug] [Thread-4 (]: Writing injected SQL for node "test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e"
[0m23:39:44.168194 [debug] [Thread-1 (]: Began executing node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:39:44.184856 [debug] [Thread-1 (]: Writing runtime sql for node "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:39:44.185381 [debug] [Thread-4 (]: Began executing node test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e
[0m23:39:44.185922 [debug] [Thread-3 (]: Began executing node test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae
[0m23:39:44.186516 [debug] [Thread-2 (]: Began executing node test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023
[0m23:39:44.189339 [debug] [Thread-4 (]: Writing runtime sql for node "test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e"
[0m23:39:44.192525 [debug] [Thread-3 (]: Writing runtime sql for node "test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae"
[0m23:39:44.194668 [debug] [Thread-2 (]: Writing runtime sql for node "test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023"
[0m23:39:44.195212 [debug] [Thread-1 (]: Using duckdb connection "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:39:44.196266 [debug] [Thread-4 (]: Using duckdb connection "test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e"
[0m23:39:44.196781 [debug] [Thread-1 (]: On test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f: BEGIN
[0m23:39:44.197303 [debug] [Thread-2 (]: Using duckdb connection "test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023"
[0m23:39:44.197822 [debug] [Thread-4 (]: On test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e: BEGIN
[0m23:39:44.198348 [debug] [Thread-3 (]: Using duckdb connection "test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae"
[0m23:39:44.198880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:39:44.199475 [debug] [Thread-2 (]: On test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023: BEGIN
[0m23:39:44.199979 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:39:44.199979 [debug] [Thread-3 (]: On test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae: BEGIN
[0m23:39:44.201053 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:39:44.201591 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:39:44.202126 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m23:39:44.202658 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:39:44.203197 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:39:44.203742 [debug] [Thread-1 (]: Using duckdb connection "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:39:44.204277 [debug] [Thread-4 (]: Using duckdb connection "test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e"
[0m23:39:44.204822 [debug] [Thread-2 (]: Using duckdb connection "test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023"
[0m23:39:44.204822 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m23:39:44.205336 [debug] [Thread-1 (]: On test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vin
from "tesla"."main"."stg_tesla_vehicles"
where vin is null



  
  
      
    ) dbt_internal_test
[0m23:39:44.205884 [debug] [Thread-4 (]: On test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vin as unique_field,
    count(*) as n_records

from "tesla"."main"."stg_tesla_vehicles"
where vin is not null
group by vin
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:39:44.206433 [debug] [Thread-2 (]: On test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vin
from "tesla"."tesla_data"."tesla_results"
where vin is null



  
  
      
    ) dbt_internal_test
[0m23:39:44.206979 [debug] [Thread-3 (]: Using duckdb connection "test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae"
[0m23:39:44.208046 [debug] [Thread-3 (]: On test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vin as unique_field,
    count(*) as n_records

from "tesla"."tesla_data"."tesla_results"
where vin is not null
group by vin
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:39:44.209132 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:39:44.212829 [debug] [Thread-1 (]: On test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f: ROLLBACK
[0m23:39:44.213364 [debug] [Thread-1 (]: Failed to rollback 'test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f'
[0m23:39:44.214636 [debug] [Thread-1 (]: On test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f: Close
[0m23:39:44.218609 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vin as unique_field,
    count(*) as n_records

from "tesla"."tesla_data"."tesla_results"
where vin is not null
group by vin
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:39:44.219114 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vin
from "tesla"."tesla_data"."tesla_results"
where vin is null



  
  
      
    ) dbt_internal_test
[0m23:39:44.219114 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m23:39:44.220120 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m23:39:44.216183 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_tesla_vehicles_vin .................................... [[32mPASS[0m in 0.09s]
[0m23:39:44.221120 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m23:39:44.222120 [debug] [Thread-4 (]: On test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e: ROLLBACK
[0m23:39:44.223119 [debug] [Thread-3 (]: On test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae: ROLLBACK
[0m23:39:44.223119 [debug] [Thread-1 (]: Finished running node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:39:44.224131 [debug] [Thread-2 (]: On test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023: ROLLBACK
[0m23:39:44.224131 [debug] [Thread-4 (]: Failed to rollback 'test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e'
[0m23:39:44.226120 [debug] [Thread-4 (]: On test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e: Close
[0m23:39:44.226120 [error] [Thread-4 (]: 4 of 4 FAIL 5077 unique_stg_tesla_vehicles_vin ................................. [[31mFAIL 5077[0m in 0.10s]
[0m23:39:44.228120 [debug] [Thread-4 (]: Finished running node test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e
[0m23:39:44.232689 [debug] [Thread-3 (]: Failed to rollback 'test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae'
[0m23:39:44.233689 [debug] [Thread-2 (]: Failed to rollback 'test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023'
[0m23:39:44.234689 [debug] [Thread-3 (]: On test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae: Close
[0m23:39:44.234689 [debug] [Thread-2 (]: On test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023: Close
[0m23:39:44.236688 [debug] [Thread-3 (]: Runtime Error in test source_unique_tesla_data_tesla_results_vin (models\staging\sources.yml)
  Catalog Error: Table with name tesla_results does not exist!
  Did you mean "tesla.tesla_results"?
  
  LINE 18: from "tesla"."tesla_data"."tesla_results"
                ^
[0m23:39:44.238690 [debug] [Thread-2 (]: Runtime Error in test source_not_null_tesla_data_tesla_results_vin (models\staging\sources.yml)
  Catalog Error: Table with name tesla_results does not exist!
  Did you mean "tesla.tesla_results"?
  
  LINE 17: from "tesla"."tesla_data"."tesla_results"
                ^
[0m23:39:44.237690 [error] [Thread-3 (]: 3 of 4 ERROR source_unique_tesla_data_tesla_results_vin ........................ [[31mERROR[0m in 0.11s]
[0m23:39:44.239688 [debug] [Thread-3 (]: Finished running node test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae
[0m23:39:44.240689 [debug] [Thread-7 (]: Marking all children of 'test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_tesla_data_tesla_results_vin (models\staging\sources.yml)
  Catalog Error: Table with name tesla_results does not exist!
  Did you mean "tesla.tesla_results"?
  
  LINE 18: from "tesla"."tesla_data"."tesla_results"
                ^.
[0m23:39:44.238690 [error] [Thread-2 (]: 2 of 4 ERROR source_not_null_tesla_data_tesla_results_vin ...................... [[31mERROR[0m in 0.11s]
[0m23:39:44.241689 [debug] [Thread-2 (]: Finished running node test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023
[0m23:39:44.242701 [debug] [Thread-7 (]: Marking all children of 'test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_tesla_data_tesla_results_vin (models\staging\sources.yml)
  Catalog Error: Table with name tesla_results does not exist!
  Did you mean "tesla.tesla_results"?
  
  LINE 17: from "tesla"."tesla_data"."tesla_results"
                ^.
[0m23:39:44.243689 [debug] [MainThread]: Using duckdb connection "master"
[0m23:39:44.243689 [debug] [MainThread]: On master: BEGIN
[0m23:39:44.244688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:39:44.244688 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:39:44.245688 [debug] [MainThread]: On master: COMMIT
[0m23:39:44.245688 [debug] [MainThread]: Using duckdb connection "master"
[0m23:39:44.246689 [debug] [MainThread]: On master: COMMIT
[0m23:39:44.246689 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:39:44.247693 [debug] [MainThread]: On master: Close
[0m23:39:44.247693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:44.248694 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:39:44.248694 [debug] [MainThread]: Connection 'test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f' was properly closed.
[0m23:39:44.248694 [debug] [MainThread]: Connection 'test.project_tesla.source_not_null_tesla_data_tesla_results_vin.fb83336023' was properly closed.
[0m23:39:44.249693 [debug] [MainThread]: Connection 'test.project_tesla.source_unique_tesla_data_tesla_results_vin.773c6998ae' was properly closed.
[0m23:39:44.249693 [debug] [MainThread]: Connection 'test.project_tesla.unique_stg_tesla_vehicles_vin.342e39aa5e' was properly closed.
[0m23:39:44.249693 [info ] [MainThread]: 
[0m23:39:44.250690 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m23:39:44.252698 [debug] [MainThread]: Command end result
[0m23:39:44.276688 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:39:44.278689 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:39:44.287698 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:39:44.288688 [info ] [MainThread]: 
[0m23:39:44.289689 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m23:39:44.290469 [info ] [MainThread]: 
[0m23:39:44.291481 [error] [MainThread]: [31mFailure in test unique_stg_tesla_vehicles_vin (models\staging\schema.yml)[0m
[0m23:39:44.293478 [error] [MainThread]:   Got 5077 results, configured to fail if != 0
[0m23:39:44.294481 [info ] [MainThread]: 
[0m23:39:44.295479 [info ] [MainThread]:   compiled code at target\compiled\project_tesla\models\staging\schema.yml\unique_stg_tesla_vehicles_vin.sql
[0m23:39:44.295479 [info ] [MainThread]: 
[0m23:39:44.296482 [error] [MainThread]: [31mFailure in test source_unique_tesla_data_tesla_results_vin (models\staging\sources.yml)[0m
[0m23:39:44.297477 [error] [MainThread]:   Runtime Error in test source_unique_tesla_data_tesla_results_vin (models\staging\sources.yml)
  Catalog Error: Table with name tesla_results does not exist!
  Did you mean "tesla.tesla_results"?
  
  LINE 18: from "tesla"."tesla_data"."tesla_results"
                ^
[0m23:39:44.298477 [info ] [MainThread]: 
[0m23:39:44.298477 [info ] [MainThread]:   compiled code at target\compiled\project_tesla\models\staging\sources.yml\source_unique_tesla_data_tesla_results_vin.sql
[0m23:39:44.299479 [info ] [MainThread]: 
[0m23:39:44.300476 [error] [MainThread]: [31mFailure in test source_not_null_tesla_data_tesla_results_vin (models\staging\sources.yml)[0m
[0m23:39:44.301481 [error] [MainThread]:   Runtime Error in test source_not_null_tesla_data_tesla_results_vin (models\staging\sources.yml)
  Catalog Error: Table with name tesla_results does not exist!
  Did you mean "tesla.tesla_results"?
  
  LINE 17: from "tesla"."tesla_data"."tesla_results"
                ^
[0m23:39:44.302482 [info ] [MainThread]: 
[0m23:39:44.302482 [info ] [MainThread]:   compiled code at target\compiled\project_tesla\models\staging\sources.yml\source_not_null_tesla_data_tesla_results_vin.sql
[0m23:39:44.303483 [info ] [MainThread]: 
[0m23:39:44.304481 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=4
[0m23:39:44.305482 [debug] [MainThread]: Command `dbt test` failed at 23:39:44.305482 after 1.56 seconds
[0m23:39:44.306482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180F21A3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180F35EAE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180F24D1090>]}
[0m23:39:44.306482 [debug] [MainThread]: Flushing usage events
[0m23:39:44.680716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:40:18.426274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000102889731F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010289D2B3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010289D2B1C0>]}


============================== 23:40:18.430656 | ac799ca3-e43e-4024-b93f-38fca547ce3f ==============================
[0m23:40:18.430656 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:40:18.431733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m23:40:18.774927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac799ca3-e43e-4024-b93f-38fca547ce3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010285E03490>]}
[0m23:40:18.841942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac799ca3-e43e-4024-b93f-38fca547ce3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010289C96CB0>]}
[0m23:40:18.844934 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:40:19.066717 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:40:19.282396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:40:19.284409 [debug] [MainThread]: Partial parsing: updated file: project_tesla://models\staging\sources.yml
[0m23:40:19.285396 [debug] [MainThread]: Partial parsing: updated file: project_tesla://models\staging\schema.yml
[0m23:40:19.947802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac799ca3-e43e-4024-b93f-38fca547ce3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001028B71C130>]}
[0m23:40:20.048336 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:40:20.050338 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:40:20.084463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac799ca3-e43e-4024-b93f-38fca547ce3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001028B6F70D0>]}
[0m23:40:20.085463 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 1 source, 428 macros
[0m23:40:20.085463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac799ca3-e43e-4024-b93f-38fca547ce3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001028B6F62F0>]}
[0m23:40:20.087464 [info ] [MainThread]: 
[0m23:40:20.087464 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:40:20.088469 [info ] [MainThread]: 
[0m23:40:20.089463 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:40:20.095502 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:40:20.161003 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:40:20.162003 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:40:20.162003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:20.246656 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m23:40:20.248161 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:40:20.248161 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:40:20.261164 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m23:40:20.263166 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:40:20.263166 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:40:20.264166 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:40:20.265169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac799ca3-e43e-4024-b93f-38fca547ce3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001028B6F5420>]}
[0m23:40:20.266245 [debug] [MainThread]: Using duckdb connection "master"
[0m23:40:20.266245 [debug] [MainThread]: On master: BEGIN
[0m23:40:20.267168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:40:20.267168 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:40:20.268233 [debug] [MainThread]: On master: COMMIT
[0m23:40:20.268233 [debug] [MainThread]: Using duckdb connection "master"
[0m23:40:20.268233 [debug] [MainThread]: On master: COMMIT
[0m23:40:20.269238 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:40:20.269238 [debug] [MainThread]: On master: Close
[0m23:40:20.274167 [debug] [Thread-1 (]: Began running node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:40:20.274167 [info ] [Thread-1 (]: 1 of 1 START test not_null_stg_tesla_vehicles_vin .............................. [RUN]
[0m23:40:20.275169 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f'
[0m23:40:20.275169 [debug] [Thread-1 (]: Began compiling node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:40:20.289170 [debug] [Thread-1 (]: Writing injected SQL for node "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:40:20.290171 [debug] [Thread-1 (]: Began executing node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:40:20.305171 [debug] [Thread-1 (]: Writing runtime sql for node "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:40:20.306170 [debug] [Thread-1 (]: Using duckdb connection "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:40:20.307167 [debug] [Thread-1 (]: On test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f: BEGIN
[0m23:40:20.307167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:40:20.308167 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:40:20.308167 [debug] [Thread-1 (]: Using duckdb connection "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:40:20.309171 [debug] [Thread-1 (]: On test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vin
from "tesla"."main"."stg_tesla_vehicles"
where vin is null



  
  
      
    ) dbt_internal_test
[0m23:40:20.311170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:40:20.314171 [debug] [Thread-1 (]: On test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f: ROLLBACK
[0m23:40:20.315171 [debug] [Thread-1 (]: Failed to rollback 'test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f'
[0m23:40:20.315171 [debug] [Thread-1 (]: On test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f: Close
[0m23:40:20.316171 [info ] [Thread-1 (]: 1 of 1 PASS not_null_stg_tesla_vehicles_vin .................................... [[32mPASS[0m in 0.04s]
[0m23:40:20.318171 [debug] [Thread-1 (]: Finished running node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:40:20.319169 [debug] [MainThread]: Using duckdb connection "master"
[0m23:40:20.319169 [debug] [MainThread]: On master: BEGIN
[0m23:40:20.320238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:40:20.320238 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:40:20.321167 [debug] [MainThread]: On master: COMMIT
[0m23:40:20.321167 [debug] [MainThread]: Using duckdb connection "master"
[0m23:40:20.322184 [debug] [MainThread]: On master: COMMIT
[0m23:40:20.322184 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:40:20.323176 [debug] [MainThread]: On master: Close
[0m23:40:20.323176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:20.323176 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:40:20.324165 [debug] [MainThread]: Connection 'test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f' was properly closed.
[0m23:40:20.324165 [info ] [MainThread]: 
[0m23:40:20.325174 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m23:40:20.326168 [debug] [MainThread]: Command end result
[0m23:40:20.344195 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:40:20.346194 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:40:20.352726 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:40:20.353717 [info ] [MainThread]: 
[0m23:40:20.354718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:40:20.355718 [info ] [MainThread]: 
[0m23:40:20.356733 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:40:20.357725 [debug] [MainThread]: Command `dbt test` succeeded at 23:40:20.357725 after 2.03 seconds
[0m23:40:20.357725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000102889731F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001028B5448E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010287507730>]}
[0m23:40:20.358725 [debug] [MainThread]: Flushing usage events
[0m23:40:20.739920 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:40:28.591910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58AB431F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58BEFB310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58BEFB130>]}


============================== 23:40:28.595919 | 2aa94c50-aec2-45c4-879d-73f8580f6233 ==============================
[0m23:40:28.595919 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:40:28.596911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:40:28.934987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aa94c50-aec2-45c4-879d-73f8580f6233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58C02BE80>]}
[0m23:40:29.013519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2aa94c50-aec2-45c4-879d-73f8580f6233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58BEF9840>]}
[0m23:40:29.016551 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:40:29.245409 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:40:29.434103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:40:29.434103 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:40:29.489661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2aa94c50-aec2-45c4-879d-73f8580f6233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58D55BE20>]}
[0m23:40:29.513303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2aa94c50-aec2-45c4-879d-73f8580f6233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58D4D08B0>]}
[0m23:40:29.513303 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 1 source, 428 macros
[0m23:40:29.514264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa94c50-aec2-45c4-879d-73f8580f6233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58BFC8670>]}
[0m23:40:29.516316 [info ] [MainThread]: 
[0m23:40:29.516316 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:40:29.517284 [info ] [MainThread]: 
[0m23:40:29.518273 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:40:29.524282 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:40:29.638196 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:40:29.639204 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:40:29.639204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:29.714606 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m23:40:29.715616 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:40:29.715616 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:40:29.729615 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m23:40:29.730615 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:40:29.731607 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:40:29.732607 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:40:29.733608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa94c50-aec2-45c4-879d-73f8580f6233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58D4D0F40>]}
[0m23:40:29.738307 [debug] [Thread-1 (]: Began running node seed.project_tesla.tesla_results
[0m23:40:29.738307 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.project_tesla.tesla_results'
[0m23:40:29.739320 [debug] [Thread-1 (]: Began compiling node seed.project_tesla.tesla_results
[0m23:40:29.744332 [debug] [Thread-1 (]: Began executing node seed.project_tesla.tesla_results
[0m23:40:29.745329 [debug] [Thread-1 (]: Finished running node seed.project_tesla.tesla_results
[0m23:40:29.746320 [debug] [Thread-3 (]: Began running node model.project_tesla.stg_tesla_vehicles
[0m23:40:29.746320 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.project_tesla.stg_tesla_vehicles'
[0m23:40:29.747331 [debug] [Thread-3 (]: Began compiling node model.project_tesla.stg_tesla_vehicles
[0m23:40:29.750321 [debug] [Thread-3 (]: Writing injected SQL for node "model.project_tesla.stg_tesla_vehicles"
[0m23:40:29.751321 [debug] [Thread-3 (]: Began executing node model.project_tesla.stg_tesla_vehicles
[0m23:40:29.752321 [debug] [Thread-3 (]: Finished running node model.project_tesla.stg_tesla_vehicles
[0m23:40:29.753398 [debug] [Thread-2 (]: Began running node model.project_tesla.tesla_analysis
[0m23:40:29.753398 [debug] [Thread-1 (]: Began running node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:40:29.754406 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_analysis'
[0m23:40:29.754406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.project_tesla.tesla_results, now test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f)
[0m23:40:29.755486 [debug] [Thread-2 (]: Began compiling node model.project_tesla.tesla_analysis
[0m23:40:29.755486 [debug] [Thread-1 (]: Began compiling node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:40:29.758122 [debug] [Thread-2 (]: Writing injected SQL for node "model.project_tesla.tesla_analysis"
[0m23:40:29.769122 [debug] [Thread-1 (]: Writing injected SQL for node "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:40:29.770121 [debug] [Thread-2 (]: Began executing node model.project_tesla.tesla_analysis
[0m23:40:29.770121 [debug] [Thread-2 (]: Finished running node model.project_tesla.tesla_analysis
[0m23:40:29.771121 [debug] [Thread-1 (]: Began executing node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:40:29.772123 [debug] [Thread-1 (]: Finished running node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:40:29.773114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:29.773114 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:40:29.773114 [debug] [MainThread]: Connection 'test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f' was properly closed.
[0m23:40:29.774122 [debug] [MainThread]: Connection 'model.project_tesla.stg_tesla_vehicles' was properly closed.
[0m23:40:29.774122 [debug] [MainThread]: Connection 'model.project_tesla.tesla_analysis' was properly closed.
[0m23:40:29.775121 [debug] [MainThread]: Command end result
[0m23:40:29.867497 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:40:29.870499 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:40:29.876499 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:40:30.195858 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m23:40:30.196395 [info ] [MainThread]: Building catalog
[0m23:40:30.205834 [debug] [ThreadPool]: Acquiring new duckdb connection 'tesla.information_schema'
[0m23:40:30.211856 [debug] [ThreadPool]: Using duckdb connection "tesla.information_schema"
[0m23:40:30.212375 [debug] [ThreadPool]: On tesla.information_schema: BEGIN
[0m23:40:30.212896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:30.213490 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:40:30.214006 [debug] [ThreadPool]: Using duckdb connection "tesla.information_schema"
[0m23:40:30.214539 [debug] [ThreadPool]: On tesla.information_schema: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "tesla.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'tesla'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'tesla'
    )
    select
        'tesla' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m23:40:30.222087 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m23:40:30.226055 [debug] [ThreadPool]: On tesla.information_schema: ROLLBACK
[0m23:40:30.226599 [debug] [ThreadPool]: Failed to rollback 'tesla.information_schema'
[0m23:40:30.227154 [debug] [ThreadPool]: On tesla.information_schema: Close
[0m23:40:30.239666 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\catalog.json
[0m23:40:30.262198 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:40:30.265272 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:40:30.265778 [info ] [MainThread]: Catalog written to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\catalog.json
[0m23:40:30.267786 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:40:30.267786 after 1.77 seconds
[0m23:40:30.267786 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:40:30.268784 [debug] [MainThread]: Connection 'tesla.information_schema' was properly closed.
[0m23:40:30.268784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58AB431F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58D35B8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58D167A30>]}
[0m23:40:30.269800 [debug] [MainThread]: Flushing usage events
[0m23:40:30.653444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:40:41.012825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F6267160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F7618C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F7618A30>]}


============================== 23:40:41.016826 | df2c4a4a-5908-4def-b927-01e148d9f5b0 ==============================
[0m23:40:41.016826 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:40:41.017833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:40:41.364057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df2c4a4a-5908-4def-b927-01e148d9f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F36F1750>]}
[0m23:40:41.451572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df2c4a4a-5908-4def-b927-01e148d9f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F3B355D0>]}
[0m23:42:03.828619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EC183220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168ED534CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168ED534AC0>]}


============================== 23:42:03.831620 | 9700b592-49a8-4c56-b744-24f641210422 ==============================
[0m23:42:03.831620 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:42:03.832610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:42:04.217990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9700b592-49a8-4c56-b744-24f641210422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168ED4A7EB0>]}
[0m23:42:04.312554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9700b592-49a8-4c56-b744-24f641210422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168ED4FA590>]}
[0m23:42:04.315543 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:42:04.533857 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:42:04.786318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m23:42:04.787317 [debug] [MainThread]: Partial parsing: added file: project_tesla://models\marts\tesla_vehicles_incremental.sql
[0m23:42:04.788315 [debug] [MainThread]: Partial parsing: added file: project_tesla://models\marts\tesla_price_trends.sql
[0m23:42:04.788315 [debug] [MainThread]: Partial parsing: added file: project_tesla://macros\utils.sql
[0m23:42:04.789317 [debug] [MainThread]: Partial parsing: added file: project_tesla://models\marts\tesla_ownership_analysis.sql
[0m23:42:04.789317 [debug] [MainThread]: Partial parsing: added file: project_tesla://models\marts\tesla_condition_analysis.sql
[0m23:42:04.790315 [debug] [MainThread]: Partial parsing: updated file: project_tesla://models\marts\schema.yml
[0m23:42:05.345302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9700b592-49a8-4c56-b744-24f641210422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EEDE0130>]}
[0m23:42:05.455831 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:42:05.457824 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:42:05.479431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9700b592-49a8-4c56-b744-24f641210422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EEDE2230>]}
[0m23:42:05.480424 [info ] [MainThread]: Found 6 models, 1 seed, 1 test, 1 source, 431 macros
[0m23:42:05.481434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9700b592-49a8-4c56-b744-24f641210422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EED708E0>]}
[0m23:42:05.483437 [info ] [MainThread]: 
[0m23:42:05.484446 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:42:05.484446 [info ] [MainThread]: 
[0m23:42:05.485426 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:42:05.491424 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla'
[0m23:42:05.561303 [debug] [ThreadPool]: Using duckdb connection "list_tesla"
[0m23:42:05.562303 [debug] [ThreadPool]: On list_tesla: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla"'
    
  
  
[0m23:42:05.563294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:05.647206 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m23:42:05.648827 [debug] [ThreadPool]: On list_tesla: Close
[0m23:42:05.649939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla, now create_tesla_main)
[0m23:42:05.651117 [debug] [ThreadPool]: Creating schema "database: "tesla"
schema: "main"
"
[0m23:42:05.658224 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:42:05.659278 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla'
        and type='sqlite'
    
  
[0m23:42:05.659800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:05.660853 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:42:05.662495 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:42:05.663015 [debug] [ThreadPool]: On create_tesla_main: BEGIN
[0m23:42:05.663618 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:42:05.664126 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:42:05.664681 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
    
        create schema if not exists "tesla"."main"
    
[0m23:42:05.665245 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:42:05.666342 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:42:05.666342 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:42:05.667352 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:42:05.667858 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:42:05.667858 [debug] [ThreadPool]: On create_tesla_main: Close
[0m23:42:05.669869 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:42:05.676449 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:42:05.677451 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:42:05.677451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:05.678451 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:42:05.679453 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:42:05.679453 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:42:05.693602 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m23:42:05.695198 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:42:05.695724 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:42:05.696264 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:42:05.697907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9700b592-49a8-4c56-b744-24f641210422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EACA1D80>]}
[0m23:42:05.698410 [debug] [MainThread]: Using duckdb connection "master"
[0m23:42:05.698936 [debug] [MainThread]: On master: BEGIN
[0m23:42:05.699449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:05.699968 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:42:05.700499 [debug] [MainThread]: On master: COMMIT
[0m23:42:05.700499 [debug] [MainThread]: Using duckdb connection "master"
[0m23:42:05.701019 [debug] [MainThread]: On master: COMMIT
[0m23:42:05.701538 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:42:05.702056 [debug] [MainThread]: On master: Close
[0m23:42:05.706321 [debug] [Thread-1 (]: Began running node model.project_tesla.stg_tesla_vehicles
[0m23:42:05.706836 [info ] [Thread-1 (]: 1 of 6 START sql view model main.stg_tesla_vehicles ............................ [RUN]
[0m23:42:05.707870 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.project_tesla.stg_tesla_vehicles'
[0m23:42:05.708389 [debug] [Thread-1 (]: Began compiling node model.project_tesla.stg_tesla_vehicles
[0m23:42:05.715949 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.stg_tesla_vehicles"
[0m23:42:05.716997 [debug] [Thread-1 (]: Began executing node model.project_tesla.stg_tesla_vehicles
[0m23:42:05.743378 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_tesla.stg_tesla_vehicles"
[0m23:42:05.744967 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m23:42:05.745972 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: BEGIN
[0m23:42:05.745972 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:42:05.747974 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:42:05.747974 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m23:42:05.748971 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.stg_tesla_vehicles"} */

  
  create view "tesla"."main"."stg_tesla_vehicles__dbt_tmp" as (
    

with source_data as (
    select * from "tesla"."main"."tesla_results"
),

staged as (
    select
        -- Basic vehicle information
        trim(model) as model,
        trim(trim_name) as trim_name,
        year,
        vin,
        
        -- Location information
        trim(country) as country,
        trim(country_code) as country_code,
        trim(city) as city,
        
        -- Price and metrics
        -- Extract numeric price from string
        regexp_extract(price, '[0-9]+') as price_str,
        try_cast(regexp_extract(price, '[0-9]+') as float) as price,
        try_cast(odometer as float) as odometer,
        
        -- Dates
        try_cast(original_delivery_date as timestamp) as delivery_date,
        try_cast(battery_warranty_exp_date as timestamp) as warranty_expiry_date,
        "current_time" as record_time_str,
        
        -- Additional attributes
        trim(color) as color,
        trim(vehicle_history) as vehicle_history,
        case 
            when vehicle_history is null then false
            when lower(vehicle_history) like '%accident%' then true
            else false
        end as had_accident,
        
        -- Status flags
        in_transit,
        trim(cpo_refurbishment_status) as refurbishment_status
    from source_data
)

select * from staged
  );

[0m23:42:05.750974 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:42:05.756974 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m23:42:05.756974 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.stg_tesla_vehicles"} */
alter view "tesla"."main"."stg_tesla_vehicles" rename to "stg_tesla_vehicles__dbt_backup"
[0m23:42:05.757972 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:42:05.760972 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m23:42:05.760972 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.stg_tesla_vehicles"} */
alter view "tesla"."main"."stg_tesla_vehicles__dbt_tmp" rename to "stg_tesla_vehicles"
[0m23:42:05.761973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:42:05.771981 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: COMMIT
[0m23:42:05.772972 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m23:42:05.772972 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: COMMIT
[0m23:42:05.778959 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:42:05.783966 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m23:42:05.783966 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.stg_tesla_vehicles"} */
drop view if exists "tesla"."main"."stg_tesla_vehicles__dbt_backup" cascade
[0m23:42:05.788965 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:42:05.790973 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: Close
[0m23:42:05.792966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9700b592-49a8-4c56-b744-24f641210422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E961D2A0>]}
[0m23:42:05.793976 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.stg_tesla_vehicles ....................... [[32mOK[0m in 0.08s]
[0m23:42:05.794965 [debug] [Thread-1 (]: Finished running node model.project_tesla.stg_tesla_vehicles
[0m23:42:05.795964 [debug] [Thread-3 (]: Began running node model.project_tesla.tesla_analysis
[0m23:42:05.795964 [debug] [Thread-4 (]: Began running node model.project_tesla.tesla_condition_analysis
[0m23:42:05.796964 [debug] [Thread-2 (]: Began running node model.project_tesla.tesla_ownership_analysis
[0m23:42:05.797977 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_price_trends
[0m23:42:05.798973 [info ] [Thread-3 (]: 2 of 6 START sql table model main.tesla_analysis ............................... [RUN]
[0m23:42:05.798973 [info ] [Thread-4 (]: 3 of 6 START sql table model main.tesla_condition_analysis ..................... [RUN]
[0m23:42:05.799965 [info ] [Thread-2 (]: 4 of 6 START sql table model main.tesla_ownership_analysis ..................... [RUN]
[0m23:42:05.800967 [info ] [Thread-1 (]: 5 of 6 START sql table model main.tesla_price_trends ........................... [RUN]
[0m23:42:05.801965 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_analysis'
[0m23:42:05.801965 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_condition_analysis'
[0m23:42:05.802966 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_ownership_analysis'
[0m23:42:05.802966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_tesla.stg_tesla_vehicles, now model.project_tesla.tesla_price_trends)
[0m23:42:05.803965 [debug] [Thread-3 (]: Began compiling node model.project_tesla.tesla_analysis
[0m23:42:05.803965 [debug] [Thread-4 (]: Began compiling node model.project_tesla.tesla_condition_analysis
[0m23:42:05.804966 [debug] [Thread-2 (]: Began compiling node model.project_tesla.tesla_ownership_analysis
[0m23:42:05.804966 [debug] [Thread-1 (]: Began compiling node model.project_tesla.tesla_price_trends
[0m23:42:05.807976 [debug] [Thread-3 (]: Writing injected SQL for node "model.project_tesla.tesla_analysis"
[0m23:42:05.810965 [debug] [Thread-4 (]: Writing injected SQL for node "model.project_tesla.tesla_condition_analysis"
[0m23:42:05.813973 [debug] [Thread-2 (]: Writing injected SQL for node "model.project_tesla.tesla_ownership_analysis"
[0m23:42:05.816968 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.tesla_price_trends"
[0m23:42:05.817965 [debug] [Thread-3 (]: Began executing node model.project_tesla.tesla_analysis
[0m23:42:05.834985 [debug] [Thread-3 (]: Writing runtime sql for node "model.project_tesla.tesla_analysis"
[0m23:42:05.834985 [debug] [Thread-4 (]: Began executing node model.project_tesla.tesla_condition_analysis
[0m23:42:05.835986 [debug] [Thread-2 (]: Began executing node model.project_tesla.tesla_ownership_analysis
[0m23:42:05.836984 [debug] [Thread-1 (]: Began executing node model.project_tesla.tesla_price_trends
[0m23:42:05.840506 [debug] [Thread-4 (]: Writing runtime sql for node "model.project_tesla.tesla_condition_analysis"
[0m23:42:05.841503 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:42:05.844504 [debug] [Thread-2 (]: Writing runtime sql for node "model.project_tesla.tesla_ownership_analysis"
[0m23:42:05.847504 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_tesla.tesla_price_trends"
[0m23:42:05.847504 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: BEGIN
[0m23:42:05.848495 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:42:05.849495 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:42:05.849495 [debug] [Thread-4 (]: On model.project_tesla.tesla_condition_analysis: BEGIN
[0m23:42:05.850499 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_ownership_analysis"
[0m23:42:05.850499 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_price_trends"
[0m23:42:05.851496 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m23:42:05.851496 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:42:05.852495 [debug] [Thread-2 (]: On model.project_tesla.tesla_ownership_analysis: BEGIN
[0m23:42:05.852495 [debug] [Thread-1 (]: On model.project_tesla.tesla_price_trends: BEGIN
[0m23:42:05.853506 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:42:05.853506 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m23:42:05.854496 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:42:05.854496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:05.855495 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_analysis"} */

  
    
    

    create  table
      "tesla"."main"."tesla_analysis__dbt_tmp"
  
    as (
      

with stg_tesla as (
    select * from "tesla"."main"."stg_tesla_vehicles"
),

country_stats as (
    select
        country,
        count(*) as total_vehicles,
        round(avg(price), 2) as avg_price,
        round(avg(odometer), 2) as avg_odometer,
        count(case when had_accident then 1 end) as vehicles_with_accidents,
        round(count(case when had_accident then 1 end) * 100.0 / count(*), 2) as accident_percentage
    from stg_tesla
    group by country
),

model_analysis as (
    select
        model,
        trim_name,
        count(*) as total_count,
        round(avg(price), 2) as avg_price,
        min(price) as min_price,
        max(price) as max_price,
        round(avg(odometer), 2) as avg_odometer
    from stg_tesla
    group by model, trim_name
)

select 
    'country_stats' as analysis_type,
    country as dimension,
    total_vehicles as count,
    avg_price,
    null as min_price,
    null as max_price,
    avg_odometer,
    vehicles_with_accidents,
    accident_percentage,
    null as trim_name
from country_stats

union all

select
    'model_analysis' as analysis_type,
    model as dimension,
    total_count as count,
    avg_price,
    min_price,
    max_price,
    avg_odometer,
    null as vehicles_with_accidents,
    null as accident_percentage,
    trim_name
from model_analysis
    );
  
  
[0m23:42:05.855495 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:42:05.856495 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:42:05.857495 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:42:05.857495 [debug] [Thread-4 (]: On model.project_tesla.tesla_condition_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_condition_analysis"} */

  
    
    

    create  table
      "tesla"."main"."tesla_condition_analysis__dbt_tmp"
  
    as (
      

-- Step 1: Get base vehicle data
with stg_tesla as (
    select * from "tesla"."main"."stg_tesla_vehicles"
),

-- Step 2: Categorize vehicles by age
vehicle_age_categories as (
    select 
        *,
        extract(year from current_date) - year as vehicle_age,
        case
            when extract(year from current_date) - year <= 1 then 'New (0-1 years)'
            when extract(year from current_date) - year <= 3 then 'Recent (1-3 years)'
            when extract(year from current_date) - year <= 5 then 'Mid-age (3-5 years)'
            else 'Older (5+ years)'
        end as age_category
    from stg_tesla
),

-- Step 3: Calculate accident statistics by age category
accident_by_age as (
    select
        age_category,
        count(*) as total_vehicles,
        sum(case when had_accident then 1 else 0 end) as accident_count,
        round(sum(case when had_accident then 1 else 0 end) * 100.0 / count(*), 2) as accident_percentage
    from vehicle_age_categories
    group by age_category
),

-- Step 4: Calculate accident statistics by model
accident_by_model as (
    select
        model,
        count(*) as total_vehicles,
        sum(case when had_accident then 1 else 0 end) as accident_count,
        round(sum(case when had_accident then 1 else 0 end) * 100.0 / count(*), 2) as accident_percentage
    from stg_tesla
    group by model
),

-- Step 5: Calculate mileage statistics by model and year
mileage_stats as (
    select
        model,
        year,
        count(*) as total_vehicles,
        round(avg(odometer), 2) as avg_mileage,
        min(odometer) as min_mileage,
        max(odometer) as max_mileage,
        round(stddev(odometer), 2) as mileage_stddev
    from stg_tesla
    where odometer is not null
    group by model, year
)

-- Combine all the analyses into a single result
select 
    'Accident Stats by Age' as analysis_type,
    age_category as dimension,
    total_vehicles,
    accident_count,
    accident_percentage,
    null as avg_mileage,
    null as model,
    null as year
from accident_by_age

union all

select 
    'Accident Stats by Model' as analysis_type,
    model as dimension,
    total_vehicles,
    accident_count,
    accident_percentage,
    null as avg_mileage,
    model,
    null as year
from accident_by_model

union all

select 
    'Mileage Stats by Model/Year' as analysis_type,
    model || ' (' || year || ')' as dimension,
    total_vehicles,
    null as accident_count,
    null as accident_percentage,
    avg_mileage,
    model,
    year
from mileage_stats
    );
  
  
[0m23:42:05.858496 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_ownership_analysis"
[0m23:42:05.858496 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_price_trends"
[0m23:42:05.860495 [debug] [Thread-2 (]: On model.project_tesla.tesla_ownership_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_ownership_analysis"} */

  
    
    

    create  table
      "tesla"."main"."tesla_ownership_analysis__dbt_tmp"
  
    as (
      

with stg_tesla as (
    select * from "tesla"."main"."stg_tesla_vehicles"
),

enhanced_data as (
    select
        
    case
        when vin is null then null
        when length(vin) < 10 then null
        else upper(regexp_replace(vin, '[^A-Za-z0-9]', ''))
    end
 as clean_vin,
        model,
        trim_name,
        year,
        price,
        
    case
        when price is null then 'Unknown'
        when price < 20000 then 'Budget (< 20K)'
        when price < 30000 then 'Value (20K-30K)'
        when price < 40000 then 'Mid-Range (30K-40K)'
        when price < 50000 then 'Premium (40K-50K)'
        else 'Luxury (50K+)'
    end
 as price_category,
        odometer,
        country,
        delivery_date,
        record_time_str,
        case 
            when delivery_date is not null and try_cast(record_time_str as timestamp) is not null then
                
    ((extract(year from try_cast(record_time_str as timestamp)) - extract(year from delivery_date)) + 
     (extract(month from try_cast(record_time_str as timestamp)) - extract(month from delivery_date)) / 12.0 + 
     (extract(day from try_cast(record_time_str as timestamp)) - extract(day from delivery_date)) / 365.0)

            else null
        end as ownership_years,
        had_accident
    from stg_tesla
),

ownership_analysis as (
    select
        price_category,
        count(*) as vehicle_count,
        round(avg(price), 2) as avg_price,
        round(avg(ownership_years), 2) as avg_ownership_years,
        round(avg(odometer), 2) as avg_odometer,
        round(avg(case when had_accident then 1.0 else 0.0 end) * 100, 2) as accident_percentage
    from enhanced_data
    where ownership_years is not null
    group by price_category
)

select * from ownership_analysis
order by avg_price
    );
  
  
[0m23:42:05.860495 [debug] [Thread-1 (]: On model.project_tesla.tesla_price_trends: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_price_trends"} */

  
    
    

    create  table
      "tesla"."main"."tesla_price_trends__dbt_tmp"
  
    as (
      

with stg_tesla as (
    select * from "tesla"."main"."stg_tesla_vehicles"
    where price is not null
),

country_model_stats as (
    select
        country,
        model,
        trim_name,
        year,
        round(avg(price), 2) as avg_price,
        count(*) as vehicle_count,
        min(price) as min_price,
        max(price) as max_price,
        round(stddev(price), 2) as price_stddev
    from stg_tesla
    group by country, model, trim_name, year
),

price_ranks as (
    select
        *,
        row_number() over (partition by country, model order by avg_price desc) as price_rank,
        avg_price - lag(avg_price) over (partition by country, model order by year) as price_diff_from_prev_year,
        round(avg_price / avg(avg_price) over (partition by country, model) * 100, 2) as percent_of_avg_model_price
    from country_model_stats
)

select * from price_ranks
order by country, model, year desc
    );
  
  
[0m23:42:05.938502 [debug] [Thread-4 (]: SQL status: OK in 0.079 seconds
[0m23:42:05.946564 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:42:05.947572 [debug] [Thread-4 (]: On model.project_tesla.tesla_condition_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_condition_analysis"} */
alter table "tesla"."main"."tesla_condition_analysis__dbt_tmp" rename to "tesla_condition_analysis"
[0m23:42:05.949572 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:42:05.960574 [debug] [Thread-4 (]: On model.project_tesla.tesla_condition_analysis: COMMIT
[0m23:42:05.961572 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:42:05.962574 [debug] [Thread-4 (]: On model.project_tesla.tesla_condition_analysis: COMMIT
[0m23:42:05.971188 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m23:42:05.976624 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:42:05.977631 [debug] [Thread-4 (]: On model.project_tesla.tesla_condition_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_condition_analysis"} */
drop table if exists "tesla"."main"."tesla_condition_analysis__dbt_backup" cascade
[0m23:42:05.979631 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:42:05.982639 [debug] [Thread-4 (]: On model.project_tesla.tesla_condition_analysis: Close
[0m23:42:05.985633 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9700b592-49a8-4c56-b744-24f641210422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EF2B8EB0>]}
[0m23:42:05.986633 [info ] [Thread-4 (]: 3 of 6 OK created sql table model main.tesla_condition_analysis ................ [[32mOK[0m in 0.18s]
[0m23:42:05.988632 [debug] [Thread-4 (]: Finished running node model.project_tesla.tesla_condition_analysis
[0m23:42:05.990632 [debug] [Thread-4 (]: Began running node model.project_tesla.tesla_vehicles_incremental
[0m23:42:05.991631 [info ] [Thread-4 (]: 6 of 6 START sql incremental model main.tesla_vehicles_incremental ............. [RUN]
[0m23:42:05.993631 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.project_tesla.tesla_condition_analysis, now model.project_tesla.tesla_vehicles_incremental)
[0m23:42:05.993631 [debug] [Thread-4 (]: Began compiling node model.project_tesla.tesla_vehicles_incremental
[0m23:42:05.999631 [debug] [Thread-4 (]: Writing injected SQL for node "model.project_tesla.tesla_vehicles_incremental"
[0m23:42:06.002633 [debug] [Thread-4 (]: Began executing node model.project_tesla.tesla_vehicles_incremental
[0m23:42:06.054663 [debug] [Thread-3 (]: SQL status: OK in 0.197 seconds
[0m23:42:06.061669 [debug] [Thread-4 (]: Writing runtime sql for node "model.project_tesla.tesla_vehicles_incremental"
[0m23:42:06.061669 [debug] [Thread-2 (]: SQL status: OK in 0.201 seconds
[0m23:42:06.066662 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:42:06.071696 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_ownership_analysis"
[0m23:42:06.072694 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_vehicles_incremental"
[0m23:42:06.073695 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_analysis"} */
alter table "tesla"."main"."tesla_analysis" rename to "tesla_analysis__dbt_backup"
[0m23:42:06.073695 [debug] [Thread-2 (]: On model.project_tesla.tesla_ownership_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_ownership_analysis"} */
alter table "tesla"."main"."tesla_ownership_analysis__dbt_tmp" rename to "tesla_ownership_analysis"
[0m23:42:06.074695 [debug] [Thread-4 (]: On model.project_tesla.tesla_vehicles_incremental: BEGIN
[0m23:42:06.075697 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:06.076694 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:42:06.077693 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:42:06.078696 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m23:42:06.082705 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:42:06.085691 [debug] [Thread-2 (]: On model.project_tesla.tesla_ownership_analysis: COMMIT
[0m23:42:06.086694 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_vehicles_incremental"
[0m23:42:06.087780 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_analysis"} */
alter table "tesla"."main"."tesla_analysis__dbt_tmp" rename to "tesla_analysis"
[0m23:42:06.088789 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_ownership_analysis"
[0m23:42:06.089788 [debug] [Thread-4 (]: On model.project_tesla.tesla_vehicles_incremental: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_vehicles_incremental"} */

  
    
    

    create  table
      "tesla"."main"."tesla_vehicles_incremental"
  
    as (
      

with source_data as (
    select * from "tesla"."main"."stg_tesla_vehicles"
    
    
)

select
    vin,
    model,
    trim_name,
    year,
    country,
    city,
    price,
    odometer,
    delivery_date,
    had_accident,
    refurbishment_status,
    color,
    record_time_str
from source_data
    );
  
  
  
[0m23:42:06.090788 [debug] [Thread-2 (]: On model.project_tesla.tesla_ownership_analysis: COMMIT
[0m23:42:06.092786 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m23:42:06.095397 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: COMMIT
[0m23:42:06.095397 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:42:06.096402 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: COMMIT
[0m23:42:06.098433 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m23:42:06.103649 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_ownership_analysis"
[0m23:42:06.104649 [debug] [Thread-2 (]: On model.project_tesla.tesla_ownership_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_ownership_analysis"} */
drop table if exists "tesla"."main"."tesla_ownership_analysis__dbt_backup" cascade
[0m23:42:06.106652 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:42:06.109153 [debug] [Thread-2 (]: On model.project_tesla.tesla_ownership_analysis: Close
[0m23:42:06.110158 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9700b592-49a8-4c56-b744-24f641210422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EF2BB970>]}
[0m23:42:06.112161 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m23:42:06.111160 [info ] [Thread-2 (]: 4 of 6 OK created sql table model main.tesla_ownership_analysis ................ [[32mOK[0m in 0.31s]
[0m23:42:06.117160 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:42:06.118159 [debug] [Thread-2 (]: Finished running node model.project_tesla.tesla_ownership_analysis
[0m23:42:06.119360 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_analysis"} */
drop table if exists "tesla"."main"."tesla_analysis__dbt_backup" cascade
[0m23:42:06.124817 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m23:42:06.126816 [debug] [Thread-3 (]: On model.project_tesla.tesla_analysis: Close
[0m23:42:06.127816 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9700b592-49a8-4c56-b744-24f641210422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E961D2A0>]}
[0m23:42:06.129816 [debug] [Thread-1 (]: SQL status: OK in 0.268 seconds
[0m23:42:06.128818 [info ] [Thread-3 (]: 2 of 6 OK created sql table model main.tesla_analysis .......................... [[32mOK[0m in 0.33s]
[0m23:42:06.136224 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_price_trends"
[0m23:42:06.137363 [debug] [Thread-3 (]: Finished running node model.project_tesla.tesla_analysis
[0m23:42:06.138368 [debug] [Thread-1 (]: On model.project_tesla.tesla_price_trends: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_price_trends"} */
alter table "tesla"."main"."tesla_price_trends__dbt_tmp" rename to "tesla_price_trends"
[0m23:42:06.139873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:42:06.140882 [debug] [Thread-1 (]: On model.project_tesla.tesla_price_trends: COMMIT
[0m23:42:06.141881 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_price_trends"
[0m23:42:06.142892 [debug] [Thread-1 (]: On model.project_tesla.tesla_price_trends: COMMIT
[0m23:42:06.146879 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:42:06.152882 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_price_trends"
[0m23:42:06.153884 [debug] [Thread-1 (]: On model.project_tesla.tesla_price_trends: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_price_trends"} */
drop table if exists "tesla"."main"."tesla_price_trends__dbt_backup" cascade
[0m23:42:06.154882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:42:06.156881 [debug] [Thread-1 (]: On model.project_tesla.tesla_price_trends: Close
[0m23:42:06.157882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9700b592-49a8-4c56-b744-24f641210422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EF38EEC0>]}
[0m23:42:06.158882 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.tesla_price_trends ...................... [[32mOK[0m in 0.35s]
[0m23:42:06.159882 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_price_trends
[0m23:42:06.598388 [debug] [Thread-4 (]: SQL status: OK in 0.507 seconds
[0m23:42:06.600378 [debug] [Thread-4 (]: On model.project_tesla.tesla_vehicles_incremental: COMMIT
[0m23:42:06.601376 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_vehicles_incremental"
[0m23:42:06.602389 [debug] [Thread-4 (]: On model.project_tesla.tesla_vehicles_incremental: COMMIT
[0m23:42:06.617375 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m23:42:06.618374 [debug] [Thread-4 (]: On model.project_tesla.tesla_vehicles_incremental: Close
[0m23:42:06.619374 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9700b592-49a8-4c56-b744-24f641210422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EF2CD480>]}
[0m23:42:06.620374 [info ] [Thread-4 (]: 6 of 6 OK created sql incremental model main.tesla_vehicles_incremental ........ [[32mOK[0m in 0.63s]
[0m23:42:06.622383 [debug] [Thread-4 (]: Finished running node model.project_tesla.tesla_vehicles_incremental
[0m23:42:06.623373 [debug] [MainThread]: Using duckdb connection "master"
[0m23:42:06.624389 [debug] [MainThread]: On master: BEGIN
[0m23:42:06.624389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:06.625384 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:42:06.626403 [debug] [MainThread]: On master: COMMIT
[0m23:42:06.626403 [debug] [MainThread]: Using duckdb connection "master"
[0m23:42:06.626403 [debug] [MainThread]: On master: COMMIT
[0m23:42:06.627401 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:42:06.628401 [debug] [MainThread]: On master: Close
[0m23:42:06.628401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:06.629405 [debug] [MainThread]: Connection 'create_tesla_main' was properly closed.
[0m23:42:06.629405 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:42:06.630403 [debug] [MainThread]: Connection 'model.project_tesla.tesla_price_trends' was properly closed.
[0m23:42:06.630403 [debug] [MainThread]: Connection 'model.project_tesla.tesla_analysis' was properly closed.
[0m23:42:06.630403 [debug] [MainThread]: Connection 'model.project_tesla.tesla_vehicles_incremental' was properly closed.
[0m23:42:06.631402 [debug] [MainThread]: Connection 'model.project_tesla.tesla_ownership_analysis' was properly closed.
[0m23:42:06.631402 [info ] [MainThread]: 
[0m23:42:06.632405 [info ] [MainThread]: Finished running 1 incremental model, 4 table models, 1 view model in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m23:42:06.635406 [debug] [MainThread]: Command end result
[0m23:42:06.722919 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:42:06.724919 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:42:06.731931 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:42:06.731931 [info ] [MainThread]: 
[0m23:42:06.732923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:42:06.733923 [info ] [MainThread]: 
[0m23:42:06.734923 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m23:42:06.735923 [debug] [MainThread]: Command `dbt run` succeeded at 23:42:06.735923 after 3.01 seconds
[0m23:42:06.736938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EC183220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EF2DD5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EF2DD630>]}
[0m23:42:06.736938 [debug] [MainThread]: Flushing usage events
[0m23:42:07.238423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:28.418210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1F98E3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1FACA0CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1FACA0AF0>]}


============================== 23:42:28.423297 | 38225c2b-2df3-4ee8-a04f-a17c679d7d8c ==============================
[0m23:42:28.423297 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:42:28.424210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile --select analyses/top_value_vehicles.sql', 'send_anonymous_usage_stats': 'True'}
[0m23:42:28.777492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38225c2b-2df3-4ee8-a04f-a17c679d7d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1FADBA290>]}
[0m23:42:28.857507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38225c2b-2df3-4ee8-a04f-a17c679d7d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1FACA2710>]}
[0m23:42:28.861045 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:42:29.092155 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:42:29.323215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:42:29.323215 [debug] [MainThread]: Partial parsing: added file: project_tesla://analyses\top_value_vehicles.sql
[0m23:42:29.692385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38225c2b-2df3-4ee8-a04f-a17c679d7d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1FC3CD630>]}
[0m23:42:29.829305 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:42:29.831302 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:42:29.855261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38225c2b-2df3-4ee8-a04f-a17c679d7d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1FC0BF5B0>]}
[0m23:42:29.856258 [info ] [MainThread]: Found 6 models, 1 seed, 1 test, 1 analysis, 1 source, 431 macros
[0m23:42:29.856258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38225c2b-2df3-4ee8-a04f-a17c679d7d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1FC2ADAE0>]}
[0m23:42:29.858261 [info ] [MainThread]: 
[0m23:42:29.859250 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:42:29.859250 [info ] [MainThread]: 
[0m23:42:29.859250 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:42:29.865474 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:42:29.940688 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:42:29.941203 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:42:29.941728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:30.035069 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m23:42:30.036076 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:42:30.037075 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:42:30.052719 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m23:42:30.054719 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:42:30.055717 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:42:30.056778 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:42:30.058638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38225c2b-2df3-4ee8-a04f-a17c679d7d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1FC297730>]}
[0m23:42:30.063648 [debug] [Thread-1 (]: Began running node analysis.project_tesla.top_value_vehicles
[0m23:42:30.064648 [debug] [Thread-1 (]: Acquiring new duckdb connection 'analysis.project_tesla.top_value_vehicles'
[0m23:42:30.065656 [debug] [Thread-1 (]: Began compiling node analysis.project_tesla.top_value_vehicles
[0m23:42:30.073480 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.project_tesla.top_value_vehicles"
[0m23:42:30.075307 [debug] [Thread-1 (]: Began executing node analysis.project_tesla.top_value_vehicles
[0m23:42:30.076352 [debug] [Thread-1 (]: Finished running node analysis.project_tesla.top_value_vehicles
[0m23:42:30.077908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:30.078436 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:42:30.078962 [debug] [MainThread]: Connection 'analysis.project_tesla.top_value_vehicles' was properly closed.
[0m23:42:30.079561 [debug] [MainThread]: Command end result
[0m23:42:30.104671 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:42:30.107324 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:42:30.115418 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:42:30.115963 [info ] [MainThread]: Compiled node 'top_value_vehicles' is:
-- This analysis helps identify the most valuable Tesla inventory

with vehicles as (
    select * from "tesla"."main"."stg_tesla_vehicles"
),

value_score as (
    select 
        vin,
        model,
        trim_name,
        year,
        price,
        odometer,
        country,
        had_accident,
        -- Calculate a "value score" based on price, age, and condition
        price * (
            (1.0 - (extract(year from current_date) - year) * 0.1) -- Age devaluation
            * (case when had_accident then 0.7 else 1.0 end) -- Accident devaluation
            * (case 
                when odometer is null then 0.9 
                else (1.0 - least(odometer / 200000, 0.7)) -- Mileage devaluation
              end)
        ) as value_score
    from vehicles
    where price is not null
),

ranked_vehicles as (
    select 
        *,
        row_number() over (partition by model order by value_score desc) as model_value_rank,
        row_number() over (order by value_score desc) as overall_value_rank
    from value_score
)

-- Top 10 vehicles by overall value
select 
    vin,
    model,
    trim_name,
    year,
    price,
    odometer,
    country,
    had_accident,
    round(value_score, 2) as value_score,
    overall_value_rank
from ranked_vehicles
where overall_value_rank <= 10
order by overall_value_rank
[0m23:42:30.118164 [debug] [MainThread]: Command `dbt compile` succeeded at 23:42:30.117568 after 1.79 seconds
[0m23:42:30.118668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1F98E3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1FC3088E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1FAE604F0>]}
[0m23:42:30.119196 [debug] [MainThread]: Flushing usage events
[0m23:42:30.488842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:44.537969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B6C9F3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B6ED74CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B6ED74AF0>]}


============================== 23:42:44.541972 | 70aa7c36-d15c-432f-9a99-fee8ebe640e7 ==============================
[0m23:42:44.541972 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:42:44.542969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:42:44.888138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70aa7c36-d15c-432f-9a99-fee8ebe640e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B6E43C280>]}
[0m23:42:44.971146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70aa7c36-d15c-432f-9a99-fee8ebe640e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B6EE2EFE0>]}
[0m23:42:44.973658 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:42:45.215227 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:42:45.467156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:42:45.468174 [debug] [MainThread]: Partial parsing: added file: project_tesla://snapshots\tesla_price_history.sql
[0m23:42:45.867777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70aa7c36-d15c-432f-9a99-fee8ebe640e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B70490040>]}
[0m23:42:46.021500 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:42:46.023497 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:42:46.049497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70aa7c36-d15c-432f-9a99-fee8ebe640e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B70389BA0>]}
[0m23:42:46.050497 [info ] [MainThread]: Found 6 models, 1 seed, 1 test, 1 analysis, 1 snapshot, 1 source, 431 macros
[0m23:42:46.051490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70aa7c36-d15c-432f-9a99-fee8ebe640e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B704D4070>]}
[0m23:42:46.053492 [info ] [MainThread]: 
[0m23:42:46.053492 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:42:46.054490 [info ] [MainThread]: 
[0m23:42:46.055489 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:42:46.056491 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla'
[0m23:42:46.137545 [debug] [ThreadPool]: Using duckdb connection "list_tesla"
[0m23:42:46.138546 [debug] [ThreadPool]: On list_tesla: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla"'
    
  
  
[0m23:42:46.138546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:46.219706 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m23:42:46.221705 [debug] [ThreadPool]: On list_tesla: Close
[0m23:42:46.222700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla, now create_tesla_main)
[0m23:42:46.223710 [debug] [ThreadPool]: Creating schema "database: "tesla"
schema: "main"
"
[0m23:42:46.231707 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:42:46.231707 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla'
        and type='sqlite'
    
  
[0m23:42:46.232709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:46.233707 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:42:46.235700 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:42:46.235700 [debug] [ThreadPool]: On create_tesla_main: BEGIN
[0m23:42:46.236699 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:42:46.236699 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:42:46.237700 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
    
        create schema if not exists "tesla"."main"
    
[0m23:42:46.238700 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:42:46.239708 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:42:46.239708 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:42:46.240710 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:42:46.240710 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:42:46.241707 [debug] [ThreadPool]: On create_tesla_main: Close
[0m23:42:46.248708 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:42:46.255699 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:42:46.255699 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:42:46.256712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:46.256712 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:42:46.257699 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:42:46.257699 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:42:46.273724 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m23:42:46.274777 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:42:46.275779 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:42:46.276779 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:42:46.278766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70aa7c36-d15c-432f-9a99-fee8ebe640e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B70492110>]}
[0m23:42:46.279777 [debug] [MainThread]: Using duckdb connection "master"
[0m23:42:46.279777 [debug] [MainThread]: On master: BEGIN
[0m23:42:46.279777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:46.280775 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:42:46.281775 [debug] [MainThread]: On master: COMMIT
[0m23:42:46.281775 [debug] [MainThread]: Using duckdb connection "master"
[0m23:42:46.281775 [debug] [MainThread]: On master: COMMIT
[0m23:42:46.282774 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:42:46.282774 [debug] [MainThread]: On master: Close
[0m23:42:46.287773 [debug] [Thread-1 (]: Began running node snapshot.project_tesla.tesla_price_history
[0m23:42:46.288768 [info ] [Thread-1 (]: 1 of 1 START snapshot main.tesla_price_history ................................. [RUN]
[0m23:42:46.290765 [debug] [Thread-1 (]: Acquiring new duckdb connection 'snapshot.project_tesla.tesla_price_history'
[0m23:42:46.291765 [debug] [Thread-1 (]: Began compiling node snapshot.project_tesla.tesla_price_history
[0m23:42:46.300094 [debug] [Thread-1 (]: Began executing node snapshot.project_tesla.tesla_price_history
[0m23:42:46.362855 [debug] [Thread-1 (]: Using duckdb connection "snapshot.project_tesla.tesla_price_history"
[0m23:42:46.363859 [debug] [Thread-1 (]: On snapshot.project_tesla.tesla_price_history: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "snapshot.project_tesla.tesla_price_history"} */
DESCRIBE (select * from (
        
    

    select *,
        md5(coalesce(cast(vin as varchar ), '')
         || '|' || coalesce(cast(record_time_str as varchar ), '')
        ) as dbt_scd_id,
        record_time_str as dbt_updated_at,
        record_time_str as dbt_valid_from,
        
  
  coalesce(nullif(record_time_str, record_time_str), null)
  as dbt_valid_to
from (
        



select 
    vin,
    model,
    trim_name,
    year,
    price,
    country,
    record_time_str
from "tesla"."main"."stg_tesla_vehicles"
where price is not null

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
)
[0m23:42:46.363859 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:42:46.369298 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:42:46.374813 [debug] [Thread-1 (]: Using duckdb connection "snapshot.project_tesla.tesla_price_history"
[0m23:42:46.375812 [debug] [Thread-1 (]: On snapshot.project_tesla.tesla_price_history: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "snapshot.project_tesla.tesla_price_history"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m23:42:46.376813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:42:46.377813 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.project_tesla.tesla_price_history"
[0m23:42:46.378812 [debug] [Thread-1 (]: Using duckdb connection "snapshot.project_tesla.tesla_price_history"
[0m23:42:46.378812 [debug] [Thread-1 (]: On snapshot.project_tesla.tesla_price_history: BEGIN
[0m23:42:46.379813 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:42:46.380816 [debug] [Thread-1 (]: Using duckdb connection "snapshot.project_tesla.tesla_price_history"
[0m23:42:46.380816 [debug] [Thread-1 (]: On snapshot.project_tesla.tesla_price_history: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "snapshot.project_tesla.tesla_price_history"} */

      
  
    
    

    create  table
      "tesla"."main"."tesla_price_history"
  
    as (
      
    

    select *,
        md5(coalesce(cast(vin as varchar ), '')
         || '|' || coalesce(cast(record_time_str as varchar ), '')
        ) as dbt_scd_id,
        record_time_str as dbt_updated_at,
        record_time_str as dbt_valid_from,
        
  
  coalesce(nullif(record_time_str, record_time_str), null)
  as dbt_valid_to
from (
        



select 
    vin,
    model,
    trim_name,
    year,
    price,
    country,
    record_time_str
from "tesla"."main"."stg_tesla_vehicles"
where price is not null

    ) sbq



    );
  
  
  
[0m23:42:46.765451 [debug] [Thread-1 (]: SQL status: OK in 0.384 seconds
[0m23:42:46.777991 [debug] [Thread-1 (]: On snapshot.project_tesla.tesla_price_history: COMMIT
[0m23:42:46.778995 [debug] [Thread-1 (]: Using duckdb connection "snapshot.project_tesla.tesla_price_history"
[0m23:42:46.778995 [debug] [Thread-1 (]: On snapshot.project_tesla.tesla_price_history: COMMIT
[0m23:42:46.802974 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m23:42:46.804984 [debug] [Thread-1 (]: On snapshot.project_tesla.tesla_price_history: Close
[0m23:42:46.807972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70aa7c36-d15c-432f-9a99-fee8ebe640e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B6AE41B10>]}
[0m23:42:46.807972 [info ] [Thread-1 (]: 1 of 1 OK snapshotted main.tesla_price_history ................................. [[32mOK[0m in 0.52s]
[0m23:42:46.809974 [debug] [Thread-1 (]: Finished running node snapshot.project_tesla.tesla_price_history
[0m23:42:46.810992 [debug] [MainThread]: Using duckdb connection "master"
[0m23:42:46.810992 [debug] [MainThread]: On master: BEGIN
[0m23:42:46.811973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:46.811973 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:42:46.812984 [debug] [MainThread]: On master: COMMIT
[0m23:42:46.812984 [debug] [MainThread]: Using duckdb connection "master"
[0m23:42:46.812984 [debug] [MainThread]: On master: COMMIT
[0m23:42:46.813986 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:42:46.813986 [debug] [MainThread]: On master: Close
[0m23:42:46.814972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:46.814972 [debug] [MainThread]: Connection 'create_tesla_main' was properly closed.
[0m23:42:46.814972 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:42:46.815973 [debug] [MainThread]: Connection 'snapshot.project_tesla.tesla_price_history' was properly closed.
[0m23:42:46.815973 [info ] [MainThread]: 
[0m23:42:46.815973 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m23:42:46.816974 [debug] [MainThread]: Command end result
[0m23:42:46.839973 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:42:46.842972 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:42:46.849972 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:42:46.849972 [info ] [MainThread]: 
[0m23:42:46.850973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:42:46.851974 [info ] [MainThread]: 
[0m23:42:46.852973 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:42:46.854986 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:42:46.853974 after 2.40 seconds
[0m23:42:46.854986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B6C9F3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B6EE2EE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B70502680>]}
[0m23:42:46.855975 [debug] [MainThread]: Flushing usage events
[0m23:42:47.245139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:43:09.421035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EC9E71C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EDD9B340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EDD9B160>]}


============================== 23:43:09.426035 | 096e585b-5a13-4b6f-8b90-96dd9997b318 ==============================
[0m23:43:09.426035 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:43:09.427036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m23:43:09.797174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '096e585b-5a13-4b6f-8b90-96dd9997b318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E9E63D90>]}
[0m23:43:09.881332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '096e585b-5a13-4b6f-8b90-96dd9997b318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EDD99810>]}
[0m23:43:09.884336 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:43:10.112931 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:43:10.367165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:43:10.368164 [debug] [MainThread]: Partial parsing: added file: project_tesla://macros\tests\positive_value.sql
[0m23:43:10.369219 [debug] [MainThread]: Partial parsing: updated file: project_tesla://models\staging\schema.yml
[0m23:43:10.944459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '096e585b-5a13-4b6f-8b90-96dd9997b318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EF5AAE60>]}
[0m23:43:11.095559 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:43:11.099079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:43:11.131081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '096e585b-5a13-4b6f-8b90-96dd9997b318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EF6C9450>]}
[0m23:43:11.131081 [info ] [MainThread]: Found 6 models, 1 seed, 1 analysis, 1 snapshot, 4 data tests, 1 source, 432 macros
[0m23:43:11.132077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '096e585b-5a13-4b6f-8b90-96dd9997b318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EF6CB5B0>]}
[0m23:43:11.134077 [info ] [MainThread]: 
[0m23:43:11.134077 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:11.135071 [info ] [MainThread]: 
[0m23:43:11.136073 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:43:11.142069 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:43:11.230591 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:43:11.231592 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:43:11.232590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:11.330181 [debug] [ThreadPool]: SQL status: OK in 0.098 seconds
[0m23:43:11.331178 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:43:11.332216 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:43:11.347114 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m23:43:11.349117 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:43:11.350114 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:43:11.350114 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:43:11.352112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '096e585b-5a13-4b6f-8b90-96dd9997b318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EF6C82B0>]}
[0m23:43:11.353112 [debug] [MainThread]: Using duckdb connection "master"
[0m23:43:11.353112 [debug] [MainThread]: On master: BEGIN
[0m23:43:11.354108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:11.355114 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:43:11.355114 [debug] [MainThread]: On master: COMMIT
[0m23:43:11.356125 [debug] [MainThread]: Using duckdb connection "master"
[0m23:43:11.356125 [debug] [MainThread]: On master: COMMIT
[0m23:43:11.357106 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:43:11.357106 [debug] [MainThread]: On master: Close
[0m23:43:11.362107 [debug] [Thread-1 (]: Began running node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:43:11.362107 [debug] [Thread-2 (]: Began running node test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3
[0m23:43:11.362107 [debug] [Thread-3 (]: Began running node test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60
[0m23:43:11.363107 [debug] [Thread-4 (]: Began running node test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707
[0m23:43:11.363107 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_tesla_vehicles_vin .............................. [RUN]
[0m23:43:11.364119 [info ] [Thread-2 (]: 2 of 4 START test positive_value_stg_tesla_vehicles_odometer ................... [RUN]
[0m23:43:11.365127 [info ] [Thread-3 (]: 3 of 4 START test positive_value_stg_tesla_vehicles_price ...................... [RUN]
[0m23:43:11.366109 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f'
[0m23:43:11.365127 [info ] [Thread-4 (]: 4 of 4 START test positive_value_stg_tesla_vehicles_year ....................... [RUN]
[0m23:43:11.367106 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3'
[0m23:43:11.367106 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60'
[0m23:43:11.368108 [debug] [Thread-1 (]: Began compiling node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:43:11.368108 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707'
[0m23:43:11.369110 [debug] [Thread-2 (]: Began compiling node test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3
[0m23:43:11.369110 [debug] [Thread-3 (]: Began compiling node test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60
[0m23:43:11.381106 [debug] [Thread-1 (]: Writing injected SQL for node "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:43:11.381106 [debug] [Thread-4 (]: Began compiling node test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707
[0m23:43:11.385111 [debug] [Thread-2 (]: Writing injected SQL for node "test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3"
[0m23:43:11.388113 [debug] [Thread-3 (]: Writing injected SQL for node "test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60"
[0m23:43:11.392112 [debug] [Thread-4 (]: Writing injected SQL for node "test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707"
[0m23:43:11.393112 [debug] [Thread-1 (]: Began executing node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:43:11.408622 [debug] [Thread-1 (]: Writing runtime sql for node "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:43:11.408622 [debug] [Thread-2 (]: Began executing node test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3
[0m23:43:11.412623 [debug] [Thread-2 (]: Writing runtime sql for node "test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3"
[0m23:43:11.413623 [debug] [Thread-1 (]: Using duckdb connection "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:43:11.414622 [debug] [Thread-4 (]: Began executing node test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707
[0m23:43:11.414622 [debug] [Thread-3 (]: Began executing node test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60
[0m23:43:11.415624 [debug] [Thread-1 (]: On test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f: BEGIN
[0m23:43:11.417622 [debug] [Thread-4 (]: Writing runtime sql for node "test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707"
[0m23:43:11.418623 [debug] [Thread-2 (]: Using duckdb connection "test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3"
[0m23:43:11.420628 [debug] [Thread-3 (]: Writing runtime sql for node "test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60"
[0m23:43:11.421622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:43:11.422623 [debug] [Thread-2 (]: On test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3: BEGIN
[0m23:43:11.422623 [debug] [Thread-4 (]: Using duckdb connection "test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707"
[0m23:43:11.423628 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:43:11.424623 [debug] [Thread-3 (]: Using duckdb connection "test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60"
[0m23:43:11.424623 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:43:11.425623 [debug] [Thread-4 (]: On test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707: BEGIN
[0m23:43:11.425623 [debug] [Thread-3 (]: On test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60: BEGIN
[0m23:43:11.426622 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:43:11.426622 [debug] [Thread-1 (]: Using duckdb connection "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:43:11.427624 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:43:11.427624 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:43:11.428623 [debug] [Thread-2 (]: Using duckdb connection "test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3"
[0m23:43:11.428623 [debug] [Thread-1 (]: On test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vin
from "tesla"."main"."stg_tesla_vehicles"
where vin is null



  
  
      
    ) dbt_internal_test
[0m23:43:11.429623 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m23:43:11.430623 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m23:43:11.430623 [debug] [Thread-2 (]: On test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with validation as (
    select
        odometer as value_field
    from "tesla"."main"."stg_tesla_vehicles"
    where odometer is not null and odometer <= 0
)

select *
from validation


  
  
      
    ) dbt_internal_test
[0m23:43:11.431623 [debug] [Thread-4 (]: Using duckdb connection "test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707"
[0m23:43:11.431623 [debug] [Thread-3 (]: Using duckdb connection "test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60"
[0m23:43:11.432624 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:43:11.432624 [debug] [Thread-4 (]: On test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with validation as (
    select
        year as value_field
    from "tesla"."main"."stg_tesla_vehicles"
    where year is not null and year <= 0
)

select *
from validation


  
  
      
    ) dbt_internal_test
[0m23:43:11.433623 [debug] [Thread-3 (]: On test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with validation as (
    select
        price as value_field
    from "tesla"."main"."stg_tesla_vehicles"
    where price is not null and price <= 0
)

select *
from validation


  
  
      
    ) dbt_internal_test
[0m23:43:11.439623 [debug] [Thread-1 (]: On test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f: ROLLBACK
[0m23:43:11.441624 [debug] [Thread-1 (]: Failed to rollback 'test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f'
[0m23:43:11.441624 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m23:43:11.442626 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m23:43:11.442626 [debug] [Thread-1 (]: On test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f: Close
[0m23:43:11.445628 [debug] [Thread-2 (]: On test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3: ROLLBACK
[0m23:43:11.446625 [debug] [Thread-4 (]: On test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707: ROLLBACK
[0m23:43:11.448627 [debug] [Thread-2 (]: Failed to rollback 'test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3'
[0m23:43:11.447627 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_tesla_vehicles_vin .................................... [[32mPASS[0m in 0.08s]
[0m23:43:11.449626 [debug] [Thread-4 (]: Failed to rollback 'test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707'
[0m23:43:11.449626 [debug] [Thread-2 (]: On test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3: Close
[0m23:43:11.450625 [debug] [Thread-1 (]: Finished running node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:43:11.451624 [debug] [Thread-4 (]: On test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707: Close
[0m23:43:11.452626 [info ] [Thread-2 (]: 2 of 4 PASS positive_value_stg_tesla_vehicles_odometer ......................... [[32mPASS[0m in 0.08s]
[0m23:43:11.454626 [debug] [Thread-2 (]: Finished running node test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3
[0m23:43:11.453623 [info ] [Thread-4 (]: 4 of 4 PASS positive_value_stg_tesla_vehicles_year ............................. [[32mPASS[0m in 0.09s]
[0m23:43:11.456629 [debug] [Thread-4 (]: Finished running node test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707
[0m23:43:11.506298 [debug] [Thread-3 (]: SQL status: OK in 0.066 seconds
[0m23:43:11.509370 [debug] [Thread-3 (]: On test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60: ROLLBACK
[0m23:43:11.510366 [debug] [Thread-3 (]: Failed to rollback 'test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60'
[0m23:43:11.510366 [debug] [Thread-3 (]: On test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60: Close
[0m23:43:11.511358 [info ] [Thread-3 (]: 3 of 4 PASS positive_value_stg_tesla_vehicles_price ............................ [[32mPASS[0m in 0.14s]
[0m23:43:11.513300 [debug] [Thread-3 (]: Finished running node test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60
[0m23:43:11.514298 [debug] [MainThread]: Using duckdb connection "master"
[0m23:43:11.515309 [debug] [MainThread]: On master: BEGIN
[0m23:43:11.515309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:11.516307 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:43:11.516307 [debug] [MainThread]: On master: COMMIT
[0m23:43:11.517307 [debug] [MainThread]: Using duckdb connection "master"
[0m23:43:11.517307 [debug] [MainThread]: On master: COMMIT
[0m23:43:11.518298 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:43:11.519304 [debug] [MainThread]: On master: Close
[0m23:43:11.519304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:11.520299 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:43:11.520299 [debug] [MainThread]: Connection 'test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f' was properly closed.
[0m23:43:11.521298 [debug] [MainThread]: Connection 'test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3' was properly closed.
[0m23:43:11.521298 [debug] [MainThread]: Connection 'test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60' was properly closed.
[0m23:43:11.521298 [debug] [MainThread]: Connection 'test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707' was properly closed.
[0m23:43:11.522307 [info ] [MainThread]: 
[0m23:43:11.523302 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:43:11.524303 [debug] [MainThread]: Command end result
[0m23:43:11.552299 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:43:11.555312 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:43:11.562306 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:43:11.563297 [info ] [MainThread]: 
[0m23:43:11.564301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:43:11.565315 [info ] [MainThread]: 
[0m23:43:11.566301 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m23:43:11.567302 [debug] [MainThread]: Command `dbt test` succeeded at 23:43:11.567302 after 2.24 seconds
[0m23:43:11.568303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EC9E71C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EF745930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EB577760>]}
[0m23:43:11.568303 [debug] [MainThread]: Flushing usage events
[0m23:43:11.984625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:43:32.677294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B55F343220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5606FB3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5606FB1C0>]}


============================== 23:43:32.681294 | 4962e79c-c005-4b29-bbcf-376ec3f33cad ==============================
[0m23:43:32.681294 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:43:32.682290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:43:33.012545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4962e79c-c005-4b29-bbcf-376ec3f33cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56082B940>]}
[0m23:43:33.101062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4962e79c-c005-4b29-bbcf-376ec3f33cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5606FB1F0>]}
[0m23:43:33.105068 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:43:33.312127 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:43:33.581298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:33.582297 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:33.727375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4962e79c-c005-4b29-bbcf-376ec3f33cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5607CB700>]}
[0m23:43:33.751374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4962e79c-c005-4b29-bbcf-376ec3f33cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5606CBF10>]}
[0m23:43:33.752374 [info ] [MainThread]: Found 6 models, 1 seed, 1 analysis, 1 snapshot, 4 data tests, 1 source, 432 macros
[0m23:43:33.753373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4962e79c-c005-4b29-bbcf-376ec3f33cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5606CBA90>]}
[0m23:43:33.754374 [info ] [MainThread]: 
[0m23:43:33.755374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:33.756374 [info ] [MainThread]: 
[0m23:43:33.757375 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:43:33.762382 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:43:33.836930 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:43:33.837940 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:43:33.837940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:33.917971 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m23:43:33.917971 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:43:33.919103 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:43:33.933110 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m23:43:33.935102 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:43:33.936108 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:43:33.936108 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:43:33.938119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4962e79c-c005-4b29-bbcf-376ec3f33cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B560821030>]}
[0m23:43:33.943748 [debug] [Thread-1 (]: Began running node seed.project_tesla.tesla_results
[0m23:43:33.944757 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.project_tesla.tesla_results'
[0m23:43:33.944757 [debug] [Thread-1 (]: Began compiling node seed.project_tesla.tesla_results
[0m23:43:33.950746 [debug] [Thread-1 (]: Began executing node seed.project_tesla.tesla_results
[0m23:43:33.951746 [debug] [Thread-1 (]: Finished running node seed.project_tesla.tesla_results
[0m23:43:33.952766 [debug] [Thread-3 (]: Began running node model.project_tesla.stg_tesla_vehicles
[0m23:43:33.953746 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.project_tesla.stg_tesla_vehicles'
[0m23:43:33.953746 [debug] [Thread-3 (]: Began compiling node model.project_tesla.stg_tesla_vehicles
[0m23:43:33.956747 [debug] [Thread-3 (]: Writing injected SQL for node "model.project_tesla.stg_tesla_vehicles"
[0m23:43:33.957747 [debug] [Thread-3 (]: Began executing node model.project_tesla.stg_tesla_vehicles
[0m23:43:33.958748 [debug] [Thread-3 (]: Finished running node model.project_tesla.stg_tesla_vehicles
[0m23:43:33.959747 [debug] [Thread-2 (]: Began running node analysis.project_tesla.top_value_vehicles
[0m23:43:33.960746 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_analysis
[0m23:43:33.960746 [debug] [Thread-2 (]: Acquiring new duckdb connection 'analysis.project_tesla.top_value_vehicles'
[0m23:43:33.961746 [debug] [Thread-4 (]: Began running node model.project_tesla.tesla_condition_analysis
[0m23:43:33.961746 [debug] [Thread-3 (]: Began running node model.project_tesla.tesla_ownership_analysis
[0m23:43:33.961746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.project_tesla.tesla_results, now model.project_tesla.tesla_analysis)
[0m23:43:33.962802 [debug] [Thread-2 (]: Began compiling node analysis.project_tesla.top_value_vehicles
[0m23:43:33.963821 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_condition_analysis'
[0m23:43:33.963821 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.project_tesla.stg_tesla_vehicles, now model.project_tesla.tesla_ownership_analysis)
[0m23:43:33.964812 [debug] [Thread-1 (]: Began compiling node model.project_tesla.tesla_analysis
[0m23:43:33.966814 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.project_tesla.top_value_vehicles"
[0m23:43:33.967828 [debug] [Thread-4 (]: Began compiling node model.project_tesla.tesla_condition_analysis
[0m23:43:33.967828 [debug] [Thread-3 (]: Began compiling node model.project_tesla.tesla_ownership_analysis
[0m23:43:33.970745 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.tesla_analysis"
[0m23:43:33.974752 [debug] [Thread-4 (]: Writing injected SQL for node "model.project_tesla.tesla_condition_analysis"
[0m23:43:33.979753 [debug] [Thread-3 (]: Writing injected SQL for node "model.project_tesla.tesla_ownership_analysis"
[0m23:43:33.980753 [debug] [Thread-2 (]: Began executing node analysis.project_tesla.top_value_vehicles
[0m23:43:33.980753 [debug] [Thread-1 (]: Began executing node model.project_tesla.tesla_analysis
[0m23:43:33.981749 [debug] [Thread-4 (]: Began executing node model.project_tesla.tesla_condition_analysis
[0m23:43:33.982746 [debug] [Thread-2 (]: Finished running node analysis.project_tesla.top_value_vehicles
[0m23:43:33.982746 [debug] [Thread-3 (]: Began executing node model.project_tesla.tesla_ownership_analysis
[0m23:43:33.983753 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_analysis
[0m23:43:33.984753 [debug] [Thread-4 (]: Finished running node model.project_tesla.tesla_condition_analysis
[0m23:43:33.984753 [debug] [Thread-2 (]: Began running node model.project_tesla.tesla_price_trends
[0m23:43:33.985749 [debug] [Thread-3 (]: Finished running node model.project_tesla.tesla_ownership_analysis
[0m23:43:33.986746 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_vehicles_incremental
[0m23:43:33.986746 [debug] [Thread-4 (]: Began running node snapshot.project_tesla.tesla_price_history
[0m23:43:33.987744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.project_tesla.top_value_vehicles, now model.project_tesla.tesla_price_trends)
[0m23:43:33.987744 [debug] [Thread-3 (]: Began running node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:43:33.988746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_tesla.tesla_analysis, now model.project_tesla.tesla_vehicles_incremental)
[0m23:43:33.988746 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.project_tesla.tesla_condition_analysis, now snapshot.project_tesla.tesla_price_history)
[0m23:43:33.989756 [debug] [Thread-2 (]: Began compiling node model.project_tesla.tesla_price_trends
[0m23:43:33.989756 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.project_tesla.tesla_ownership_analysis, now test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f)
[0m23:43:33.990744 [debug] [Thread-1 (]: Began compiling node model.project_tesla.tesla_vehicles_incremental
[0m23:43:33.990744 [debug] [Thread-4 (]: Began compiling node snapshot.project_tesla.tesla_price_history
[0m23:43:33.994753 [debug] [Thread-2 (]: Writing injected SQL for node "model.project_tesla.tesla_price_trends"
[0m23:43:33.994753 [debug] [Thread-3 (]: Began compiling node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:43:34.001745 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.tesla_vehicles_incremental"
[0m23:43:34.004751 [debug] [Thread-4 (]: Began executing node snapshot.project_tesla.tesla_price_history
[0m23:43:34.015756 [debug] [Thread-3 (]: Writing injected SQL for node "test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f"
[0m23:43:34.016262 [debug] [Thread-2 (]: Began executing node model.project_tesla.tesla_price_trends
[0m23:43:34.017267 [debug] [Thread-4 (]: Finished running node snapshot.project_tesla.tesla_price_history
[0m23:43:34.017267 [debug] [Thread-1 (]: Began executing node model.project_tesla.tesla_vehicles_incremental
[0m23:43:34.018267 [debug] [Thread-2 (]: Finished running node model.project_tesla.tesla_price_trends
[0m23:43:34.019316 [debug] [Thread-4 (]: Began running node test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3
[0m23:43:34.019316 [debug] [Thread-3 (]: Began executing node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:43:34.020315 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_vehicles_incremental
[0m23:43:34.021315 [debug] [Thread-2 (]: Began running node test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60
[0m23:43:34.022315 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.project_tesla.tesla_price_history, now test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3)
[0m23:43:34.022315 [debug] [Thread-3 (]: Finished running node test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f
[0m23:43:34.023326 [debug] [Thread-1 (]: Began running node test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707
[0m23:43:34.023326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.project_tesla.tesla_price_trends, now test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60)
[0m23:43:34.024316 [debug] [Thread-4 (]: Began compiling node test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3
[0m23:43:34.025315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_tesla.tesla_vehicles_incremental, now test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707)
[0m23:43:34.025315 [debug] [Thread-2 (]: Began compiling node test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60
[0m23:43:34.029325 [debug] [Thread-4 (]: Writing injected SQL for node "test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3"
[0m23:43:34.030324 [debug] [Thread-1 (]: Began compiling node test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707
[0m23:43:34.033323 [debug] [Thread-2 (]: Writing injected SQL for node "test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60"
[0m23:43:34.038326 [debug] [Thread-1 (]: Writing injected SQL for node "test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707"
[0m23:43:34.038326 [debug] [Thread-4 (]: Began executing node test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3
[0m23:43:34.039316 [debug] [Thread-2 (]: Began executing node test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60
[0m23:43:34.040324 [debug] [Thread-4 (]: Finished running node test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3
[0m23:43:34.041327 [debug] [Thread-2 (]: Finished running node test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60
[0m23:43:34.041327 [debug] [Thread-1 (]: Began executing node test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707
[0m23:43:34.043326 [debug] [Thread-1 (]: Finished running node test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707
[0m23:43:34.044316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:34.044316 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:43:34.044316 [debug] [MainThread]: Connection 'test.project_tesla.positive_value_stg_tesla_vehicles_year.eb791c8707' was properly closed.
[0m23:43:34.045316 [debug] [MainThread]: Connection 'test.project_tesla.not_null_stg_tesla_vehicles_vin.2a627cbe0f' was properly closed.
[0m23:43:34.045316 [debug] [MainThread]: Connection 'test.project_tesla.positive_value_stg_tesla_vehicles_price.9589634e60' was properly closed.
[0m23:43:34.045316 [debug] [MainThread]: Connection 'test.project_tesla.positive_value_stg_tesla_vehicles_odometer.feabecaaf3' was properly closed.
[0m23:43:34.048328 [debug] [MainThread]: Command end result
[0m23:43:34.204773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:43:34.206775 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:43:34.215773 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:43:34.219308 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m23:43:34.219308 [info ] [MainThread]: Building catalog
[0m23:43:34.231315 [debug] [ThreadPool]: Acquiring new duckdb connection 'tesla.information_schema'
[0m23:43:34.239308 [debug] [ThreadPool]: Using duckdb connection "tesla.information_schema"
[0m23:43:34.240307 [debug] [ThreadPool]: On tesla.information_schema: BEGIN
[0m23:43:34.240307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:34.241316 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:43:34.241316 [debug] [ThreadPool]: Using duckdb connection "tesla.information_schema"
[0m23:43:34.242313 [debug] [ThreadPool]: On tesla.information_schema: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "tesla.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'tesla'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'tesla'
    )
    select
        'tesla' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m23:43:34.247306 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m23:43:34.252307 [debug] [ThreadPool]: On tesla.information_schema: ROLLBACK
[0m23:43:34.252307 [debug] [ThreadPool]: Failed to rollback 'tesla.information_schema'
[0m23:43:34.253324 [debug] [ThreadPool]: On tesla.information_schema: Close
[0m23:43:34.267313 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\catalog.json
[0m23:43:34.292313 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:43:34.295317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:43:34.296313 [info ] [MainThread]: Catalog written to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\catalog.json
[0m23:43:34.298314 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:43:34.298314 after 1.72 seconds
[0m23:43:34.298314 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:43:34.299316 [debug] [MainThread]: Connection 'tesla.information_schema' was properly closed.
[0m23:43:34.299316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B55F343220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B55DEC4D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B561C92C20>]}
[0m23:43:34.300313 [debug] [MainThread]: Flushing usage events
[0m23:43:34.713882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:46.164808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB4333250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB56F0D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB56F0B80>]}


============================== 23:45:46.168808 | 6fea1d5e-0c23-4846-bd80-167da629c70a ==============================
[0m23:45:46.168808 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:45:46.168808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select marts.tesla_condition_analysis', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:46.530109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fea1d5e-0c23-4846-bd80-167da629c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB549BD90>]}
[0m23:45:46.610643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fea1d5e-0c23-4846-bd80-167da629c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB56F27A0>]}
[0m23:45:46.613641 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:45:46.843308 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:45:47.103346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:45:47.104340 [debug] [MainThread]: Partial parsing: added file: project_tesla://analyses\dashboard_queries.sql
[0m23:45:47.419010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fea1d5e-0c23-4846-bd80-167da629c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB57B5960>]}
[0m23:45:47.546159 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:45:47.548370 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:45:47.572970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fea1d5e-0c23-4846-bd80-167da629c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB6D82D70>]}
[0m23:45:47.573489 [info ] [MainThread]: Found 6 models, 1 seed, 2 analyses, 1 snapshot, 4 data tests, 1 source, 432 macros
[0m23:45:47.574005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fea1d5e-0c23-4846-bd80-167da629c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB6D827D0>]}
[0m23:45:47.575698 [info ] [MainThread]: 
[0m23:45:47.576201 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:47.576734 [info ] [MainThread]: 
[0m23:45:47.577264 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:45:47.578879 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla'
[0m23:45:47.650545 [debug] [ThreadPool]: Using duckdb connection "list_tesla"
[0m23:45:47.651545 [debug] [ThreadPool]: On list_tesla: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla"'
    
  
  
[0m23:45:47.651545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:47.729550 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m23:45:47.731551 [debug] [ThreadPool]: On list_tesla: Close
[0m23:45:47.732550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla, now create_tesla_main)
[0m23:45:47.732550 [debug] [ThreadPool]: Creating schema "database: "tesla"
schema: "main"
"
[0m23:45:47.740692 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:45:47.741694 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla'
        and type='sqlite'
    
  
[0m23:45:47.741694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:47.742777 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:45:47.744783 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:45:47.744783 [debug] [ThreadPool]: On create_tesla_main: BEGIN
[0m23:45:47.745738 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:45:47.746710 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:45:47.746710 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
    
        create schema if not exists "tesla"."main"
    
[0m23:45:47.747698 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:45:47.748688 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:45:47.748688 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:45:47.749687 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:45:47.750688 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:45:47.750688 [debug] [ThreadPool]: On create_tesla_main: Close
[0m23:45:47.757420 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:45:47.763932 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:45:47.764482 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:45:47.765040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:47.765573 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:45:47.766213 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:45:47.766787 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:45:47.782442 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m23:45:47.784106 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:45:47.784667 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:45:47.785223 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:45:47.787435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fea1d5e-0c23-4846-bd80-167da629c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB6D18250>]}
[0m23:45:47.788070 [debug] [MainThread]: Using duckdb connection "master"
[0m23:45:47.788575 [debug] [MainThread]: On master: BEGIN
[0m23:45:47.789097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:47.789678 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:45:47.790180 [debug] [MainThread]: On master: COMMIT
[0m23:45:47.790180 [debug] [MainThread]: Using duckdb connection "master"
[0m23:45:47.790714 [debug] [MainThread]: On master: COMMIT
[0m23:45:47.791247 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:45:47.791762 [debug] [MainThread]: On master: Close
[0m23:45:47.796064 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_condition_analysis
[0m23:45:47.796592 [info ] [Thread-1 (]: 1 of 1 START sql table model main.tesla_condition_analysis ..................... [RUN]
[0m23:45:47.797701 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_condition_analysis'
[0m23:45:47.798234 [debug] [Thread-1 (]: Began compiling node model.project_tesla.tesla_condition_analysis
[0m23:45:47.804994 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.tesla_condition_analysis"
[0m23:45:47.806508 [debug] [Thread-1 (]: Began executing node model.project_tesla.tesla_condition_analysis
[0m23:45:47.832997 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_tesla.tesla_condition_analysis"
[0m23:45:47.834098 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:45:47.834644 [debug] [Thread-1 (]: On model.project_tesla.tesla_condition_analysis: BEGIN
[0m23:45:47.835253 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:45:47.835758 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:45:47.836279 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:45:47.836802 [debug] [Thread-1 (]: On model.project_tesla.tesla_condition_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_condition_analysis"} */

  
    
    

    create  table
      "tesla"."main"."tesla_condition_analysis__dbt_tmp"
  
    as (
      

-- Step 1: Get base vehicle data
with stg_tesla as (
    select * from "tesla"."main"."stg_tesla_vehicles"
),

-- Step 2: Categorize vehicles by age
vehicle_age_categories as (
    select 
        *,
        extract(year from current_date) - year as vehicle_age,
        case
            when extract(year from current_date) - year <= 1 then 'New (0-1 years)'
            when extract(year from current_date) - year <= 3 then 'Recent (1-3 years)'
            when extract(year from current_date) - year <= 5 then 'Mid-age (3-5 years)'
            else 'Older (5+ years)'
        end as age_category
    from stg_tesla
),

-- Step 3: Calculate accident statistics by age category
accident_by_age as (
    select
        age_category,
        count(*) as total_vehicles,
        sum(case when had_accident then 1 else 0 end) as accident_count,
        round(sum(case when had_accident then 1 else 0 end) * 100.0 / count(*), 2) as accident_percentage
    from vehicle_age_categories
    group by age_category
),

-- Step 4: Calculate accident statistics by model
accident_by_model as (
    select
        model,
        count(*) as total_vehicles,
        sum(case when had_accident then 1 else 0 end) as accident_count,
        round(sum(case when had_accident then 1 else 0 end) * 100.0 / count(*), 2) as accident_percentage
    from stg_tesla
    group by model
),

-- Step 5: Calculate mileage statistics by model and year
mileage_stats as (
    select
        model,
        year,
        count(*) as total_vehicles,
        round(avg(odometer), 2) as avg_mileage,
        min(odometer) as min_mileage,
        max(odometer) as max_mileage,
        round(stddev(odometer), 2) as mileage_stddev
    from stg_tesla
    where odometer is not null
    group by model, year
)

-- Combine all the analyses into a single result
select 
    'Accident Stats by Age' as analysis_type,
    age_category as dimension,
    total_vehicles,
    accident_count,
    accident_percentage,
    null as avg_mileage,
    null as model,
    null as year
from accident_by_age

union all

select 
    'Accident Stats by Model' as analysis_type,
    model as dimension,
    total_vehicles,
    accident_count,
    accident_percentage,
    null as avg_mileage,
    model,
    null as year
from accident_by_model

union all

select 
    'Mileage Stats by Model/Year' as analysis_type,
    model || ' (' || year || ')' as dimension,
    total_vehicles,
    null as accident_count,
    null as accident_percentage,
    avg_mileage,
    model,
    year
from mileage_stats
    );
  
  
[0m23:45:47.873392 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m23:45:47.883395 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:45:47.883395 [debug] [Thread-1 (]: On model.project_tesla.tesla_condition_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_condition_analysis"} */
alter table "tesla"."main"."tesla_condition_analysis" rename to "tesla_condition_analysis__dbt_backup"
[0m23:45:47.884395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:45:47.887394 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:45:47.888411 [debug] [Thread-1 (]: On model.project_tesla.tesla_condition_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_condition_analysis"} */
alter table "tesla"."main"."tesla_condition_analysis__dbt_tmp" rename to "tesla_condition_analysis"
[0m23:45:47.889396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:45:47.901448 [debug] [Thread-1 (]: On model.project_tesla.tesla_condition_analysis: COMMIT
[0m23:45:47.902484 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:45:47.902484 [debug] [Thread-1 (]: On model.project_tesla.tesla_condition_analysis: COMMIT
[0m23:45:47.909402 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:45:47.913381 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:45:47.914389 [debug] [Thread-1 (]: On model.project_tesla.tesla_condition_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_condition_analysis"} */
drop table if exists "tesla"."main"."tesla_condition_analysis__dbt_backup" cascade
[0m23:45:47.918406 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:45:47.920405 [debug] [Thread-1 (]: On model.project_tesla.tesla_condition_analysis: Close
[0m23:45:47.923418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fea1d5e-0c23-4846-bd80-167da629c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB17B18D0>]}
[0m23:45:47.924410 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.tesla_condition_analysis ................ [[32mOK[0m in 0.12s]
[0m23:45:47.925398 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_condition_analysis
[0m23:45:47.926399 [debug] [MainThread]: Using duckdb connection "master"
[0m23:45:47.927410 [debug] [MainThread]: On master: BEGIN
[0m23:45:47.927410 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:47.928398 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:45:47.929397 [debug] [MainThread]: On master: COMMIT
[0m23:45:47.929397 [debug] [MainThread]: Using duckdb connection "master"
[0m23:45:47.929397 [debug] [MainThread]: On master: COMMIT
[0m23:45:47.930397 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:45:47.930397 [debug] [MainThread]: On master: Close
[0m23:45:47.931406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:47.931406 [debug] [MainThread]: Connection 'create_tesla_main' was properly closed.
[0m23:45:47.931406 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:45:47.932413 [debug] [MainThread]: Connection 'model.project_tesla.tesla_condition_analysis' was properly closed.
[0m23:45:47.932413 [info ] [MainThread]: 
[0m23:45:47.932413 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m23:45:47.933586 [debug] [MainThread]: Command end result
[0m23:45:47.957597 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:45:47.960596 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:45:47.967595 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:45:47.967595 [info ] [MainThread]: 
[0m23:45:47.968632 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:47.969598 [info ] [MainThread]: 
[0m23:45:47.970444 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:45:47.972451 [debug] [MainThread]: Command `dbt run` succeeded at 23:45:47.972451 after 1.90 seconds
[0m23:45:47.972451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB4333250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB549BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB56F27A0>]}
[0m23:45:47.973451 [debug] [MainThread]: Flushing usage events
[0m23:45:48.350029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:57.982417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DFEF33280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D80308D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D80308B20>]}


============================== 23:45:57.986418 | 0e6d736b-4497-4df6-aea6-3fcf15ea528f ==============================
[0m23:45:57.986418 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:45:57.987417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select marts.*', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:58.317522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e6d736b-4497-4df6-aea6-3fcf15ea528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D80233A60>]}
[0m23:45:58.408211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e6d736b-4497-4df6-aea6-3fcf15ea528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D80437700>]}
[0m23:45:58.411659 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:45:58.635679 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:45:58.869551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:58.869551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:59.009103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e6d736b-4497-4df6-aea6-3fcf15ea528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D80308EB0>]}
[0m23:45:59.136499 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:45:59.139492 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:45:59.164005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e6d736b-4497-4df6-aea6-3fcf15ea528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D8199C400>]}
[0m23:45:59.164005 [info ] [MainThread]: Found 6 models, 1 seed, 2 analyses, 1 snapshot, 4 data tests, 1 source, 432 macros
[0m23:45:59.165007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e6d736b-4497-4df6-aea6-3fcf15ea528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D8199D990>]}
[0m23:45:59.167006 [info ] [MainThread]: 
[0m23:45:59.167006 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:59.168005 [info ] [MainThread]: 
[0m23:45:59.169006 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:45:59.174006 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla'
[0m23:45:59.250482 [debug] [ThreadPool]: Using duckdb connection "list_tesla"
[0m23:45:59.250482 [debug] [ThreadPool]: On list_tesla: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla"'
    
  
  
[0m23:45:59.251481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:59.349733 [debug] [ThreadPool]: SQL status: OK in 0.098 seconds
[0m23:45:59.351746 [debug] [ThreadPool]: On list_tesla: Close
[0m23:45:59.352735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla, now create_tesla_main)
[0m23:45:59.352735 [debug] [ThreadPool]: Creating schema "database: "tesla"
schema: "main"
"
[0m23:45:59.360736 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:45:59.360736 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla'
        and type='sqlite'
    
  
[0m23:45:59.361741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:59.362744 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:45:59.363734 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:45:59.364741 [debug] [ThreadPool]: On create_tesla_main: BEGIN
[0m23:45:59.364741 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:45:59.365743 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:45:59.365743 [debug] [ThreadPool]: On create_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_main"} */

    
    
        create schema if not exists "tesla"."main"
    
[0m23:45:59.366743 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:45:59.367742 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:45:59.367742 [debug] [ThreadPool]: Using duckdb connection "create_tesla_main"
[0m23:45:59.367742 [debug] [ThreadPool]: On create_tesla_main: COMMIT
[0m23:45:59.368746 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:45:59.368746 [debug] [ThreadPool]: On create_tesla_main: Close
[0m23:45:59.370735 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:45:59.376741 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:45:59.377742 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:45:59.377742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:59.378739 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:45:59.378739 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:45:59.378739 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:45:59.392742 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m23:45:59.393741 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:45:59.394734 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:45:59.394734 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:45:59.396736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e6d736b-4497-4df6-aea6-3fcf15ea528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DFF9D1990>]}
[0m23:45:59.396736 [debug] [MainThread]: Using duckdb connection "master"
[0m23:45:59.397735 [debug] [MainThread]: On master: BEGIN
[0m23:45:59.397735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:59.398734 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:45:59.398734 [debug] [MainThread]: On master: COMMIT
[0m23:45:59.399734 [debug] [MainThread]: Using duckdb connection "master"
[0m23:45:59.399734 [debug] [MainThread]: On master: COMMIT
[0m23:45:59.400734 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:45:59.400734 [debug] [MainThread]: On master: Close
[0m23:45:59.404734 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_analysis
[0m23:45:59.405736 [debug] [Thread-2 (]: Began running node model.project_tesla.tesla_condition_analysis
[0m23:45:59.405736 [debug] [Thread-3 (]: Began running node model.project_tesla.tesla_ownership_analysis
[0m23:45:59.406736 [debug] [Thread-4 (]: Began running node model.project_tesla.tesla_price_trends
[0m23:45:59.406736 [info ] [Thread-1 (]: 1 of 5 START sql table model main.tesla_analysis ............................... [RUN]
[0m23:45:59.407747 [info ] [Thread-2 (]: 2 of 5 START sql table model main.tesla_condition_analysis ..................... [RUN]
[0m23:45:59.408733 [info ] [Thread-3 (]: 3 of 5 START sql table model main.tesla_ownership_analysis ..................... [RUN]
[0m23:45:59.408733 [info ] [Thread-4 (]: 4 of 5 START sql table model main.tesla_price_trends ........................... [RUN]
[0m23:45:59.409734 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_analysis'
[0m23:45:59.410745 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_condition_analysis'
[0m23:45:59.410745 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_ownership_analysis'
[0m23:45:59.411735 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_price_trends'
[0m23:45:59.411735 [debug] [Thread-1 (]: Began compiling node model.project_tesla.tesla_analysis
[0m23:45:59.412745 [debug] [Thread-2 (]: Began compiling node model.project_tesla.tesla_condition_analysis
[0m23:45:59.412745 [debug] [Thread-3 (]: Began compiling node model.project_tesla.tesla_ownership_analysis
[0m23:45:59.413735 [debug] [Thread-4 (]: Began compiling node model.project_tesla.tesla_price_trends
[0m23:45:59.420742 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.tesla_analysis"
[0m23:45:59.424747 [debug] [Thread-2 (]: Writing injected SQL for node "model.project_tesla.tesla_condition_analysis"
[0m23:45:59.430739 [debug] [Thread-3 (]: Writing injected SQL for node "model.project_tesla.tesla_ownership_analysis"
[0m23:45:59.433747 [debug] [Thread-4 (]: Writing injected SQL for node "model.project_tesla.tesla_price_trends"
[0m23:45:59.434746 [debug] [Thread-1 (]: Began executing node model.project_tesla.tesla_analysis
[0m23:45:59.435739 [debug] [Thread-2 (]: Began executing node model.project_tesla.tesla_condition_analysis
[0m23:45:59.435739 [debug] [Thread-3 (]: Began executing node model.project_tesla.tesla_ownership_analysis
[0m23:45:59.464279 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_tesla.tesla_analysis"
[0m23:45:59.467279 [debug] [Thread-2 (]: Writing runtime sql for node "model.project_tesla.tesla_condition_analysis"
[0m23:45:59.468279 [debug] [Thread-4 (]: Began executing node model.project_tesla.tesla_price_trends
[0m23:45:59.471272 [debug] [Thread-3 (]: Writing runtime sql for node "model.project_tesla.tesla_ownership_analysis"
[0m23:45:59.477285 [debug] [Thread-4 (]: Writing runtime sql for node "model.project_tesla.tesla_price_trends"
[0m23:45:59.478271 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:45:59.478271 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:45:59.479273 [debug] [Thread-1 (]: On model.project_tesla.tesla_analysis: BEGIN
[0m23:45:59.480271 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_ownership_analysis"
[0m23:45:59.480271 [debug] [Thread-2 (]: On model.project_tesla.tesla_condition_analysis: BEGIN
[0m23:45:59.481289 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:45:59.481289 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_price_trends"
[0m23:45:59.482286 [debug] [Thread-3 (]: On model.project_tesla.tesla_ownership_analysis: BEGIN
[0m23:45:59.482286 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:45:59.483273 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:45:59.484276 [debug] [Thread-4 (]: On model.project_tesla.tesla_price_trends: BEGIN
[0m23:45:59.484276 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:45:59.485285 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m23:45:59.485285 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:45:59.486282 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:45:59.486282 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m23:45:59.487284 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:45:59.488272 [debug] [Thread-1 (]: On model.project_tesla.tesla_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_analysis"} */

  
    
    

    create  table
      "tesla"."main"."tesla_analysis__dbt_tmp"
  
    as (
      

with stg_tesla as (
    select * from "tesla"."main"."stg_tesla_vehicles"
),

country_stats as (
    select
        country,
        count(*) as total_vehicles,
        round(avg(price), 2) as avg_price,
        round(avg(odometer), 2) as avg_odometer,
        count(case when had_accident then 1 end) as vehicles_with_accidents,
        round(count(case when had_accident then 1 end) * 100.0 / count(*), 2) as accident_percentage
    from stg_tesla
    group by country
),

model_analysis as (
    select
        model,
        trim_name,
        count(*) as total_count,
        round(avg(price), 2) as avg_price,
        min(price) as min_price,
        max(price) as max_price,
        round(avg(odometer), 2) as avg_odometer
    from stg_tesla
    group by model, trim_name
)

select 
    'country_stats' as analysis_type,
    country as dimension,
    total_vehicles as count,
    avg_price,
    null as min_price,
    null as max_price,
    avg_odometer,
    vehicles_with_accidents,
    accident_percentage,
    null as trim_name
from country_stats

union all

select
    'model_analysis' as analysis_type,
    model as dimension,
    total_count as count,
    avg_price,
    min_price,
    max_price,
    avg_odometer,
    null as vehicles_with_accidents,
    null as accident_percentage,
    trim_name
from model_analysis
    );
  
  
[0m23:45:59.488272 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m23:45:59.489275 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_ownership_analysis"
[0m23:45:59.489275 [debug] [Thread-2 (]: On model.project_tesla.tesla_condition_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_condition_analysis"} */

  
    
    

    create  table
      "tesla"."main"."tesla_condition_analysis__dbt_tmp"
  
    as (
      

-- Step 1: Get base vehicle data
with stg_tesla as (
    select * from "tesla"."main"."stg_tesla_vehicles"
),

-- Step 2: Categorize vehicles by age
vehicle_age_categories as (
    select 
        *,
        extract(year from current_date) - year as vehicle_age,
        case
            when extract(year from current_date) - year <= 1 then 'New (0-1 years)'
            when extract(year from current_date) - year <= 3 then 'Recent (1-3 years)'
            when extract(year from current_date) - year <= 5 then 'Mid-age (3-5 years)'
            else 'Older (5+ years)'
        end as age_category
    from stg_tesla
),

-- Step 3: Calculate accident statistics by age category
accident_by_age as (
    select
        age_category,
        count(*) as total_vehicles,
        sum(case when had_accident then 1 else 0 end) as accident_count,
        round(sum(case when had_accident then 1 else 0 end) * 100.0 / count(*), 2) as accident_percentage
    from vehicle_age_categories
    group by age_category
),

-- Step 4: Calculate accident statistics by model
accident_by_model as (
    select
        model,
        count(*) as total_vehicles,
        sum(case when had_accident then 1 else 0 end) as accident_count,
        round(sum(case when had_accident then 1 else 0 end) * 100.0 / count(*), 2) as accident_percentage
    from stg_tesla
    group by model
),

-- Step 5: Calculate mileage statistics by model and year
mileage_stats as (
    select
        model,
        year,
        count(*) as total_vehicles,
        round(avg(odometer), 2) as avg_mileage,
        min(odometer) as min_mileage,
        max(odometer) as max_mileage,
        round(stddev(odometer), 2) as mileage_stddev
    from stg_tesla
    where odometer is not null
    group by model, year
)

-- Combine all the analyses into a single result
select 
    'Accident Stats by Age' as analysis_type,
    age_category as dimension,
    total_vehicles,
    accident_count,
    accident_percentage,
    null as avg_mileage,
    null as model,
    null as year
from accident_by_age

union all

select 
    'Accident Stats by Model' as analysis_type,
    model as dimension,
    total_vehicles,
    accident_count,
    accident_percentage,
    null as avg_mileage,
    model,
    null as year
from accident_by_model

union all

select 
    'Mileage Stats by Model/Year' as analysis_type,
    model || ' (' || year || ')' as dimension,
    total_vehicles,
    null as accident_count,
    null as accident_percentage,
    avg_mileage,
    model,
    year
from mileage_stats
    );
  
  
[0m23:45:59.490274 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_price_trends"
[0m23:45:59.491274 [debug] [Thread-3 (]: On model.project_tesla.tesla_ownership_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_ownership_analysis"} */

  
    
    

    create  table
      "tesla"."main"."tesla_ownership_analysis__dbt_tmp"
  
    as (
      

with stg_tesla as (
    select * from "tesla"."main"."stg_tesla_vehicles"
),

enhanced_data as (
    select
        
    case
        when vin is null then null
        when length(vin) < 10 then null
        else upper(regexp_replace(vin, '[^A-Za-z0-9]', ''))
    end
 as clean_vin,
        model,
        trim_name,
        year,
        price,
        
    case
        when price is null then 'Unknown'
        when price < 20000 then 'Budget (< 20K)'
        when price < 30000 then 'Value (20K-30K)'
        when price < 40000 then 'Mid-Range (30K-40K)'
        when price < 50000 then 'Premium (40K-50K)'
        else 'Luxury (50K+)'
    end
 as price_category,
        odometer,
        country,
        delivery_date,
        record_time_str,
        case 
            when delivery_date is not null and try_cast(record_time_str as timestamp) is not null then
                
    ((extract(year from try_cast(record_time_str as timestamp)) - extract(year from delivery_date)) + 
     (extract(month from try_cast(record_time_str as timestamp)) - extract(month from delivery_date)) / 12.0 + 
     (extract(day from try_cast(record_time_str as timestamp)) - extract(day from delivery_date)) / 365.0)

            else null
        end as ownership_years,
        had_accident
    from stg_tesla
),

ownership_analysis as (
    select
        price_category,
        count(*) as vehicle_count,
        round(avg(price), 2) as avg_price,
        round(avg(ownership_years), 2) as avg_ownership_years,
        round(avg(odometer), 2) as avg_odometer,
        round(avg(case when had_accident then 1.0 else 0.0 end) * 100, 2) as accident_percentage
    from enhanced_data
    where ownership_years is not null
    group by price_category
)

select * from ownership_analysis
order by avg_price
    );
  
  
[0m23:45:59.492273 [debug] [Thread-4 (]: On model.project_tesla.tesla_price_trends: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_price_trends"} */

  
    
    

    create  table
      "tesla"."main"."tesla_price_trends__dbt_tmp"
  
    as (
      

with stg_tesla as (
    select * from "tesla"."main"."stg_tesla_vehicles"
    where price is not null
),

country_model_stats as (
    select
        country,
        model,
        trim_name,
        year,
        round(avg(price), 2) as avg_price,
        count(*) as vehicle_count,
        min(price) as min_price,
        max(price) as max_price,
        round(stddev(price), 2) as price_stddev
    from stg_tesla
    group by country, model, trim_name, year
),

price_ranks as (
    select
        *,
        row_number() over (partition by country, model order by avg_price desc) as price_rank,
        avg_price - lag(avg_price) over (partition by country, model order by year) as price_diff_from_prev_year,
        round(avg_price / avg(avg_price) over (partition by country, model) * 100, 2) as percent_of_avg_model_price
    from country_model_stats
)

select * from price_ranks
order by country, model, year desc
    );
  
  
[0m23:45:59.551793 [debug] [Thread-2 (]: SQL status: OK in 0.060 seconds
[0m23:45:59.567791 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:45:59.568791 [debug] [Thread-2 (]: On model.project_tesla.tesla_condition_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_condition_analysis"} */
alter table "tesla"."main"."tesla_condition_analysis" rename to "tesla_condition_analysis__dbt_backup"
[0m23:45:59.571796 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:45:59.579791 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:45:59.580791 [debug] [Thread-2 (]: On model.project_tesla.tesla_condition_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_condition_analysis"} */
alter table "tesla"."main"."tesla_condition_analysis__dbt_tmp" rename to "tesla_condition_analysis"
[0m23:45:59.582789 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:45:59.610797 [debug] [Thread-2 (]: On model.project_tesla.tesla_condition_analysis: COMMIT
[0m23:45:59.611789 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:45:59.612790 [debug] [Thread-2 (]: On model.project_tesla.tesla_condition_analysis: COMMIT
[0m23:45:59.622432 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m23:45:59.632438 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:45:59.633437 [debug] [Thread-2 (]: On model.project_tesla.tesla_condition_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_condition_analysis"} */
drop table if exists "tesla"."main"."tesla_condition_analysis__dbt_backup" cascade
[0m23:45:59.634437 [debug] [Thread-3 (]: SQL status: OK in 0.141 seconds
[0m23:45:59.639439 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_ownership_analysis"
[0m23:45:59.640445 [debug] [Thread-1 (]: SQL status: OK in 0.151 seconds
[0m23:45:59.641439 [debug] [Thread-3 (]: On model.project_tesla.tesla_ownership_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_ownership_analysis"} */
alter table "tesla"."main"."tesla_ownership_analysis" rename to "tesla_ownership_analysis__dbt_backup"
[0m23:45:59.644947 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:45:59.644947 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m23:45:59.645954 [debug] [Thread-1 (]: On model.project_tesla.tesla_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_analysis"} */
alter table "tesla"."main"."tesla_analysis" rename to "tesla_analysis__dbt_backup"
[0m23:45:59.646954 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:45:59.649955 [debug] [Thread-2 (]: On model.project_tesla.tesla_condition_analysis: Close
[0m23:45:59.652954 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_ownership_analysis"
[0m23:45:59.653958 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:45:59.656955 [debug] [Thread-3 (]: On model.project_tesla.tesla_ownership_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_ownership_analysis"} */
alter table "tesla"."main"."tesla_ownership_analysis__dbt_tmp" rename to "tesla_ownership_analysis"
[0m23:45:59.660955 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:45:59.661954 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6d736b-4497-4df6-aea6-3fcf15ea528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DFDDA6AA0>]}
[0m23:45:59.662956 [debug] [Thread-1 (]: On model.project_tesla.tesla_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_analysis"} */
alter table "tesla"."main"."tesla_analysis__dbt_tmp" rename to "tesla_analysis"
[0m23:45:59.663955 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:45:59.663955 [info ] [Thread-2 (]: 2 of 5 OK created sql table model main.tesla_condition_analysis ................ [[32mOK[0m in 0.24s]
[0m23:45:59.665957 [debug] [Thread-3 (]: On model.project_tesla.tesla_ownership_analysis: COMMIT
[0m23:45:59.666958 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:45:59.667955 [debug] [Thread-2 (]: Finished running node model.project_tesla.tesla_condition_analysis
[0m23:45:59.667955 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_ownership_analysis"
[0m23:45:59.669968 [debug] [Thread-1 (]: On model.project_tesla.tesla_analysis: COMMIT
[0m23:45:59.670954 [debug] [Thread-2 (]: Began running node model.project_tesla.tesla_vehicles_incremental
[0m23:45:59.670954 [debug] [Thread-3 (]: On model.project_tesla.tesla_ownership_analysis: COMMIT
[0m23:45:59.671965 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:45:59.673956 [debug] [Thread-1 (]: On model.project_tesla.tesla_analysis: COMMIT
[0m23:45:59.672958 [info ] [Thread-2 (]: 5 of 5 START sql incremental model main.tesla_vehicles_incremental ............. [RUN]
[0m23:45:59.674955 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.project_tesla.tesla_condition_analysis, now model.project_tesla.tesla_vehicles_incremental)
[0m23:45:59.674955 [debug] [Thread-2 (]: Began compiling node model.project_tesla.tesla_vehicles_incremental
[0m23:45:59.685953 [debug] [Thread-2 (]: Writing injected SQL for node "model.project_tesla.tesla_vehicles_incremental"
[0m23:45:59.685953 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m23:45:59.686954 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m23:45:59.691952 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_analysis"
[0m23:45:59.692953 [debug] [Thread-2 (]: Began executing node model.project_tesla.tesla_vehicles_incremental
[0m23:45:59.696953 [debug] [Thread-3 (]: Using duckdb connection "model.project_tesla.tesla_ownership_analysis"
[0m23:45:59.697952 [debug] [Thread-1 (]: On model.project_tesla.tesla_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_analysis"} */
drop table if exists "tesla"."main"."tesla_analysis__dbt_backup" cascade
[0m23:45:59.727960 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_vehicles_incremental"
[0m23:45:59.727960 [debug] [Thread-3 (]: On model.project_tesla.tesla_ownership_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_ownership_analysis"} */
drop table if exists "tesla"."main"."tesla_ownership_analysis__dbt_backup" cascade
[0m23:45:59.728953 [debug] [Thread-4 (]: SQL status: OK in 0.236 seconds
[0m23:45:59.729958 [debug] [Thread-2 (]: On model.project_tesla.tesla_vehicles_incremental: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_vehicles_incremental"} */

    
  
    
    

    create temporary table
      "tesla_vehicles_incremental__dbt_tmp20250621234559723963"
  
    as (
      

with source_data as (
    select * from "tesla"."main"."stg_tesla_vehicles"
    
    
        -- This filter will only be applied on an incremental run
        where record_time_str > (select max(record_time_str) from "tesla"."main"."tesla_vehicles_incremental")
    
)

select
    vin,
    model,
    trim_name,
    year,
    country,
    city,
    price,
    odometer,
    delivery_date,
    had_accident,
    refurbishment_status,
    color,
    record_time_str
from source_data
    );
  
  
  
[0m23:45:59.732965 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_price_trends"
[0m23:45:59.733958 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:45:59.733958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:45:59.734960 [debug] [Thread-4 (]: On model.project_tesla.tesla_price_trends: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_price_trends"} */
alter table "tesla"."main"."tesla_price_trends" rename to "tesla_price_trends__dbt_backup"
[0m23:45:59.735209 [debug] [Thread-1 (]: On model.project_tesla.tesla_analysis: Close
[0m23:45:59.737215 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m23:45:59.737215 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m23:45:59.738216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6d736b-4497-4df6-aea6-3fcf15ea528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D80412FB0>]}
[0m23:45:59.741220 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_price_trends"
[0m23:45:59.743226 [debug] [Thread-3 (]: On model.project_tesla.tesla_ownership_analysis: Close
[0m23:45:59.743226 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m23:45:59.744733 [debug] [Thread-4 (]: On model.project_tesla.tesla_price_trends: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_price_trends"} */
alter table "tesla"."main"."tesla_price_trends__dbt_tmp" rename to "tesla_price_trends"
[0m23:45:59.743226 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.tesla_analysis .......................... [[32mOK[0m in 0.33s]
[0m23:45:59.745737 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6d736b-4497-4df6-aea6-3fcf15ea528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D81C560B0>]}
[0m23:45:59.751745 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_vehicles_incremental"
[0m23:45:59.751745 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m23:45:59.752737 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_analysis
[0m23:45:59.753738 [debug] [Thread-2 (]: On model.project_tesla.tesla_vehicles_incremental: BEGIN
[0m23:45:59.753738 [info ] [Thread-3 (]: 3 of 5 OK created sql table model main.tesla_ownership_analysis ................ [[32mOK[0m in 0.33s]
[0m23:45:59.755741 [debug] [Thread-4 (]: On model.project_tesla.tesla_price_trends: COMMIT
[0m23:45:59.756738 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m23:45:59.756738 [debug] [Thread-3 (]: Finished running node model.project_tesla.tesla_ownership_analysis
[0m23:45:59.757754 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_price_trends"
[0m23:45:59.757754 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_vehicles_incremental"
[0m23:45:59.758739 [debug] [Thread-4 (]: On model.project_tesla.tesla_price_trends: COMMIT
[0m23:45:59.759736 [debug] [Thread-2 (]: On model.project_tesla.tesla_vehicles_incremental: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_vehicles_incremental"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'tesla_vehicles_incremental__dbt_tmp20250621234559723963'
      
      
      order by ordinal_position

  
[0m23:45:59.761750 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:45:59.765745 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_vehicles_incremental"
[0m23:45:59.766746 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m23:45:59.767211 [debug] [Thread-2 (]: On model.project_tesla.tesla_vehicles_incremental: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_vehicles_incremental"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'tesla_vehicles_incremental'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'tesla'
      
      order by ordinal_position

  
[0m23:45:59.768653 [debug] [Thread-4 (]: Using duckdb connection "model.project_tesla.tesla_price_trends"
[0m23:45:59.769652 [debug] [Thread-4 (]: On model.project_tesla.tesla_price_trends: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_price_trends"} */
drop table if exists "tesla"."main"."tesla_price_trends__dbt_backup" cascade
[0m23:45:59.771651 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:45:59.778659 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_vehicles_incremental"
[0m23:45:59.779655 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m23:45:59.779655 [debug] [Thread-2 (]: On model.project_tesla.tesla_vehicles_incremental: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_vehicles_incremental"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'tesla_vehicles_incremental'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'tesla'
      
      order by ordinal_position

  
[0m23:45:59.781653 [debug] [Thread-4 (]: On model.project_tesla.tesla_price_trends: Close
[0m23:45:59.782652 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6d736b-4497-4df6-aea6-3fcf15ea528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D81DE7F10>]}
[0m23:45:59.783651 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:45:59.782652 [info ] [Thread-4 (]: 4 of 5 OK created sql table model main.tesla_price_trends ...................... [[32mOK[0m in 0.37s]
[0m23:45:59.797659 [debug] [Thread-2 (]: Writing runtime sql for node "model.project_tesla.tesla_vehicles_incremental"
[0m23:45:59.798659 [debug] [Thread-4 (]: Finished running node model.project_tesla.tesla_price_trends
[0m23:45:59.799719 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_vehicles_incremental"
[0m23:45:59.800733 [debug] [Thread-2 (]: On model.project_tesla.tesla_vehicles_incremental: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_vehicles_incremental"} */

        
            delete from "tesla"."main"."tesla_vehicles_incremental"
            where (
                vin) in (
                select (vin)
                from "tesla_vehicles_incremental__dbt_tmp20250621234559723963"
            );

        
    

    insert into "tesla"."main"."tesla_vehicles_incremental" ("vin", "model", "trim_name", "year", "country", "city", "price", "odometer", "delivery_date", "had_accident", "refurbishment_status", "color", "record_time_str")
    (
        select "vin", "model", "trim_name", "year", "country", "city", "price", "odometer", "delivery_date", "had_accident", "refurbishment_status", "color", "record_time_str"
        from "tesla_vehicles_incremental__dbt_tmp20250621234559723963"
    )
  
[0m23:45:59.803815 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m23:45:59.805817 [debug] [Thread-2 (]: On model.project_tesla.tesla_vehicles_incremental: COMMIT
[0m23:45:59.805817 [debug] [Thread-2 (]: Using duckdb connection "model.project_tesla.tesla_vehicles_incremental"
[0m23:45:59.806816 [debug] [Thread-2 (]: On model.project_tesla.tesla_vehicles_incremental: COMMIT
[0m23:45:59.807815 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m23:45:59.808816 [debug] [Thread-2 (]: On model.project_tesla.tesla_vehicles_incremental: Close
[0m23:45:59.809816 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6d736b-4497-4df6-aea6-3fcf15ea528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D8EC61390>]}
[0m23:45:59.809816 [info ] [Thread-2 (]: 5 of 5 OK created sql incremental model main.tesla_vehicles_incremental ........ [[32mOK[0m in 0.13s]
[0m23:45:59.811435 [debug] [Thread-2 (]: Finished running node model.project_tesla.tesla_vehicles_incremental
[0m23:45:59.812441 [debug] [MainThread]: Using duckdb connection "master"
[0m23:45:59.812441 [debug] [MainThread]: On master: BEGIN
[0m23:45:59.813448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:59.813448 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:45:59.814448 [debug] [MainThread]: On master: COMMIT
[0m23:45:59.814448 [debug] [MainThread]: Using duckdb connection "master"
[0m23:45:59.814448 [debug] [MainThread]: On master: COMMIT
[0m23:45:59.815439 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:45:59.815439 [debug] [MainThread]: On master: Close
[0m23:45:59.816447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:59.816447 [debug] [MainThread]: Connection 'create_tesla_main' was properly closed.
[0m23:45:59.816447 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:45:59.817448 [debug] [MainThread]: Connection 'model.project_tesla.tesla_analysis' was properly closed.
[0m23:45:59.817448 [debug] [MainThread]: Connection 'model.project_tesla.tesla_vehicles_incremental' was properly closed.
[0m23:45:59.817448 [debug] [MainThread]: Connection 'model.project_tesla.tesla_ownership_analysis' was properly closed.
[0m23:45:59.818448 [debug] [MainThread]: Connection 'model.project_tesla.tesla_price_trends' was properly closed.
[0m23:45:59.818448 [info ] [MainThread]: 
[0m23:45:59.819440 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m23:45:59.820449 [debug] [MainThread]: Command end result
[0m23:45:59.843446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:45:59.845961 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:45:59.853958 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:45:59.854960 [info ] [MainThread]: 
[0m23:45:59.854960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:59.856959 [info ] [MainThread]: 
[0m23:45:59.856959 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m23:45:59.858968 [debug] [MainThread]: Command `dbt run` succeeded at 23:45:59.858968 after 1.97 seconds
[0m23:45:59.858968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DFEF33280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D80233A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DFD3ED360>]}
[0m23:45:59.859967 [debug] [MainThread]: Flushing usage events
[0m23:46:00.335116 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:46:14.694337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC6E171C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC81D0C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC81D0A90>]}


============================== 23:46:14.698345 | e1c7609c-17a8-4510-9a1c-2cb33cf8cd6e ==============================
[0m23:46:14.698345 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:46:14.699335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt compile --select marts.tesla_condition_analysis', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:46:15.020921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1c7609c-17a8-4510-9a1c-2cb33cf8cd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC42A3D90>]}
[0m23:46:15.093945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1c7609c-17a8-4510-9a1c-2cb33cf8cd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC78DDCF0>]}
[0m23:46:15.096413 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:46:15.323056 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:46:15.574005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:15.575024 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:15.714743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1c7609c-17a8-4510-9a1c-2cb33cf8cd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC788B160>]}
[0m23:46:15.847207 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:46:15.849208 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:46:15.872183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1c7609c-17a8-4510-9a1c-2cb33cf8cd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC9838FD0>]}
[0m23:46:15.873184 [info ] [MainThread]: Found 6 models, 1 seed, 2 analyses, 1 snapshot, 4 data tests, 1 source, 432 macros
[0m23:46:15.874183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1c7609c-17a8-4510-9a1c-2cb33cf8cd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC9880070>]}
[0m23:46:15.875184 [info ] [MainThread]: 
[0m23:46:15.876183 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:15.876183 [info ] [MainThread]: 
[0m23:46:15.877106 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:46:15.882622 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:46:15.954434 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:46:15.954434 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:46:15.955434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:16.040296 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m23:46:16.041296 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:46:16.041296 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:46:16.055296 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m23:46:16.057297 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:46:16.058296 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:46:16.058296 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:46:16.059307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1c7609c-17a8-4510-9a1c-2cb33cf8cd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC9838F40>]}
[0m23:46:16.063818 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_condition_analysis
[0m23:46:16.064818 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_condition_analysis'
[0m23:46:16.064818 [debug] [Thread-1 (]: Began compiling node model.project_tesla.tesla_condition_analysis
[0m23:46:16.071818 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.tesla_condition_analysis"
[0m23:46:16.072819 [debug] [Thread-1 (]: Began executing node model.project_tesla.tesla_condition_analysis
[0m23:46:16.073819 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_condition_analysis
[0m23:46:16.074819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:16.074819 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:46:16.075819 [debug] [MainThread]: Connection 'model.project_tesla.tesla_condition_analysis' was properly closed.
[0m23:46:16.075819 [debug] [MainThread]: Command end result
[0m23:46:16.099747 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:46:16.101932 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:46:16.108283 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:46:16.109284 [info ] [MainThread]: Compiled node 'tesla_condition_analysis' is:


-- Step 1: Get base vehicle data
with stg_tesla as (
    select * from "tesla"."main"."stg_tesla_vehicles"
),

-- Step 2: Categorize vehicles by age
vehicle_age_categories as (
    select 
        *,
        extract(year from current_date) - year as vehicle_age,
        case
            when extract(year from current_date) - year <= 1 then 'New (0-1 years)'
            when extract(year from current_date) - year <= 3 then 'Recent (1-3 years)'
            when extract(year from current_date) - year <= 5 then 'Mid-age (3-5 years)'
            else 'Older (5+ years)'
        end as age_category
    from stg_tesla
),

-- Step 3: Calculate accident statistics by age category
accident_by_age as (
    select
        age_category,
        count(*) as total_vehicles,
        sum(case when had_accident then 1 else 0 end) as accident_count,
        round(sum(case when had_accident then 1 else 0 end) * 100.0 / count(*), 2) as accident_percentage
    from vehicle_age_categories
    group by age_category
),

-- Step 4: Calculate accident statistics by model
accident_by_model as (
    select
        model,
        count(*) as total_vehicles,
        sum(case when had_accident then 1 else 0 end) as accident_count,
        round(sum(case when had_accident then 1 else 0 end) * 100.0 / count(*), 2) as accident_percentage
    from stg_tesla
    group by model
),

-- Step 5: Calculate mileage statistics by model and year
mileage_stats as (
    select
        model,
        year,
        count(*) as total_vehicles,
        round(avg(odometer), 2) as avg_mileage,
        min(odometer) as min_mileage,
        max(odometer) as max_mileage,
        round(stddev(odometer), 2) as mileage_stddev
    from stg_tesla
    where odometer is not null
    group by model, year
)

-- Combine all the analyses into a single result
select 
    'Accident Stats by Age' as analysis_type,
    age_category as dimension,
    total_vehicles,
    accident_count,
    accident_percentage,
    null as avg_mileage,
    null as model,
    null as year
from accident_by_age

union all

select 
    'Accident Stats by Model' as analysis_type,
    model as dimension,
    total_vehicles,
    accident_count,
    accident_percentage,
    null as avg_mileage,
    model,
    null as year
from accident_by_model

union all

select 
    'Mileage Stats by Model/Year' as analysis_type,
    model || ' (' || year || ')' as dimension,
    total_vehicles,
    null as accident_count,
    null as accident_percentage,
    avg_mileage,
    model,
    year
from mileage_stats
[0m23:46:16.112284 [debug] [MainThread]: Command `dbt compile` succeeded at 23:46:16.111283 after 1.52 seconds
[0m23:46:16.112284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC6E171C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC713D9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC98815A0>]}
[0m23:46:16.113285 [debug] [MainThread]: Flushing usage events
[0m23:46:16.510789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:46:49.559615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F8CC32B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FA080D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FA080B80>]}


============================== 23:46:49.564616 | a574be0a-05f3-4f1e-940e-d63f36600e51 ==============================
[0m23:46:49.564616 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:46:49.565621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt show --select marts.tesla_condition_analysis --limit 10', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:46:49.967661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a574be0a-05f3-4f1e-940e-d63f36600e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F9E28F10>]}
[0m23:46:50.059800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a574be0a-05f3-4f1e-940e-d63f36600e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FA105DE0>]}
[0m23:46:50.094311 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:46:50.367189 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:46:50.678165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:50.679167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:50.832222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a574be0a-05f3-4f1e-940e-d63f36600e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F9FE6470>]}
[0m23:46:50.983795 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:46:50.986787 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:46:50.992303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a574be0a-05f3-4f1e-940e-d63f36600e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FB7D8D60>]}
[0m23:46:50.993312 [info ] [MainThread]: Found 6 models, 1 seed, 2 analyses, 1 snapshot, 4 data tests, 1 source, 432 macros
[0m23:46:50.995317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a574be0a-05f3-4f1e-940e-d63f36600e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FB7D8D90>]}
[0m23:46:50.996314 [info ] [MainThread]: 
[0m23:46:50.997314 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:50.997314 [info ] [MainThread]: 
[0m23:46:50.998314 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:46:51.004314 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_main'
[0m23:46:51.090473 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:46:51.090473 [debug] [ThreadPool]: On list_tesla_main: BEGIN
[0m23:46:51.091473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:51.846148 [debug] [ThreadPool]: SQL status: OK in 0.754 seconds
[0m23:46:51.847149 [debug] [ThreadPool]: Using duckdb connection "list_tesla_main"
[0m23:46:51.847149 [debug] [ThreadPool]: On list_tesla_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_main"} */
select
      'tesla' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla'
  
[0m23:46:51.876148 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m23:46:51.879153 [debug] [ThreadPool]: On list_tesla_main: ROLLBACK
[0m23:46:51.880153 [debug] [ThreadPool]: Failed to rollback 'list_tesla_main'
[0m23:46:51.880153 [debug] [ThreadPool]: On list_tesla_main: Close
[0m23:46:51.882158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a574be0a-05f3-4f1e-940e-d63f36600e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FB7DA200>]}
[0m23:46:51.888153 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_condition_analysis
[0m23:46:51.889153 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_condition_analysis'
[0m23:46:51.890154 [debug] [Thread-1 (]: Began compiling node model.project_tesla.tesla_condition_analysis
[0m23:46:51.899666 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.tesla_condition_analysis"
[0m23:46:51.901666 [debug] [Thread-1 (]: Began executing node model.project_tesla.tesla_condition_analysis
[0m23:46:51.909667 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_condition_analysis"
[0m23:46:51.910665 [debug] [Thread-1 (]: On model.project_tesla.tesla_condition_analysis: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_condition_analysis"} */

  
  

-- Step 1: Get base vehicle data
with stg_tesla as (
    select * from "tesla"."main"."stg_tesla_vehicles"
),

-- Step 2: Categorize vehicles by age
vehicle_age_categories as (
    select 
        *,
        extract(year from current_date) - year as vehicle_age,
        case
            when extract(year from current_date) - year <= 1 then 'New (0-1 years)'
            when extract(year from current_date) - year <= 3 then 'Recent (1-3 years)'
            when extract(year from current_date) - year <= 5 then 'Mid-age (3-5 years)'
            else 'Older (5+ years)'
        end as age_category
    from stg_tesla
),

-- Step 3: Calculate accident statistics by age category
accident_by_age as (
    select
        age_category,
        count(*) as total_vehicles,
        sum(case when had_accident then 1 else 0 end) as accident_count,
        round(sum(case when had_accident then 1 else 0 end) * 100.0 / count(*), 2) as accident_percentage
    from vehicle_age_categories
    group by age_category
),

-- Step 4: Calculate accident statistics by model
accident_by_model as (
    select
        model,
        count(*) as total_vehicles,
        sum(case when had_accident then 1 else 0 end) as accident_count,
        round(sum(case when had_accident then 1 else 0 end) * 100.0 / count(*), 2) as accident_percentage
    from stg_tesla
    group by model
),

-- Step 5: Calculate mileage statistics by model and year
mileage_stats as (
    select
        model,
        year,
        count(*) as total_vehicles,
        round(avg(odometer), 2) as avg_mileage,
        min(odometer) as min_mileage,
        max(odometer) as max_mileage,
        round(stddev(odometer), 2) as mileage_stddev
    from stg_tesla
    where odometer is not null
    group by model, year
)

-- Combine all the analyses into a single result
select 
    'Accident Stats by Age' as analysis_type,
    age_category as dimension,
    total_vehicles,
    accident_count,
    accident_percentage,
    null as avg_mileage,
    null as model,
    null as year
from accident_by_age

union all

select 
    'Accident Stats by Model' as analysis_type,
    model as dimension,
    total_vehicles,
    accident_count,
    accident_percentage,
    null as avg_mileage,
    model,
    null as year
from accident_by_model

union all

select 
    'Mileage Stats by Model/Year' as analysis_type,
    model || ' (' || year || ')' as dimension,
    total_vehicles,
    null as accident_count,
    null as accident_percentage,
    avg_mileage,
    model,
    year
from mileage_stats
  
  limit 10

[0m23:46:51.911666 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:46:51.962577 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m23:46:51.967737 [debug] [Thread-1 (]: On model.project_tesla.tesla_condition_analysis: Close
[0m23:46:51.968740 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_condition_analysis
[0m23:46:51.970732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:51.971731 [debug] [MainThread]: Connection 'list_tesla_main' was properly closed.
[0m23:46:51.972734 [debug] [MainThread]: Connection 'model.project_tesla.tesla_condition_analysis' was properly closed.
[0m23:46:51.973732 [debug] [MainThread]: Command end result
[0m23:46:52.009906 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\manifest.json
[0m23:46:52.013896 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\semantic_manifest.json
[0m23:46:52.023898 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla\target\run_results.json
[0m23:46:52.026898 [info ] [MainThread]: Previewing node 'tesla_condition_analysis':
| analysis_type        | dimension           | total_vehicles | accident_count | accident_percentage | avg_mileage | ... |
| -------------------- | ------------------- | -------------- | -------------- | ------------------- | ----------- | --- |
| Accident Stats by... | New (0-1 years)     |          42410 |           7088 |               16.71 |             | ... |
| Accident Stats by... | Mid-age (3-5 years) |         160670 |          45655 |               28.42 |             | ... |
| Accident Stats by... | Recent (1-3 years)  |          90553 |          14297 |               15.79 |             | ... |
| Accident Stats by... | Older (5+ years)    |          71111 |          22413 |               31.52 |             | ... |
| Accident Stats by... | m3                  |         157081 |          35883 |               22.84 |             | ... |
| Accident Stats by... | mx                  |          56161 |          17060 |               30.38 |             | ... |
| Accident Stats by... | ms                  |          54987 |          15082 |               27.43 |             | ... |
| Accident Stats by... | my                  |          96515 |          21428 |               22.20 |             | ... |
| Mileage Stats by ... | ms (2024)           |           5623 |                |                     |   13,107.83 | ... |
| Mileage Stats by ... | mx (2017)           |            630 |                |                     |   69,991.24 | ... |

[0m23:46:52.028897 [debug] [MainThread]: Command `dbt show` succeeded at 23:46:52.028897 after 2.58 seconds
[0m23:46:52.029898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F8CC32B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F717D360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F8FEC850>]}
[0m23:46:52.029898 [debug] [MainThread]: Flushing usage events
[0m23:46:52.421622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:37.946114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278C24E31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278C3894C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278C3894A90>]}


============================== 19:45:37.951126 | 61544a76-f3ce-4994-979a-9aeb1c1c6e6b ==============================
[0m19:45:37.951126 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:45:37.952120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla_sql\\logs', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:45:37.955120 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'project_tesla'
[0m19:45:37.955120 [debug] [MainThread]: Command `dbt run` failed at 19:45:37.955120 after 0.14 seconds
[0m19:45:37.956636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278C24E31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278C3895A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278C3894AF0>]}
[0m19:45:37.956636 [debug] [MainThread]: Flushing usage events
[0m19:45:39.228055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:19.403221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BBA13220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BCDC4CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BCDC4AC0>]}


============================== 19:47:19.406211 | 6905edd6-41c8-4c16-b379-b8ab60765687 ==============================
[0m19:47:19.406211 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:47:19.407213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla_sql\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:47:19.929667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6905edd6-41c8-4c16-b379-b8ab60765687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BCEF5990>]}
[0m19:47:20.018223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6905edd6-41c8-4c16-b379-b8ab60765687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BC47AC20>]}
[0m19:47:20.033871 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:47:20.397103 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:47:20.594986 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:47:20.595916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6905edd6-41c8-4c16-b379-b8ab60765687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BC47A650>]}
[0m19:47:23.619864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6905edd6-41c8-4c16-b379-b8ab60765687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BE968460>]}
[0m19:47:23.760300 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:47:23.777616 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:47:23.809904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6905edd6-41c8-4c16-b379-b8ab60765687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BE9CDCC0>]}
[0m19:47:23.810902 [info ] [MainThread]: Found 6 models, 1 snapshot, 2 analyses, 1 seed, 4 data tests, 1 source, 432 macros
[0m19:47:23.810902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6905edd6-41c8-4c16-b379-b8ab60765687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BE976F50>]}
[0m19:47:23.812903 [info ] [MainThread]: 
[0m19:47:23.813904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:47:23.813904 [info ] [MainThread]: 
[0m19:47:23.813904 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:47:23.820420 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project'
[0m19:47:25.703433 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project"
[0m19:47:25.704433 [debug] [ThreadPool]: On list_tesla_project: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla_project"'
    
  
  
[0m19:47:25.704433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:25.773836 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m19:47:25.775836 [debug] [ThreadPool]: On list_tesla_project: Close
[0m19:47:25.776837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla_project, now create_tesla_project_main)
[0m19:47:25.777837 [debug] [ThreadPool]: Creating schema "database: "tesla_project"
schema: "main"
"
[0m19:47:25.783837 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:47:25.784851 [debug] [ThreadPool]: On create_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_project_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla_project'
        and type='sqlite'
    
  
[0m19:47:25.784851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:25.785837 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:47:25.787838 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:47:25.787838 [debug] [ThreadPool]: On create_tesla_project_main: BEGIN
[0m19:47:25.788838 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:47:25.788838 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:47:25.789837 [debug] [ThreadPool]: On create_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_project_main"} */

    
    
        create schema if not exists "tesla_project"."main"
    
[0m19:47:25.790839 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:47:25.791859 [debug] [ThreadPool]: On create_tesla_project_main: COMMIT
[0m19:47:25.792849 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:47:25.792849 [debug] [ThreadPool]: On create_tesla_project_main: COMMIT
[0m19:47:25.793844 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:47:25.793844 [debug] [ThreadPool]: On create_tesla_project_main: Close
[0m19:47:25.795845 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project_main'
[0m19:47:25.800837 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:47:25.801838 [debug] [ThreadPool]: On list_tesla_project_main: BEGIN
[0m19:47:25.801838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:25.802837 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:47:25.802837 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:47:25.803843 [debug] [ThreadPool]: On list_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project_main"} */
select
      'tesla_project' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla_project'
  
[0m19:47:25.818395 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m19:47:25.820408 [debug] [ThreadPool]: On list_tesla_project_main: ROLLBACK
[0m19:47:25.832407 [debug] [ThreadPool]: Failed to rollback 'list_tesla_project_main'
[0m19:47:25.832407 [debug] [ThreadPool]: On list_tesla_project_main: Close
[0m19:47:25.833729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6905edd6-41c8-4c16-b379-b8ab60765687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BCE7EE00>]}
[0m19:47:25.833729 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:25.834744 [debug] [MainThread]: On master: BEGIN
[0m19:47:25.834744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:25.835739 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:47:25.835739 [debug] [MainThread]: On master: COMMIT
[0m19:47:25.836738 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:25.836738 [debug] [MainThread]: On master: COMMIT
[0m19:47:25.837739 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:47:25.837739 [debug] [MainThread]: On master: Close
[0m19:47:25.843352 [debug] [Thread-1 (]: Began running node model.project_tesla.stg_tesla_vehicles
[0m19:47:25.844376 [info ] [Thread-1 (]: 1 of 6 START sql view model main.stg_tesla_vehicles ............................ [RUN]
[0m19:47:25.845351 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.project_tesla.stg_tesla_vehicles'
[0m19:47:25.845351 [debug] [Thread-1 (]: Began compiling node model.project_tesla.stg_tesla_vehicles
[0m19:47:25.852361 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.stg_tesla_vehicles"
[0m19:47:25.853358 [debug] [Thread-1 (]: Began executing node model.project_tesla.stg_tesla_vehicles
[0m19:47:25.881351 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_tesla.stg_tesla_vehicles"
[0m19:47:25.882362 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m19:47:25.883361 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: BEGIN
[0m19:47:25.883361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:47:25.884358 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:47:25.884358 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m19:47:25.885350 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.stg_tesla_vehicles"} */

  
  create view "tesla_project"."main"."stg_tesla_vehicles__dbt_tmp" as (
    

with source_data as (
    select * from "tesla_project"."main"."tesla_results"
),

staged as (
    select
        -- Basic vehicle information
        trim(model) as model,
        trim(trim_name) as trim_name,
        year,
        vin,
        
        -- Location information
        trim(country) as country,
        trim(country_code) as country_code,
        trim(city) as city,
        
        -- Price and metrics
        -- Extract numeric price from string
        regexp_extract(price, '[0-9]+') as price_str,
        try_cast(regexp_extract(price, '[0-9]+') as float) as price,
        try_cast(odometer as float) as odometer,
        
        -- Dates
        try_cast(original_delivery_date as timestamp) as delivery_date,
        try_cast(battery_warranty_exp_date as timestamp) as warranty_expiry_date,
        "current_time" as record_time_str,
        
        -- Additional attributes
        trim(color) as color,
        trim(vehicle_history) as vehicle_history,
        case 
            when vehicle_history is null then false
            when lower(vehicle_history) like '%accident%' then true
            else false
        end as had_accident,
        
        -- Status flags
        in_transit,
        trim(cpo_refurbishment_status) as refurbishment_status
    from source_data
)

select * from staged
  );

[0m19:47:25.892178 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.stg_tesla_vehicles"} */

  
  create view "tesla_project"."main"."stg_tesla_vehicles__dbt_tmp" as (
    

with source_data as (
    select * from "tesla_project"."main"."tesla_results"
),

staged as (
    select
        -- Basic vehicle information
        trim(model) as model,
        trim(trim_name) as trim_name,
        year,
        vin,
        
        -- Location information
        trim(country) as country,
        trim(country_code) as country_code,
        trim(city) as city,
        
        -- Price and metrics
        -- Extract numeric price from string
        regexp_extract(price, '[0-9]+') as price_str,
        try_cast(regexp_extract(price, '[0-9]+') as float) as price,
        try_cast(odometer as float) as odometer,
        
        -- Dates
        try_cast(original_delivery_date as timestamp) as delivery_date,
        try_cast(battery_warranty_exp_date as timestamp) as warranty_expiry_date,
        "current_time" as record_time_str,
        
        -- Additional attributes
        trim(color) as color,
        trim(vehicle_history) as vehicle_history,
        case 
            when vehicle_history is null then false
            when lower(vehicle_history) like '%accident%' then true
            else false
        end as had_accident,
        
        -- Status flags
        in_transit,
        trim(cpo_refurbishment_status) as refurbishment_status
    from source_data
)

select * from staged
  );

[0m19:47:25.893179 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:47:25.893179 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: ROLLBACK
[0m19:47:25.989670 [debug] [Thread-1 (]: Failed to rollback 'model.project_tesla.stg_tesla_vehicles'
[0m19:47:25.990669 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: Close
[0m19:47:25.992682 [debug] [Thread-1 (]: Runtime Error in model stg_tesla_vehicles (models\staging\stg_tesla_vehicles.sql)
  Catalog Error: Table with name tesla_results does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 8:     select * from "tesla_project"."main"."tesla_results"
                            ^
[0m19:47:25.994675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6905edd6-41c8-4c16-b379-b8ab60765687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BA895300>]}
[0m19:47:25.995678 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model main.stg_tesla_vehicles ................... [[31mERROR[0m in 0.15s]
[0m19:47:25.996668 [debug] [Thread-1 (]: Finished running node model.project_tesla.stg_tesla_vehicles
[0m19:47:25.997669 [debug] [Thread-4 (]: Marking all children of 'model.project_tesla.stg_tesla_vehicles' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_tesla_vehicles (models\staging\stg_tesla_vehicles.sql)
  Catalog Error: Table with name tesla_results does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 8:     select * from "tesla_project"."main"."tesla_results"
                            ^.
[0m19:47:25.999668 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_analysis
[0m19:47:25.999668 [info ] [Thread-1 (]: 2 of 6 SKIP relation main.tesla_analysis ....................................... [[33mSKIP[0m]
[0m19:47:26.000680 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_analysis
[0m19:47:26.001668 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_condition_analysis
[0m19:47:26.001668 [info ] [Thread-1 (]: 3 of 6 SKIP relation main.tesla_condition_analysis ............................. [[33mSKIP[0m]
[0m19:47:26.002667 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_condition_analysis
[0m19:47:26.002667 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_ownership_analysis
[0m19:47:26.003672 [info ] [Thread-1 (]: 4 of 6 SKIP relation main.tesla_ownership_analysis ............................. [[33mSKIP[0m]
[0m19:47:26.004676 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_ownership_analysis
[0m19:47:26.004676 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_price_trends
[0m19:47:26.005672 [info ] [Thread-1 (]: 5 of 6 SKIP relation main.tesla_price_trends ................................... [[33mSKIP[0m]
[0m19:47:26.005996 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_price_trends
[0m19:47:26.005996 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_vehicles_incremental
[0m19:47:26.007017 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.tesla_vehicles_incremental ........................... [[33mSKIP[0m]
[0m19:47:26.008004 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_vehicles_incremental
[0m19:47:26.009004 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:26.009004 [debug] [MainThread]: On master: BEGIN
[0m19:47:26.010013 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:26.010013 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:47:26.011004 [debug] [MainThread]: On master: COMMIT
[0m19:47:26.011004 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:26.011004 [debug] [MainThread]: On master: COMMIT
[0m19:47:26.012010 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:47:26.013007 [debug] [MainThread]: On master: Close
[0m19:47:26.013007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:26.014007 [debug] [MainThread]: Connection 'create_tesla_project_main' was properly closed.
[0m19:47:26.014007 [debug] [MainThread]: Connection 'list_tesla_project_main' was properly closed.
[0m19:47:26.014007 [debug] [MainThread]: Connection 'model.project_tesla.stg_tesla_vehicles' was properly closed.
[0m19:47:26.015007 [info ] [MainThread]: 
[0m19:47:26.015007 [info ] [MainThread]: Finished running 1 incremental model, 4 table models, 1 view model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m19:47:26.016007 [debug] [MainThread]: Command end result
[0m19:47:26.097547 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:47:26.100547 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:47:26.107556 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\run_results.json
[0m19:47:26.107556 [info ] [MainThread]: 
[0m19:47:26.108556 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:47:26.109557 [info ] [MainThread]: 
[0m19:47:26.109557 [error] [MainThread]: [31mFailure in model stg_tesla_vehicles (models\staging\stg_tesla_vehicles.sql)[0m
[0m19:47:26.110554 [error] [MainThread]:   Runtime Error in model stg_tesla_vehicles (models\staging\stg_tesla_vehicles.sql)
  Catalog Error: Table with name tesla_results does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 8:     select * from "tesla_project"."main"."tesla_results"
                            ^
[0m19:47:26.111554 [info ] [MainThread]: 
[0m19:47:26.111554 [info ] [MainThread]:   compiled code at target\compiled\project_tesla\models\staging\stg_tesla_vehicles.sql
[0m19:47:26.112554 [info ] [MainThread]: 
[0m19:47:26.112554 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 NO-OP=0 TOTAL=6
[0m19:47:26.113554 [debug] [MainThread]: Command `dbt run` failed at 19:47:26.113554 after 6.81 seconds
[0m19:47:26.114560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BBA13220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BBD3D300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BED43F10>]}
[0m19:47:26.114560 [debug] [MainThread]: Flushing usage events
[0m19:47:27.504171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:39.878824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FD8863280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FD9C20CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FD9C20AF0>]}


============================== 19:47:39.882832 | fcde0ce7-8683-4d23-bb42-988af765fb45 ==============================
[0m19:47:39.882832 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:47:39.883834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla_sql\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:47:40.221187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcde0ce7-8683-4d23-bb42-988af765fb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FD9DC2E60>]}
[0m19:47:40.290526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcde0ce7-8683-4d23-bb42-988af765fb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FD9C22710>]}
[0m19:47:40.293520 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:47:40.517555 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:47:40.750835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:40.751843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:40.836847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcde0ce7-8683-4d23-bb42-988af765fb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FDB2C8640>]}
[0m19:47:41.029604 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:47:41.031604 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:47:41.056389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcde0ce7-8683-4d23-bb42-988af765fb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FD9DC19F0>]}
[0m19:47:41.057389 [info ] [MainThread]: Found 6 models, 1 snapshot, 2 analyses, 1 seed, 4 data tests, 1 source, 432 macros
[0m19:47:41.058389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcde0ce7-8683-4d23-bb42-988af765fb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FD9DC3D90>]}
[0m19:47:41.060388 [info ] [MainThread]: 
[0m19:47:41.060388 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:47:41.061384 [info ] [MainThread]: 
[0m19:47:41.062382 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:47:41.063382 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project'
[0m19:47:41.165099 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project"
[0m19:47:41.167105 [debug] [ThreadPool]: On list_tesla_project: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla_project"'
    
  
  
[0m19:47:41.168113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:41.195361 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m19:47:41.196932 [debug] [ThreadPool]: On list_tesla_project: Close
[0m19:47:41.197992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla_project, now create_tesla_project_main)
[0m19:47:41.198520 [debug] [ThreadPool]: Creating schema "database: "tesla_project"
schema: "main"
"
[0m19:47:41.205818 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:47:41.206341 [debug] [ThreadPool]: On create_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_project_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla_project'
        and type='sqlite'
    
  
[0m19:47:41.206341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:41.207478 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:47:41.209066 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:47:41.209066 [debug] [ThreadPool]: On create_tesla_project_main: BEGIN
[0m19:47:41.210135 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:47:41.210135 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:47:41.210657 [debug] [ThreadPool]: On create_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_project_main"} */

    
    
        create schema if not exists "tesla_project"."main"
    
[0m19:47:41.211217 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:47:41.212327 [debug] [ThreadPool]: On create_tesla_project_main: COMMIT
[0m19:47:41.212327 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:47:41.212880 [debug] [ThreadPool]: On create_tesla_project_main: COMMIT
[0m19:47:41.213431 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:47:41.213954 [debug] [ThreadPool]: On create_tesla_project_main: Close
[0m19:47:41.219232 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project_main'
[0m19:47:41.225184 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:47:41.225184 [debug] [ThreadPool]: On list_tesla_project_main: BEGIN
[0m19:47:41.226184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:41.226184 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:47:41.227184 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:47:41.227184 [debug] [ThreadPool]: On list_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project_main"} */
select
      'tesla_project' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla_project'
  
[0m19:47:41.238771 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m19:47:41.239780 [debug] [ThreadPool]: On list_tesla_project_main: ROLLBACK
[0m19:47:41.240772 [debug] [ThreadPool]: Failed to rollback 'list_tesla_project_main'
[0m19:47:41.240772 [debug] [ThreadPool]: On list_tesla_project_main: Close
[0m19:47:41.242276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcde0ce7-8683-4d23-bb42-988af765fb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FDB19BF10>]}
[0m19:47:41.242276 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:41.243364 [debug] [MainThread]: On master: BEGIN
[0m19:47:41.243364 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:41.244371 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:47:41.244371 [debug] [MainThread]: On master: COMMIT
[0m19:47:41.245283 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:41.245283 [debug] [MainThread]: On master: COMMIT
[0m19:47:41.246377 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:47:41.246377 [debug] [MainThread]: On master: Close
[0m19:47:41.250280 [debug] [Thread-1 (]: Began running node seed.project_tesla.tesla_results
[0m19:47:41.251280 [info ] [Thread-1 (]: 1 of 1 START seed file main.tesla_results ...................................... [RUN]
[0m19:47:41.252281 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.project_tesla.tesla_results'
[0m19:47:41.252281 [debug] [Thread-1 (]: Began compiling node seed.project_tesla.tesla_results
[0m19:47:41.253283 [debug] [Thread-1 (]: Began executing node seed.project_tesla.tesla_results
[0m19:48:07.647498 [debug] [Thread-1 (]: Using duckdb connection "seed.project_tesla.tesla_results"
[0m19:48:07.648506 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: BEGIN
[0m19:48:07.648506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:48:07.649500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:48:07.650499 [debug] [Thread-1 (]: Using duckdb connection "seed.project_tesla.tesla_results"
[0m19:48:07.651498 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "seed.project_tesla.tesla_results"} */

    create table "tesla_project"."main"."tesla_results" ("country" text,"trim_name" text,"in_transit" boolean,"cpo_refurbishment_status" text,"city" text,"country_code" text,"country_of_origin" text,"model" text,"year" integer,"vin" text,"price" varchar,"color" text,"original_delivery_date" timestamp without time zone,"odometer" varchar,"title_sub_type" text,"vrl_name" text,"battery_warranty_exp_date" timestamp without time zone,"warranty_battery_is_expired" boolean,"vehicle_history" text,"odometer_type" text,"current_time" timestamp without time zone)
  
[0m19:48:07.654499 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:48:07.678017 [debug] [Thread-1 (]: Using duckdb connection "seed.project_tesla.tesla_results"
[0m19:48:07.679019 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: 
          COPY "tesla_project"."main"."tesla_results" FROM 'C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\seeds\tesla_results.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:48:09.103826 [debug] [Thread-1 (]: SQL status: OK in 1.424 seconds
[0m19:48:09.110838 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.project_tesla.tesla_results"
[0m19:48:09.124830 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: COMMIT
[0m19:48:09.125824 [debug] [Thread-1 (]: Using duckdb connection "seed.project_tesla.tesla_results"
[0m19:48:09.126823 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: COMMIT
[0m19:48:09.201059 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m19:48:09.204061 [debug] [Thread-1 (]: On seed.project_tesla.tesla_results: Close
[0m19:48:09.206072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcde0ce7-8683-4d23-bb42-988af765fb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FDB23F400>]}
[0m19:48:09.207072 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.tesla_results .................................. [[32mINSERT 364744[0m in 27.95s]
[0m19:48:09.208060 [debug] [Thread-1 (]: Finished running node seed.project_tesla.tesla_results
[0m19:48:09.210061 [debug] [MainThread]: Using duckdb connection "master"
[0m19:48:09.210061 [debug] [MainThread]: On master: BEGIN
[0m19:48:09.211075 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:48:09.211075 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:48:09.212064 [debug] [MainThread]: On master: COMMIT
[0m19:48:09.212064 [debug] [MainThread]: Using duckdb connection "master"
[0m19:48:09.213063 [debug] [MainThread]: On master: COMMIT
[0m19:48:09.213063 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:48:09.214063 [debug] [MainThread]: On master: Close
[0m19:48:09.214063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:09.214063 [debug] [MainThread]: Connection 'create_tesla_project_main' was properly closed.
[0m19:48:09.215064 [debug] [MainThread]: Connection 'list_tesla_project_main' was properly closed.
[0m19:48:09.215064 [debug] [MainThread]: Connection 'seed.project_tesla.tesla_results' was properly closed.
[0m19:48:09.216063 [info ] [MainThread]: 
[0m19:48:09.216505 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 28.15 seconds (28.15s).
[0m19:48:09.217011 [debug] [MainThread]: Command end result
[0m19:48:09.259701 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:48:09.262817 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:48:09.271691 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\run_results.json
[0m19:48:09.272803 [info ] [MainThread]: 
[0m19:48:09.273889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:48:09.274480 [info ] [MainThread]: 
[0m19:48:09.275077 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:48:09.277277 [debug] [MainThread]: Command `dbt seed` succeeded at 19:48:09.276723 after 29.50 seconds
[0m19:48:09.277803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FD8863280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FDB1AC370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FD8B91DE0>]}
[0m19:48:09.278339 [debug] [MainThread]: Flushing usage events
[0m19:48:09.834983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:52:36.933318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5974E31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D598898CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D598898AC0>]}


============================== 19:52:36.937328 | 5cff6312-db3b-4ca4-85de-92479de97ef0 ==============================
[0m19:52:36.937328 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:52:36.938319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla_sql\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:52:37.273387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cff6312-db3b-4ca4-85de-92479de97ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5949A0B80>]}
[0m19:52:37.347900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cff6312-db3b-4ca4-85de-92479de97ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D598A428F0>]}
[0m19:56:13.667702 [error] [MainThread]: Encountered an error:

[0m19:56:13.705882 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\tanis\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\tanis\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\tanis\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\tanis\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\tanis\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\tanis\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
  File "C:\Users\tanis\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\tanis\AppData\Local\Programs\Python\Python310\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\tanis\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\tanis\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m19:56:13.707924 [debug] [MainThread]: Command `dbt docs serve` failed at 19:56:13.707924 after 216.86 seconds
[0m19:56:13.707924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5974E31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D599B8E560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D599B8E470>]}
[0m19:56:13.708936 [debug] [MainThread]: Flushing usage events
[0m19:56:14.141109 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:24.770472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CC3A31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CE730CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CE730AC0>]}


============================== 19:56:24.774697 | f7fb288e-76e0-44ac-be3e-ffe1027274d7 ==============================
[0m19:56:24.774697 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:56:24.775757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla_sql\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models tesla_market_intelligence', 'send_anonymous_usage_stats': 'True'}
[0m19:56:24.776277 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m19:56:24.777299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f7fb288e-76e0-44ac-be3e-ffe1027274d7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CE730A30>]}
[0m19:56:25.080196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7fb288e-76e0-44ac-be3e-ffe1027274d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CE8D6650>]}
[0m19:56:25.160725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7fb288e-76e0-44ac-be3e-ffe1027274d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CE695A50>]}
[0m19:56:25.165097 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:56:25.397384 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:56:25.652568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:56:25.653569 [debug] [MainThread]: Partial parsing: added file: project_tesla://models\marts\tesla_market_intelligence.sql
[0m19:56:26.074474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7fb288e-76e0-44ac-be3e-ffe1027274d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CFF37DC0>]}
[0m19:56:26.199061 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:56:26.200987 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:56:26.225833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7fb288e-76e0-44ac-be3e-ffe1027274d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CFD73160>]}
[0m19:56:26.227338 [info ] [MainThread]: Found 7 models, 1 snapshot, 2 analyses, 1 seed, 4 data tests, 1 source, 432 macros
[0m19:56:26.228344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7fb288e-76e0-44ac-be3e-ffe1027274d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CFF35660>]}
[0m19:56:26.229344 [info ] [MainThread]: 
[0m19:56:26.230344 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:26.230344 [info ] [MainThread]: 
[0m19:56:26.231351 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:56:26.232345 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project'
[0m19:56:26.304662 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project"
[0m19:56:26.305662 [debug] [ThreadPool]: On list_tesla_project: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla_project"'
    
  
  
[0m19:56:26.305662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:26.328970 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m19:56:26.329969 [debug] [ThreadPool]: On list_tesla_project: Close
[0m19:56:26.330970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla_project, now create_tesla_project_main)
[0m19:56:26.331970 [debug] [ThreadPool]: Creating schema "database: "tesla_project"
schema: "main"
"
[0m19:56:26.336969 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:26.337970 [debug] [ThreadPool]: On create_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_project_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla_project'
        and type='sqlite'
    
  
[0m19:56:26.337970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:26.338969 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:56:26.339970 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:26.340983 [debug] [ThreadPool]: On create_tesla_project_main: BEGIN
[0m19:56:26.340983 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:26.341977 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:26.341977 [debug] [ThreadPool]: On create_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_project_main"} */

    
    
        create schema if not exists "tesla_project"."main"
    
[0m19:56:26.342976 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:26.342976 [debug] [ThreadPool]: On create_tesla_project_main: COMMIT
[0m19:56:26.343970 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:26.343970 [debug] [ThreadPool]: On create_tesla_project_main: COMMIT
[0m19:56:26.344969 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:26.344969 [debug] [ThreadPool]: On create_tesla_project_main: Close
[0m19:56:26.350039 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project_main'
[0m19:56:26.354969 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:56:26.355969 [debug] [ThreadPool]: On list_tesla_project_main: BEGIN
[0m19:56:26.355969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:26.356974 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:56:26.356974 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:56:26.356974 [debug] [ThreadPool]: On list_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project_main"} */
select
      'tesla_project' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla_project'
  
[0m19:56:26.367972 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m19:56:26.369970 [debug] [ThreadPool]: On list_tesla_project_main: ROLLBACK
[0m19:56:26.370970 [debug] [ThreadPool]: Failed to rollback 'list_tesla_project_main'
[0m19:56:26.371970 [debug] [ThreadPool]: On list_tesla_project_main: Close
[0m19:56:26.373042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7fb288e-76e0-44ac-be3e-ffe1027274d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CFD728F0>]}
[0m19:56:26.373042 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:26.374042 [debug] [MainThread]: On master: BEGIN
[0m19:56:26.374042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:26.375037 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:26.375037 [debug] [MainThread]: On master: COMMIT
[0m19:56:26.375037 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:26.376037 [debug] [MainThread]: On master: COMMIT
[0m19:56:26.376037 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:26.377070 [debug] [MainThread]: On master: Close
[0m19:56:26.380609 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_market_intelligence
[0m19:56:26.381619 [info ] [Thread-1 (]: 1 of 1 START sql table model main.tesla_market_intelligence .................... [RUN]
[0m19:56:26.382327 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_market_intelligence'
[0m19:56:26.382327 [debug] [Thread-1 (]: Began compiling node model.project_tesla.tesla_market_intelligence
[0m19:56:26.389526 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.tesla_market_intelligence"
[0m19:56:26.391527 [debug] [Thread-1 (]: Began executing node model.project_tesla.tesla_market_intelligence
[0m19:56:26.416544 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_tesla.tesla_market_intelligence"
[0m19:56:26.418540 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_market_intelligence"
[0m19:56:26.418540 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: BEGIN
[0m19:56:26.419538 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:26.420538 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:26.420538 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_market_intelligence"
[0m19:56:26.421545 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_market_intelligence"} */

  
    
    

    create  table
      "tesla_project"."main"."tesla_market_intelligence__dbt_tmp"
  
    as (
      

with base_vehicles as (
    select * from "tesla_project"."main"."stg_tesla_vehicles"
),

-- Create a "Regional Market Performance" virtual table
regional_markets as (
    select
        country,
        city,
        count(*) as inventory_count,
        round(avg(price), 2) as avg_market_price,
        round(min(price), 2) as min_market_price,
        round(max(price), 2) as max_market_price,
        round(avg(odometer), 2) as avg_mileage,
        count(case when had_accident then 1 end) as accident_vehicles,
        round(count(case when had_accident then 1 end) * 100.0 / nullif(count(*), 0), 2) as accident_rate_pct,
        -- Market tier classification
        case 
            when avg(price) >= 80000 then 'Premium Market'
            when avg(price) >= 50000 then 'Mid-tier Market'
            else 'Entry Market'
        end as market_tier
    from base_vehicles
    where price is not null
    group by country, city
    having count(*) >= 3  -- Only include markets with meaningful inventory
),

-- Create a "Model Performance Metrics" virtual table
model_performance as (
    select
        model,
        trim_name,
        year,
        count(*) as model_inventory,
        round(avg(price), 2) as avg_model_price,
        round(avg(odometer), 2) as avg_model_mileage,
        -- Price depreciation per mile (proxy for value retention)
        case 
            when avg(odometer) > 0 then round((avg(price) / nullif(avg(odometer), 0)) * 1000, 2)
            else null
        end as price_per_1k_miles,
        -- Model condition score
        round((count(*) - count(case when had_accident then 1 end)) * 100.0 / nullif(count(*), 0), 2) as clean_history_pct,
        -- Categorize model popularity
        case 
            when count(*) >= 100 then 'High Volume'
            when count(*) >= 50 then 'Medium Volume'
            when count(*) >= 20 then 'Low Volume'
            else 'Rare'
        end as availability_tier
    from base_vehicles
    where price is not null and model is not null
    group by model, trim_name, year
),

-- Create comprehensive joined analysis
market_intelligence as (
    select
        -- Vehicle details
        v.vin,
        v.model,
        v.trim_name,
        v.year,
        v.price,
        v.odometer,
        v.color,
        v.had_accident,
        v.delivery_date,
        
        -- Regional market context (joined data)
        v.country,
        v.city,
        rm.market_tier,
        rm.inventory_count as city_inventory,
        rm.avg_market_price as city_avg_price,
        rm.accident_rate_pct as city_accident_rate,
        
        -- Model performance context (joined data)
        mp.model_inventory as total_model_inventory,
        mp.avg_model_price,
        mp.avg_model_mileage as model_avg_mileage,
        mp.price_per_1k_miles as model_value_retention,
        mp.clean_history_pct as model_clean_rate,
        mp.availability_tier,
        
        -- Calculated insights from joins
        round(v.price - rm.avg_market_price, 2) as price_vs_market_avg,
        round((v.price - rm.avg_market_price) * 100.0 / nullif(rm.avg_market_price, 0), 2) as price_premium_pct,
        round(v.price - mp.avg_model_price, 2) as price_vs_model_avg,
        round((v.price - mp.avg_model_price) * 100.0 / nullif(mp.avg_model_price, 0), 2) as model_price_variance_pct,
        
        -- Market positioning score (combination of regional and model factors)
        case
            when v.price > rm.avg_market_price and v.price > mp.avg_model_price and not v.had_accident then 'Premium Positioned'
            when v.price < rm.avg_market_price and v.price < mp.avg_model_price then 'Value Opportunity'
            when v.had_accident and v.price < mp.avg_model_price * 0.85 then 'Discounted - Accident History'
            when v.odometer < mp.avg_model_mileage * 0.7 then 'Low Mileage Premium'
            else 'Market Standard'
        end as market_position,
        
        -- Investment score (1-10 scale based on multiple factors)
        least(10, greatest(1, 
            5 +  -- Base score
            case when v.price < rm.avg_market_price then 2 else -1 end +  -- Below market price bonus
            case when v.odometer < mp.avg_model_mileage then 1 else 0 end +  -- Low mileage bonus
            case when not v.had_accident then 1 else -2 end +  -- Clean history bonus
            case when rm.market_tier = 'Premium Market' then 1 else 0 end +  -- Premium market bonus
            case when mp.availability_tier = 'Rare' then 2 else 0 end  -- Rarity bonus
        )) as investment_score
        
    from base_vehicles v
    
    -- Join with regional market data
    left join regional_markets rm
        on v.country = rm.country 
        and v.city = rm.city
    
    -- Join with model performance data  
    left join model_performance mp
        on v.model = mp.model 
        and v.trim_name = mp.trim_name 
        and v.year = mp.year
        
    where v.price is not null
)

select * from market_intelligence
order by investment_score desc, price asc
    );
  
  
[0m19:56:26.424880 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_market_intelligence"} */

  
    
    

    create  table
      "tesla_project"."main"."tesla_market_intelligence__dbt_tmp"
  
    as (
      

with base_vehicles as (
    select * from "tesla_project"."main"."stg_tesla_vehicles"
),

-- Create a "Regional Market Performance" virtual table
regional_markets as (
    select
        country,
        city,
        count(*) as inventory_count,
        round(avg(price), 2) as avg_market_price,
        round(min(price), 2) as min_market_price,
        round(max(price), 2) as max_market_price,
        round(avg(odometer), 2) as avg_mileage,
        count(case when had_accident then 1 end) as accident_vehicles,
        round(count(case when had_accident then 1 end) * 100.0 / nullif(count(*), 0), 2) as accident_rate_pct,
        -- Market tier classification
        case 
            when avg(price) >= 80000 then 'Premium Market'
            when avg(price) >= 50000 then 'Mid-tier Market'
            else 'Entry Market'
        end as market_tier
    from base_vehicles
    where price is not null
    group by country, city
    having count(*) >= 3  -- Only include markets with meaningful inventory
),

-- Create a "Model Performance Metrics" virtual table
model_performance as (
    select
        model,
        trim_name,
        year,
        count(*) as model_inventory,
        round(avg(price), 2) as avg_model_price,
        round(avg(odometer), 2) as avg_model_mileage,
        -- Price depreciation per mile (proxy for value retention)
        case 
            when avg(odometer) > 0 then round((avg(price) / nullif(avg(odometer), 0)) * 1000, 2)
            else null
        end as price_per_1k_miles,
        -- Model condition score
        round((count(*) - count(case when had_accident then 1 end)) * 100.0 / nullif(count(*), 0), 2) as clean_history_pct,
        -- Categorize model popularity
        case 
            when count(*) >= 100 then 'High Volume'
            when count(*) >= 50 then 'Medium Volume'
            when count(*) >= 20 then 'Low Volume'
            else 'Rare'
        end as availability_tier
    from base_vehicles
    where price is not null and model is not null
    group by model, trim_name, year
),

-- Create comprehensive joined analysis
market_intelligence as (
    select
        -- Vehicle details
        v.vin,
        v.model,
        v.trim_name,
        v.year,
        v.price,
        v.odometer,
        v.color,
        v.had_accident,
        v.delivery_date,
        
        -- Regional market context (joined data)
        v.country,
        v.city,
        rm.market_tier,
        rm.inventory_count as city_inventory,
        rm.avg_market_price as city_avg_price,
        rm.accident_rate_pct as city_accident_rate,
        
        -- Model performance context (joined data)
        mp.model_inventory as total_model_inventory,
        mp.avg_model_price,
        mp.avg_model_mileage as model_avg_mileage,
        mp.price_per_1k_miles as model_value_retention,
        mp.clean_history_pct as model_clean_rate,
        mp.availability_tier,
        
        -- Calculated insights from joins
        round(v.price - rm.avg_market_price, 2) as price_vs_market_avg,
        round((v.price - rm.avg_market_price) * 100.0 / nullif(rm.avg_market_price, 0), 2) as price_premium_pct,
        round(v.price - mp.avg_model_price, 2) as price_vs_model_avg,
        round((v.price - mp.avg_model_price) * 100.0 / nullif(mp.avg_model_price, 0), 2) as model_price_variance_pct,
        
        -- Market positioning score (combination of regional and model factors)
        case
            when v.price > rm.avg_market_price and v.price > mp.avg_model_price and not v.had_accident then 'Premium Positioned'
            when v.price < rm.avg_market_price and v.price < mp.avg_model_price then 'Value Opportunity'
            when v.had_accident and v.price < mp.avg_model_price * 0.85 then 'Discounted - Accident History'
            when v.odometer < mp.avg_model_mileage * 0.7 then 'Low Mileage Premium'
            else 'Market Standard'
        end as market_position,
        
        -- Investment score (1-10 scale based on multiple factors)
        least(10, greatest(1, 
            5 +  -- Base score
            case when v.price < rm.avg_market_price then 2 else -1 end +  -- Below market price bonus
            case when v.odometer < mp.avg_model_mileage then 1 else 0 end +  -- Low mileage bonus
            case when not v.had_accident then 1 else -2 end +  -- Clean history bonus
            case when rm.market_tier = 'Premium Market' then 1 else 0 end +  -- Premium market bonus
            case when mp.availability_tier = 'Rare' then 2 else 0 end  -- Rarity bonus
        )) as investment_score
        
    from base_vehicles v
    
    -- Join with regional market data
    left join regional_markets rm
        on v.country = rm.country 
        and v.city = rm.city
    
    -- Join with model performance data  
    left join model_performance mp
        on v.model = mp.model 
        and v.trim_name = mp.trim_name 
        and v.year = mp.year
        
    where v.price is not null
)

select * from market_intelligence
order by investment_score desc, price asc
    );
  
  
[0m19:56:26.425885 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:56:26.425885 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: ROLLBACK
[0m19:56:26.431397 [debug] [Thread-1 (]: Failed to rollback 'model.project_tesla.tesla_market_intelligence'
[0m19:56:26.431397 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: Close
[0m19:56:26.433397 [debug] [Thread-1 (]: Runtime Error in model tesla_market_intelligence (models\marts\tesla_market_intelligence.sql)
  Catalog Error: Table with name stg_tesla_vehicles does not exist!
  Did you mean "tesla_results"?
  
  LINE 14:     select * from "tesla_project"."main"."stg_tesla_vehicles"
                             ^
[0m19:56:26.435397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7fb288e-76e0-44ac-be3e-ffe1027274d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CE833F10>]}
[0m19:56:26.436397 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.tesla_market_intelligence ........... [[31mERROR[0m in 0.05s]
[0m19:56:26.437397 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_market_intelligence
[0m19:56:26.437397 [debug] [Thread-4 (]: Marking all children of 'model.project_tesla.tesla_market_intelligence' to be skipped because of status 'error'.  Reason: Runtime Error in model tesla_market_intelligence (models\marts\tesla_market_intelligence.sql)
  Catalog Error: Table with name stg_tesla_vehicles does not exist!
  Did you mean "tesla_results"?
  
  LINE 14:     select * from "tesla_project"."main"."stg_tesla_vehicles"
                             ^.
[0m19:56:26.439396 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:26.439396 [debug] [MainThread]: On master: BEGIN
[0m19:56:26.440396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:26.440396 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:26.441397 [debug] [MainThread]: On master: COMMIT
[0m19:56:26.441397 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:26.442397 [debug] [MainThread]: On master: COMMIT
[0m19:56:26.442397 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:26.443414 [debug] [MainThread]: On master: Close
[0m19:56:26.443414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:26.443414 [debug] [MainThread]: Connection 'create_tesla_project_main' was properly closed.
[0m19:56:26.444412 [debug] [MainThread]: Connection 'list_tesla_project_main' was properly closed.
[0m19:56:26.444412 [debug] [MainThread]: Connection 'model.project_tesla.tesla_market_intelligence' was properly closed.
[0m19:56:26.444412 [info ] [MainThread]: 
[0m19:56:26.445412 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m19:56:26.446398 [debug] [MainThread]: Command end result
[0m19:56:26.467403 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:56:26.469414 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:56:26.476398 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\run_results.json
[0m19:56:26.476398 [info ] [MainThread]: 
[0m19:56:26.477413 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:56:26.478405 [info ] [MainThread]: 
[0m19:56:26.478405 [error] [MainThread]: [31mFailure in model tesla_market_intelligence (models\marts\tesla_market_intelligence.sql)[0m
[0m19:56:26.479412 [error] [MainThread]:   Runtime Error in model tesla_market_intelligence (models\marts\tesla_market_intelligence.sql)
  Catalog Error: Table with name stg_tesla_vehicles does not exist!
  Did you mean "tesla_results"?
  
  LINE 14:     select * from "tesla_project"."main"."stg_tesla_vehicles"
                             ^
[0m19:56:26.480398 [info ] [MainThread]: 
[0m19:56:26.480398 [info ] [MainThread]:   compiled code at target\compiled\project_tesla\models\marts\tesla_market_intelligence.sql
[0m19:56:26.481397 [info ] [MainThread]: 
[0m19:56:26.481397 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:56:26.482397 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:56:26.484412 [debug] [MainThread]: Command `dbt run` failed at 19:56:26.484412 after 1.82 seconds
[0m19:56:26.484412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CC3A31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CE8D6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2CD6A3790>]}
[0m19:56:26.485424 [debug] [MainThread]: Flushing usage events
[0m19:56:26.883685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:36.407514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023215C83250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023217038D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023217038B80>]}


============================== 19:56:36.411507 | 22028340-d51d-456d-95b2-176346a0bc26 ==============================
[0m19:56:36.411507 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:56:36.412527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla_sql\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models tesla_market_intelligence --debug', 'send_anonymous_usage_stats': 'True'}
[0m19:56:36.413506 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m19:56:36.413506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '22028340-d51d-456d-95b2-176346a0bc26', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023217038AF0>]}
[0m19:56:36.795337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22028340-d51d-456d-95b2-176346a0bc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023216DEFD90>]}
[0m19:56:36.878068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22028340-d51d-456d-95b2-176346a0bc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023216FFC2B0>]}
[0m19:56:36.881073 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:56:37.107425 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:56:37.355733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:37.357044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:37.455281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22028340-d51d-456d-95b2-176346a0bc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232186F0D00>]}
[0m19:56:37.642922 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:56:37.645915 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:56:37.671672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22028340-d51d-456d-95b2-176346a0bc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002321866F250>]}
[0m19:56:37.672674 [info ] [MainThread]: Found 7 models, 1 snapshot, 2 analyses, 1 seed, 4 data tests, 1 source, 432 macros
[0m19:56:37.673672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22028340-d51d-456d-95b2-176346a0bc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002321867FF10>]}
[0m19:56:37.674672 [info ] [MainThread]: 
[0m19:56:37.675671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:37.676062 [info ] [MainThread]: 
[0m19:56:37.676062 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:56:37.678068 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project'
[0m19:56:37.748087 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project"
[0m19:56:37.748670 [debug] [ThreadPool]: On list_tesla_project: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla_project"'
    
  
  
[0m19:56:37.749675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:37.765184 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m19:56:37.767242 [debug] [ThreadPool]: On list_tesla_project: Close
[0m19:56:37.768254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla_project, now create_tesla_project_main)
[0m19:56:37.769184 [debug] [ThreadPool]: Creating schema "database: "tesla_project"
schema: "main"
"
[0m19:56:37.776190 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:37.777183 [debug] [ThreadPool]: On create_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_project_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla_project'
        and type='sqlite'
    
  
[0m19:56:37.778191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:37.779183 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:56:37.781195 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:37.781195 [debug] [ThreadPool]: On create_tesla_project_main: BEGIN
[0m19:56:37.782183 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:37.783183 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:37.783183 [debug] [ThreadPool]: On create_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_project_main"} */

    
    
        create schema if not exists "tesla_project"."main"
    
[0m19:56:37.784183 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:37.785183 [debug] [ThreadPool]: On create_tesla_project_main: COMMIT
[0m19:56:37.786183 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:37.787182 [debug] [ThreadPool]: On create_tesla_project_main: COMMIT
[0m19:56:37.788184 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:37.788184 [debug] [ThreadPool]: On create_tesla_project_main: Close
[0m19:56:37.794190 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project_main'
[0m19:56:37.799190 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:56:37.799190 [debug] [ThreadPool]: On list_tesla_project_main: BEGIN
[0m19:56:37.800183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:37.801183 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:56:37.801183 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:56:37.802186 [debug] [ThreadPool]: On list_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project_main"} */
select
      'tesla_project' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla_project'
  
[0m19:56:37.813190 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m19:56:37.815192 [debug] [ThreadPool]: On list_tesla_project_main: ROLLBACK
[0m19:56:37.816184 [debug] [ThreadPool]: Failed to rollback 'list_tesla_project_main'
[0m19:56:37.816184 [debug] [ThreadPool]: On list_tesla_project_main: Close
[0m19:56:37.817184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22028340-d51d-456d-95b2-176346a0bc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002321866D810>]}
[0m19:56:37.818184 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:37.819184 [debug] [MainThread]: On master: BEGIN
[0m19:56:37.819184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:37.820190 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:37.821213 [debug] [MainThread]: On master: COMMIT
[0m19:56:37.822183 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:37.822183 [debug] [MainThread]: On master: COMMIT
[0m19:56:37.823183 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:37.824184 [debug] [MainThread]: On master: Close
[0m19:56:37.827183 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_market_intelligence
[0m19:56:37.828183 [info ] [Thread-1 (]: 1 of 1 START sql table model main.tesla_market_intelligence .................... [RUN]
[0m19:56:37.829184 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_market_intelligence'
[0m19:56:37.829184 [debug] [Thread-1 (]: Began compiling node model.project_tesla.tesla_market_intelligence
[0m19:56:37.837198 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.tesla_market_intelligence"
[0m19:56:37.838184 [debug] [Thread-1 (]: Began executing node model.project_tesla.tesla_market_intelligence
[0m19:56:37.863728 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_tesla.tesla_market_intelligence"
[0m19:56:37.865208 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_market_intelligence"
[0m19:56:37.866214 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: BEGIN
[0m19:56:37.866214 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:37.868215 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:37.869216 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_market_intelligence"
[0m19:56:37.869216 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_market_intelligence"} */

  
    
    

    create  table
      "tesla_project"."main"."tesla_market_intelligence__dbt_tmp"
  
    as (
      

with base_vehicles as (
    select * from "tesla_project"."main"."stg_tesla_vehicles"
),

-- Create a "Regional Market Performance" virtual table
regional_markets as (
    select
        country,
        city,
        count(*) as inventory_count,
        round(avg(price), 2) as avg_market_price,
        round(min(price), 2) as min_market_price,
        round(max(price), 2) as max_market_price,
        round(avg(odometer), 2) as avg_mileage,
        count(case when had_accident then 1 end) as accident_vehicles,
        round(count(case when had_accident then 1 end) * 100.0 / nullif(count(*), 0), 2) as accident_rate_pct,
        -- Market tier classification
        case 
            when avg(price) >= 80000 then 'Premium Market'
            when avg(price) >= 50000 then 'Mid-tier Market'
            else 'Entry Market'
        end as market_tier
    from base_vehicles
    where price is not null
    group by country, city
    having count(*) >= 3  -- Only include markets with meaningful inventory
),

-- Create a "Model Performance Metrics" virtual table
model_performance as (
    select
        model,
        trim_name,
        year,
        count(*) as model_inventory,
        round(avg(price), 2) as avg_model_price,
        round(avg(odometer), 2) as avg_model_mileage,
        -- Price depreciation per mile (proxy for value retention)
        case 
            when avg(odometer) > 0 then round((avg(price) / nullif(avg(odometer), 0)) * 1000, 2)
            else null
        end as price_per_1k_miles,
        -- Model condition score
        round((count(*) - count(case when had_accident then 1 end)) * 100.0 / nullif(count(*), 0), 2) as clean_history_pct,
        -- Categorize model popularity
        case 
            when count(*) >= 100 then 'High Volume'
            when count(*) >= 50 then 'Medium Volume'
            when count(*) >= 20 then 'Low Volume'
            else 'Rare'
        end as availability_tier
    from base_vehicles
    where price is not null and model is not null
    group by model, trim_name, year
),

-- Create comprehensive joined analysis
market_intelligence as (
    select
        -- Vehicle details
        v.vin,
        v.model,
        v.trim_name,
        v.year,
        v.price,
        v.odometer,
        v.color,
        v.had_accident,
        v.delivery_date,
        
        -- Regional market context (joined data)
        v.country,
        v.city,
        rm.market_tier,
        rm.inventory_count as city_inventory,
        rm.avg_market_price as city_avg_price,
        rm.accident_rate_pct as city_accident_rate,
        
        -- Model performance context (joined data)
        mp.model_inventory as total_model_inventory,
        mp.avg_model_price,
        mp.avg_model_mileage as model_avg_mileage,
        mp.price_per_1k_miles as model_value_retention,
        mp.clean_history_pct as model_clean_rate,
        mp.availability_tier,
        
        -- Calculated insights from joins
        round(v.price - rm.avg_market_price, 2) as price_vs_market_avg,
        round((v.price - rm.avg_market_price) * 100.0 / nullif(rm.avg_market_price, 0), 2) as price_premium_pct,
        round(v.price - mp.avg_model_price, 2) as price_vs_model_avg,
        round((v.price - mp.avg_model_price) * 100.0 / nullif(mp.avg_model_price, 0), 2) as model_price_variance_pct,
        
        -- Market positioning score (combination of regional and model factors)
        case
            when v.price > rm.avg_market_price and v.price > mp.avg_model_price and not v.had_accident then 'Premium Positioned'
            when v.price < rm.avg_market_price and v.price < mp.avg_model_price then 'Value Opportunity'
            when v.had_accident and v.price < mp.avg_model_price * 0.85 then 'Discounted - Accident History'
            when v.odometer < mp.avg_model_mileage * 0.7 then 'Low Mileage Premium'
            else 'Market Standard'
        end as market_position,
        
        -- Investment score (1-10 scale based on multiple factors)
        least(10, greatest(1, 
            5 +  -- Base score
            case when v.price < rm.avg_market_price then 2 else -1 end +  -- Below market price bonus
            case when v.odometer < mp.avg_model_mileage then 1 else 0 end +  -- Low mileage bonus
            case when not v.had_accident then 1 else -2 end +  -- Clean history bonus
            case when rm.market_tier = 'Premium Market' then 1 else 0 end +  -- Premium market bonus
            case when mp.availability_tier = 'Rare' then 2 else 0 end  -- Rarity bonus
        )) as investment_score
        
    from base_vehicles v
    
    -- Join with regional market data
    left join regional_markets rm
        on v.country = rm.country 
        and v.city = rm.city
    
    -- Join with model performance data  
    left join model_performance mp
        on v.model = mp.model 
        and v.trim_name = mp.trim_name 
        and v.year = mp.year
        
    where v.price is not null
)

select * from market_intelligence
order by investment_score desc, price asc
    );
  
  
[0m19:56:37.872215 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_market_intelligence"} */

  
    
    

    create  table
      "tesla_project"."main"."tesla_market_intelligence__dbt_tmp"
  
    as (
      

with base_vehicles as (
    select * from "tesla_project"."main"."stg_tesla_vehicles"
),

-- Create a "Regional Market Performance" virtual table
regional_markets as (
    select
        country,
        city,
        count(*) as inventory_count,
        round(avg(price), 2) as avg_market_price,
        round(min(price), 2) as min_market_price,
        round(max(price), 2) as max_market_price,
        round(avg(odometer), 2) as avg_mileage,
        count(case when had_accident then 1 end) as accident_vehicles,
        round(count(case when had_accident then 1 end) * 100.0 / nullif(count(*), 0), 2) as accident_rate_pct,
        -- Market tier classification
        case 
            when avg(price) >= 80000 then 'Premium Market'
            when avg(price) >= 50000 then 'Mid-tier Market'
            else 'Entry Market'
        end as market_tier
    from base_vehicles
    where price is not null
    group by country, city
    having count(*) >= 3  -- Only include markets with meaningful inventory
),

-- Create a "Model Performance Metrics" virtual table
model_performance as (
    select
        model,
        trim_name,
        year,
        count(*) as model_inventory,
        round(avg(price), 2) as avg_model_price,
        round(avg(odometer), 2) as avg_model_mileage,
        -- Price depreciation per mile (proxy for value retention)
        case 
            when avg(odometer) > 0 then round((avg(price) / nullif(avg(odometer), 0)) * 1000, 2)
            else null
        end as price_per_1k_miles,
        -- Model condition score
        round((count(*) - count(case when had_accident then 1 end)) * 100.0 / nullif(count(*), 0), 2) as clean_history_pct,
        -- Categorize model popularity
        case 
            when count(*) >= 100 then 'High Volume'
            when count(*) >= 50 then 'Medium Volume'
            when count(*) >= 20 then 'Low Volume'
            else 'Rare'
        end as availability_tier
    from base_vehicles
    where price is not null and model is not null
    group by model, trim_name, year
),

-- Create comprehensive joined analysis
market_intelligence as (
    select
        -- Vehicle details
        v.vin,
        v.model,
        v.trim_name,
        v.year,
        v.price,
        v.odometer,
        v.color,
        v.had_accident,
        v.delivery_date,
        
        -- Regional market context (joined data)
        v.country,
        v.city,
        rm.market_tier,
        rm.inventory_count as city_inventory,
        rm.avg_market_price as city_avg_price,
        rm.accident_rate_pct as city_accident_rate,
        
        -- Model performance context (joined data)
        mp.model_inventory as total_model_inventory,
        mp.avg_model_price,
        mp.avg_model_mileage as model_avg_mileage,
        mp.price_per_1k_miles as model_value_retention,
        mp.clean_history_pct as model_clean_rate,
        mp.availability_tier,
        
        -- Calculated insights from joins
        round(v.price - rm.avg_market_price, 2) as price_vs_market_avg,
        round((v.price - rm.avg_market_price) * 100.0 / nullif(rm.avg_market_price, 0), 2) as price_premium_pct,
        round(v.price - mp.avg_model_price, 2) as price_vs_model_avg,
        round((v.price - mp.avg_model_price) * 100.0 / nullif(mp.avg_model_price, 0), 2) as model_price_variance_pct,
        
        -- Market positioning score (combination of regional and model factors)
        case
            when v.price > rm.avg_market_price and v.price > mp.avg_model_price and not v.had_accident then 'Premium Positioned'
            when v.price < rm.avg_market_price and v.price < mp.avg_model_price then 'Value Opportunity'
            when v.had_accident and v.price < mp.avg_model_price * 0.85 then 'Discounted - Accident History'
            when v.odometer < mp.avg_model_mileage * 0.7 then 'Low Mileage Premium'
            else 'Market Standard'
        end as market_position,
        
        -- Investment score (1-10 scale based on multiple factors)
        least(10, greatest(1, 
            5 +  -- Base score
            case when v.price < rm.avg_market_price then 2 else -1 end +  -- Below market price bonus
            case when v.odometer < mp.avg_model_mileage then 1 else 0 end +  -- Low mileage bonus
            case when not v.had_accident then 1 else -2 end +  -- Clean history bonus
            case when rm.market_tier = 'Premium Market' then 1 else 0 end +  -- Premium market bonus
            case when mp.availability_tier = 'Rare' then 2 else 0 end  -- Rarity bonus
        )) as investment_score
        
    from base_vehicles v
    
    -- Join with regional market data
    left join regional_markets rm
        on v.country = rm.country 
        and v.city = rm.city
    
    -- Join with model performance data  
    left join model_performance mp
        on v.model = mp.model 
        and v.trim_name = mp.trim_name 
        and v.year = mp.year
        
    where v.price is not null
)

select * from market_intelligence
order by investment_score desc, price asc
    );
  
  
[0m19:56:37.874215 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:56:37.875215 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: ROLLBACK
[0m19:56:37.878214 [debug] [Thread-1 (]: Failed to rollback 'model.project_tesla.tesla_market_intelligence'
[0m19:56:37.878214 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: Close
[0m19:56:37.880215 [debug] [Thread-1 (]: Runtime Error in model tesla_market_intelligence (models\marts\tesla_market_intelligence.sql)
  Catalog Error: Table with name stg_tesla_vehicles does not exist!
  Did you mean "tesla_results"?
  
  LINE 14:     select * from "tesla_project"."main"."stg_tesla_vehicles"
                             ^
[0m19:56:37.883228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22028340-d51d-456d-95b2-176346a0bc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023217164E80>]}
[0m19:56:37.884213 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.tesla_market_intelligence ........... [[31mERROR[0m in 0.05s]
[0m19:56:37.885214 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_market_intelligence
[0m19:56:37.886214 [debug] [Thread-4 (]: Marking all children of 'model.project_tesla.tesla_market_intelligence' to be skipped because of status 'error'.  Reason: Runtime Error in model tesla_market_intelligence (models\marts\tesla_market_intelligence.sql)
  Catalog Error: Table with name stg_tesla_vehicles does not exist!
  Did you mean "tesla_results"?
  
  LINE 14:     select * from "tesla_project"."main"."stg_tesla_vehicles"
                             ^.
[0m19:56:37.887214 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:37.888227 [debug] [MainThread]: On master: BEGIN
[0m19:56:37.888227 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:37.889214 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:37.890220 [debug] [MainThread]: On master: COMMIT
[0m19:56:37.890220 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:37.891213 [debug] [MainThread]: On master: COMMIT
[0m19:56:37.891213 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:37.892213 [debug] [MainThread]: On master: Close
[0m19:56:37.892213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:37.893213 [debug] [MainThread]: Connection 'create_tesla_project_main' was properly closed.
[0m19:56:37.893213 [debug] [MainThread]: Connection 'list_tesla_project_main' was properly closed.
[0m19:56:37.894213 [debug] [MainThread]: Connection 'model.project_tesla.tesla_market_intelligence' was properly closed.
[0m19:56:37.894213 [info ] [MainThread]: 
[0m19:56:37.895214 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m19:56:37.896213 [debug] [MainThread]: Command end result
[0m19:56:37.918214 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:56:37.921224 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:56:37.927219 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\run_results.json
[0m19:56:37.928213 [info ] [MainThread]: 
[0m19:56:37.929217 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:56:37.930231 [info ] [MainThread]: 
[0m19:56:37.930231 [error] [MainThread]: [31mFailure in model tesla_market_intelligence (models\marts\tesla_market_intelligence.sql)[0m
[0m19:56:37.931225 [error] [MainThread]:   Runtime Error in model tesla_market_intelligence (models\marts\tesla_market_intelligence.sql)
  Catalog Error: Table with name stg_tesla_vehicles does not exist!
  Did you mean "tesla_results"?
  
  LINE 14:     select * from "tesla_project"."main"."stg_tesla_vehicles"
                             ^
[0m19:56:37.932214 [info ] [MainThread]: 
[0m19:56:37.933213 [info ] [MainThread]:   compiled code at target\compiled\project_tesla\models\marts\tesla_market_intelligence.sql
[0m19:56:37.933213 [info ] [MainThread]: 
[0m19:56:37.934231 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:56:37.935234 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:56:37.936216 [debug] [MainThread]: Command `dbt run` failed at 19:56:37.936216 after 1.62 seconds
[0m19:56:37.937215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023215C83250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023216DEFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023218578640>]}
[0m19:56:37.937215 [debug] [MainThread]: Flushing usage events
[0m19:56:38.388839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:48.357481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FAF93280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FC350D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FC350B50>]}


============================== 19:56:48.361494 | c5ccca7a-9453-4e2f-8b9c-261685630bb7 ==============================
[0m19:56:48.361494 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:56:48.362494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla_sql\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_tesla_vehicles', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:56:48.703230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5ccca7a-9453-4e2f-8b9c-261685630bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FC277D00>]}
[0m19:56:48.781783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5ccca7a-9453-4e2f-8b9c-261685630bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FBA37DF0>]}
[0m19:56:48.785781 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:56:49.007748 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:56:49.208839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:49.208839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:49.286389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5ccca7a-9453-4e2f-8b9c-261685630bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FDA00BE0>]}
[0m19:56:49.440918 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:56:49.442929 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:56:49.465761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5ccca7a-9453-4e2f-8b9c-261685630bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FD9BE6E0>]}
[0m19:56:49.466837 [info ] [MainThread]: Found 7 models, 1 snapshot, 2 analyses, 1 seed, 4 data tests, 1 source, 432 macros
[0m19:56:49.467372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5ccca7a-9453-4e2f-8b9c-261685630bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FD8BA440>]}
[0m19:56:49.469194 [info ] [MainThread]: 
[0m19:56:49.469714 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:49.470238 [info ] [MainThread]: 
[0m19:56:49.471292 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:56:49.472871 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project'
[0m19:56:49.545840 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project"
[0m19:56:49.546843 [debug] [ThreadPool]: On list_tesla_project: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla_project"'
    
  
  
[0m19:56:49.546843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:49.561842 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m19:56:49.563843 [debug] [ThreadPool]: On list_tesla_project: Close
[0m19:56:49.564685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla_project, now create_tesla_project_main)
[0m19:56:49.564685 [debug] [ThreadPool]: Creating schema "database: "tesla_project"
schema: "main"
"
[0m19:56:49.570691 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:49.571691 [debug] [ThreadPool]: On create_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_project_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla_project'
        and type='sqlite'
    
  
[0m19:56:49.571691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:49.572691 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:56:49.573691 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:49.573691 [debug] [ThreadPool]: On create_tesla_project_main: BEGIN
[0m19:56:49.574691 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:49.574691 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:49.575691 [debug] [ThreadPool]: On create_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_project_main"} */

    
    
        create schema if not exists "tesla_project"."main"
    
[0m19:56:49.575691 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:49.576691 [debug] [ThreadPool]: On create_tesla_project_main: COMMIT
[0m19:56:49.576691 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:49.577691 [debug] [ThreadPool]: On create_tesla_project_main: COMMIT
[0m19:56:49.577691 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:49.577691 [debug] [ThreadPool]: On create_tesla_project_main: Close
[0m19:56:49.583829 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project_main'
[0m19:56:49.588918 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:56:49.588918 [debug] [ThreadPool]: On list_tesla_project_main: BEGIN
[0m19:56:49.588918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:49.589908 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:56:49.589908 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:56:49.590906 [debug] [ThreadPool]: On list_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project_main"} */
select
      'tesla_project' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla_project'
  
[0m19:56:49.600913 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m19:56:49.602843 [debug] [ThreadPool]: On list_tesla_project_main: ROLLBACK
[0m19:56:49.603838 [debug] [ThreadPool]: Failed to rollback 'list_tesla_project_main'
[0m19:56:49.603838 [debug] [ThreadPool]: On list_tesla_project_main: Close
[0m19:56:49.604847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5ccca7a-9453-4e2f-8b9c-261685630bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FC4F02B0>]}
[0m19:56:49.605838 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:49.605838 [debug] [MainThread]: On master: BEGIN
[0m19:56:49.606862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:49.606862 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:49.607845 [debug] [MainThread]: On master: COMMIT
[0m19:56:49.607845 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:49.607845 [debug] [MainThread]: On master: COMMIT
[0m19:56:49.608844 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:49.608844 [debug] [MainThread]: On master: Close
[0m19:56:49.613836 [debug] [Thread-1 (]: Began running node model.project_tesla.stg_tesla_vehicles
[0m19:56:49.613836 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_tesla_vehicles ............................ [RUN]
[0m19:56:49.614844 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.project_tesla.stg_tesla_vehicles'
[0m19:56:49.615845 [debug] [Thread-1 (]: Began compiling node model.project_tesla.stg_tesla_vehicles
[0m19:56:49.621845 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.stg_tesla_vehicles"
[0m19:56:49.622844 [debug] [Thread-1 (]: Began executing node model.project_tesla.stg_tesla_vehicles
[0m19:56:49.646843 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_tesla.stg_tesla_vehicles"
[0m19:56:49.648844 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m19:56:49.649848 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: BEGIN
[0m19:56:49.649848 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:49.650844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:49.650844 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m19:56:49.651846 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.stg_tesla_vehicles"} */

  
  create view "tesla_project"."main"."stg_tesla_vehicles__dbt_tmp" as (
    

with source_data as (
    select * from "tesla_project"."main"."tesla_results"
),

staged as (
    select
        -- Basic vehicle information
        trim(model) as model,
        trim(trim_name) as trim_name,
        year,
        vin,
        
        -- Location information
        trim(country) as country,
        trim(country_code) as country_code,
        trim(city) as city,
        
        -- Price and metrics
        -- Extract numeric price from string
        regexp_extract(price, '[0-9]+') as price_str,
        try_cast(regexp_extract(price, '[0-9]+') as float) as price,
        try_cast(odometer as float) as odometer,
        
        -- Dates
        try_cast(original_delivery_date as timestamp) as delivery_date,
        try_cast(battery_warranty_exp_date as timestamp) as warranty_expiry_date,
        "current_time" as record_time_str,
        
        -- Additional attributes
        trim(color) as color,
        trim(vehicle_history) as vehicle_history,
        case 
            when vehicle_history is null then false
            when lower(vehicle_history) like '%accident%' then true
            else false
        end as had_accident,
        
        -- Status flags
        in_transit,
        trim(cpo_refurbishment_status) as refurbishment_status
    from source_data
)

select * from staged
  );

[0m19:56:49.655134 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:56:49.660139 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m19:56:49.661139 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.stg_tesla_vehicles"} */
alter view "tesla_project"."main"."stg_tesla_vehicles__dbt_tmp" rename to "stg_tesla_vehicles"
[0m19:56:49.662209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:49.669277 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: COMMIT
[0m19:56:49.670357 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m19:56:49.670357 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: COMMIT
[0m19:56:49.675283 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:56:49.679795 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.stg_tesla_vehicles"
[0m19:56:49.680815 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.stg_tesla_vehicles"} */
drop view if exists "tesla_project"."main"."stg_tesla_vehicles__dbt_backup" cascade
[0m19:56:49.681991 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:49.684060 [debug] [Thread-1 (]: On model.project_tesla.stg_tesla_vehicles: Close
[0m19:56:49.686047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5ccca7a-9453-4e2f-8b9c-261685630bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FC3FEEC0>]}
[0m19:56:49.687029 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_tesla_vehicles ....................... [[32mOK[0m in 0.07s]
[0m19:56:49.688998 [debug] [Thread-1 (]: Finished running node model.project_tesla.stg_tesla_vehicles
[0m19:56:49.689998 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:49.689998 [debug] [MainThread]: On master: BEGIN
[0m19:56:49.690999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:49.690999 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:49.691999 [debug] [MainThread]: On master: COMMIT
[0m19:56:49.691999 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:49.691999 [debug] [MainThread]: On master: COMMIT
[0m19:56:49.692999 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:49.692999 [debug] [MainThread]: On master: Close
[0m19:56:49.693998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:49.693998 [debug] [MainThread]: Connection 'create_tesla_project_main' was properly closed.
[0m19:56:49.693998 [debug] [MainThread]: Connection 'list_tesla_project_main' was properly closed.
[0m19:56:49.694999 [debug] [MainThread]: Connection 'model.project_tesla.stg_tesla_vehicles' was properly closed.
[0m19:56:49.694999 [info ] [MainThread]: 
[0m19:56:49.695998 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m19:56:49.696998 [debug] [MainThread]: Command end result
[0m19:56:49.718014 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:56:49.721005 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:56:49.726999 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\run_results.json
[0m19:56:49.727999 [info ] [MainThread]: 
[0m19:56:49.727999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:49.729380 [info ] [MainThread]: 
[0m19:56:49.729883 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:56:49.730887 [debug] [MainThread]: Command `dbt run` succeeded at 19:56:49.730887 after 1.47 seconds
[0m19:56:49.731887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FAF93280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FC277730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FC3D6080>]}
[0m19:56:49.731887 [debug] [MainThread]: Flushing usage events
[0m19:56:50.165367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:56.785881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2BA7E7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2BCB70C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2BCB70A30>]}


============================== 19:56:56.789622 | 6137680a-f699-41ad-8468-4d43a7f5538c ==============================
[0m19:56:56.789622 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:56:56.790686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla_sql\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select tesla_market_intelligence', 'send_anonymous_usage_stats': 'True'}
[0m19:56:57.120619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6137680a-f699-41ad-8468-4d43a7f5538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B98855D0>]}
[0m19:56:57.196883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6137680a-f699-41ad-8468-4d43a7f5538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2BC2A9720>]}
[0m19:56:57.199920 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:56:57.435551 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:56:57.634649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:57.634649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:57.713194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6137680a-f699-41ad-8468-4d43a7f5538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2BE220A90>]}
[0m19:56:57.871882 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:56:57.873883 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:56:57.896209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6137680a-f699-41ad-8468-4d43a7f5538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2BE1DFB80>]}
[0m19:56:57.896209 [info ] [MainThread]: Found 7 models, 1 snapshot, 2 analyses, 1 seed, 4 data tests, 1 source, 432 macros
[0m19:56:57.897362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6137680a-f699-41ad-8468-4d43a7f5538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2BCD12F20>]}
[0m19:56:57.898417 [info ] [MainThread]: 
[0m19:56:57.899452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:57.900369 [info ] [MainThread]: 
[0m19:56:57.900369 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:56:57.902369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project'
[0m19:56:57.976662 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project"
[0m19:56:57.977202 [debug] [ThreadPool]: On list_tesla_project: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"tesla_project"'
    
  
  
[0m19:56:57.977730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:58.003012 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:56:58.004090 [debug] [ThreadPool]: On list_tesla_project: Close
[0m19:56:58.005176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tesla_project, now create_tesla_project_main)
[0m19:56:58.005709 [debug] [ThreadPool]: Creating schema "database: "tesla_project"
schema: "main"
"
[0m19:56:58.012686 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:58.013211 [debug] [ThreadPool]: On create_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_project_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='tesla_project'
        and type='sqlite'
    
  
[0m19:56:58.013739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:58.014805 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:56:58.015859 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:58.016384 [debug] [ThreadPool]: On create_tesla_project_main: BEGIN
[0m19:56:58.016910 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:58.017443 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:58.017443 [debug] [ThreadPool]: On create_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "create_tesla_project_main"} */

    
    
        create schema if not exists "tesla_project"."main"
    
[0m19:56:58.018498 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:58.019008 [debug] [ThreadPool]: On create_tesla_project_main: COMMIT
[0m19:56:58.019529 [debug] [ThreadPool]: Using duckdb connection "create_tesla_project_main"
[0m19:56:58.020066 [debug] [ThreadPool]: On create_tesla_project_main: COMMIT
[0m19:56:58.020591 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:58.021123 [debug] [ThreadPool]: On create_tesla_project_main: Close
[0m19:56:58.026671 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project_main'
[0m19:56:58.031990 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:56:58.032516 [debug] [ThreadPool]: On list_tesla_project_main: BEGIN
[0m19:56:58.033067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:58.033592 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:56:58.034131 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:56:58.034131 [debug] [ThreadPool]: On list_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project_main"} */
select
      'tesla_project' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla_project'
  
[0m19:56:58.045715 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m19:56:58.047339 [debug] [ThreadPool]: On list_tesla_project_main: ROLLBACK
[0m19:56:58.047882 [debug] [ThreadPool]: Failed to rollback 'list_tesla_project_main'
[0m19:56:58.048408 [debug] [ThreadPool]: On list_tesla_project_main: Close
[0m19:56:58.049538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6137680a-f699-41ad-8468-4d43a7f5538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2BCCA3610>]}
[0m19:56:58.050057 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:58.050703 [debug] [MainThread]: On master: BEGIN
[0m19:56:58.051233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:58.051880 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:58.052396 [debug] [MainThread]: On master: COMMIT
[0m19:56:58.052396 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:58.052944 [debug] [MainThread]: On master: COMMIT
[0m19:56:58.053458 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:58.053997 [debug] [MainThread]: On master: Close
[0m19:56:58.056711 [debug] [Thread-1 (]: Began running node model.project_tesla.tesla_market_intelligence
[0m19:56:58.057730 [info ] [Thread-1 (]: 1 of 1 START sql table model main.tesla_market_intelligence .................... [RUN]
[0m19:56:58.058698 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.project_tesla.tesla_market_intelligence'
[0m19:56:58.059210 [debug] [Thread-1 (]: Began compiling node model.project_tesla.tesla_market_intelligence
[0m19:56:58.066224 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_tesla.tesla_market_intelligence"
[0m19:56:58.067224 [debug] [Thread-1 (]: Began executing node model.project_tesla.tesla_market_intelligence
[0m19:56:58.094454 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_tesla.tesla_market_intelligence"
[0m19:56:58.095449 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_market_intelligence"
[0m19:56:58.096449 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: BEGIN
[0m19:56:58.096449 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:58.097449 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:58.098448 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_market_intelligence"
[0m19:56:58.098448 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_market_intelligence"} */

  
    
    

    create  table
      "tesla_project"."main"."tesla_market_intelligence__dbt_tmp"
  
    as (
      

with base_vehicles as (
    select * from "tesla_project"."main"."stg_tesla_vehicles"
),

-- Create a "Regional Market Performance" virtual table
regional_markets as (
    select
        country,
        city,
        count(*) as inventory_count,
        round(avg(price), 2) as avg_market_price,
        round(min(price), 2) as min_market_price,
        round(max(price), 2) as max_market_price,
        round(avg(odometer), 2) as avg_mileage,
        count(case when had_accident then 1 end) as accident_vehicles,
        round(count(case when had_accident then 1 end) * 100.0 / nullif(count(*), 0), 2) as accident_rate_pct,
        -- Market tier classification
        case 
            when avg(price) >= 80000 then 'Premium Market'
            when avg(price) >= 50000 then 'Mid-tier Market'
            else 'Entry Market'
        end as market_tier
    from base_vehicles
    where price is not null
    group by country, city
    having count(*) >= 3  -- Only include markets with meaningful inventory
),

-- Create a "Model Performance Metrics" virtual table
model_performance as (
    select
        model,
        trim_name,
        year,
        count(*) as model_inventory,
        round(avg(price), 2) as avg_model_price,
        round(avg(odometer), 2) as avg_model_mileage,
        -- Price depreciation per mile (proxy for value retention)
        case 
            when avg(odometer) > 0 then round((avg(price) / nullif(avg(odometer), 0)) * 1000, 2)
            else null
        end as price_per_1k_miles,
        -- Model condition score
        round((count(*) - count(case when had_accident then 1 end)) * 100.0 / nullif(count(*), 0), 2) as clean_history_pct,
        -- Categorize model popularity
        case 
            when count(*) >= 100 then 'High Volume'
            when count(*) >= 50 then 'Medium Volume'
            when count(*) >= 20 then 'Low Volume'
            else 'Rare'
        end as availability_tier
    from base_vehicles
    where price is not null and model is not null
    group by model, trim_name, year
),

-- Create comprehensive joined analysis
market_intelligence as (
    select
        -- Vehicle details
        v.vin,
        v.model,
        v.trim_name,
        v.year,
        v.price,
        v.odometer,
        v.color,
        v.had_accident,
        v.delivery_date,
        
        -- Regional market context (joined data)
        v.country,
        v.city,
        rm.market_tier,
        rm.inventory_count as city_inventory,
        rm.avg_market_price as city_avg_price,
        rm.accident_rate_pct as city_accident_rate,
        
        -- Model performance context (joined data)
        mp.model_inventory as total_model_inventory,
        mp.avg_model_price,
        mp.avg_model_mileage as model_avg_mileage,
        mp.price_per_1k_miles as model_value_retention,
        mp.clean_history_pct as model_clean_rate,
        mp.availability_tier,
        
        -- Calculated insights from joins
        round(v.price - rm.avg_market_price, 2) as price_vs_market_avg,
        round((v.price - rm.avg_market_price) * 100.0 / nullif(rm.avg_market_price, 0), 2) as price_premium_pct,
        round(v.price - mp.avg_model_price, 2) as price_vs_model_avg,
        round((v.price - mp.avg_model_price) * 100.0 / nullif(mp.avg_model_price, 0), 2) as model_price_variance_pct,
        
        -- Market positioning score (combination of regional and model factors)
        case
            when v.price > rm.avg_market_price and v.price > mp.avg_model_price and not v.had_accident then 'Premium Positioned'
            when v.price < rm.avg_market_price and v.price < mp.avg_model_price then 'Value Opportunity'
            when v.had_accident and v.price < mp.avg_model_price * 0.85 then 'Discounted - Accident History'
            when v.odometer < mp.avg_model_mileage * 0.7 then 'Low Mileage Premium'
            else 'Market Standard'
        end as market_position,
        
        -- Investment score (1-10 scale based on multiple factors)
        least(10, greatest(1, 
            5 +  -- Base score
            case when v.price < rm.avg_market_price then 2 else -1 end +  -- Below market price bonus
            case when v.odometer < mp.avg_model_mileage then 1 else 0 end +  -- Low mileage bonus
            case when not v.had_accident then 1 else -2 end +  -- Clean history bonus
            case when rm.market_tier = 'Premium Market' then 1 else 0 end +  -- Premium market bonus
            case when mp.availability_tier = 'Rare' then 2 else 0 end  -- Rarity bonus
        )) as investment_score
        
    from base_vehicles v
    
    -- Join with regional market data
    left join regional_markets rm
        on v.country = rm.country 
        and v.city = rm.city
    
    -- Join with model performance data  
    left join model_performance mp
        on v.model = mp.model 
        and v.trim_name = mp.trim_name 
        and v.year = mp.year
        
    where v.price is not null
)

select * from market_intelligence
order by investment_score desc, price asc
    );
  
  
[0m19:56:58.889885 [debug] [Thread-1 (]: SQL status: OK in 0.790 seconds
[0m19:56:58.896433 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_market_intelligence"
[0m19:56:58.897441 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_market_intelligence"} */
alter table "tesla_project"."main"."tesla_market_intelligence__dbt_tmp" rename to "tesla_market_intelligence"
[0m19:56:58.899423 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:58.911424 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: COMMIT
[0m19:56:58.911424 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_market_intelligence"
[0m19:56:58.912425 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: COMMIT
[0m19:56:58.936848 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m19:56:58.942754 [debug] [Thread-1 (]: Using duckdb connection "model.project_tesla.tesla_market_intelligence"
[0m19:56:58.943427 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "node_id": "model.project_tesla.tesla_market_intelligence"} */
drop table if exists "tesla_project"."main"."tesla_market_intelligence__dbt_backup" cascade
[0m19:56:58.944482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:58.946594 [debug] [Thread-1 (]: On model.project_tesla.tesla_market_intelligence: Close
[0m19:56:58.948718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6137680a-f699-41ad-8468-4d43a7f5538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B8C4F790>]}
[0m19:56:58.949786 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.tesla_market_intelligence ............... [[32mOK[0m in 0.89s]
[0m19:56:58.950837 [debug] [Thread-1 (]: Finished running node model.project_tesla.tesla_market_intelligence
[0m19:56:58.951886 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:58.952401 [debug] [MainThread]: On master: BEGIN
[0m19:56:58.952917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:58.953456 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:56:58.953979 [debug] [MainThread]: On master: COMMIT
[0m19:56:58.954522 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:58.954522 [debug] [MainThread]: On master: COMMIT
[0m19:56:58.955073 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:58.955615 [debug] [MainThread]: On master: Close
[0m19:56:58.956137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:58.956679 [debug] [MainThread]: Connection 'create_tesla_project_main' was properly closed.
[0m19:56:58.956679 [debug] [MainThread]: Connection 'list_tesla_project_main' was properly closed.
[0m19:56:58.957221 [debug] [MainThread]: Connection 'model.project_tesla.tesla_market_intelligence' was properly closed.
[0m19:56:58.957757 [info ] [MainThread]: 
[0m19:56:58.958301 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m19:56:58.959399 [debug] [MainThread]: Command end result
[0m19:56:58.981589 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:56:58.983702 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:56:58.990209 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\run_results.json
[0m19:56:58.990725 [info ] [MainThread]: 
[0m19:56:58.991773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:58.992835 [info ] [MainThread]: 
[0m19:56:58.993368 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:56:58.994958 [debug] [MainThread]: Command `dbt run` succeeded at 19:56:58.994958 after 2.30 seconds
[0m19:56:58.995511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2BA7E7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B98855D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2BC27FB20>]}
[0m19:56:58.996074 [debug] [MainThread]: Flushing usage events
[0m19:56:59.396688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:29.489008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ECB53220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EDF08CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EDF08AF0>]}


============================== 19:57:29.493008 | 3bf120ec-1fcb-4a55-9083-06966dfdd348 ==============================
[0m19:57:29.493008 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:57:29.493008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla_sql\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile --select analyses/top_investment_opportunities.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:29.815654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bf120ec-1fcb-4a55-9083-06966dfdd348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EE036FE0>]}
[0m19:57:29.883204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bf120ec-1fcb-4a55-9083-06966dfdd348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EDF0A710>]}
[0m19:57:29.885196 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:57:30.101839 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:57:30.347453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:57:30.348454 [debug] [MainThread]: Partial parsing: added file: project_tesla://analyses\top_investment_opportunities.sql
[0m19:57:30.639068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bf120ec-1fcb-4a55-9083-06966dfdd348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E9FD3DF0>]}
[0m19:57:30.770940 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:57:30.772947 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:57:30.794539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bf120ec-1fcb-4a55-9083-06966dfdd348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EE0B1570>]}
[0m19:57:30.795540 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 analyses, 1 seed, 4 data tests, 1 source, 432 macros
[0m19:57:30.796540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bf120ec-1fcb-4a55-9083-06966dfdd348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EF5DEF50>]}
[0m19:57:30.798540 [info ] [MainThread]: 
[0m19:57:30.799025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:30.799575 [info ] [MainThread]: 
[0m19:57:30.799575 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:57:30.805579 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project_main'
[0m19:57:30.874268 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:57:30.875269 [debug] [ThreadPool]: On list_tesla_project_main: BEGIN
[0m19:57:30.875269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:30.900857 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m19:57:30.901859 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:57:30.901859 [debug] [ThreadPool]: On list_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project_main"} */
select
      'tesla_project' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla_project'
  
[0m19:57:30.912858 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m19:57:30.914859 [debug] [ThreadPool]: On list_tesla_project_main: ROLLBACK
[0m19:57:30.915858 [debug] [ThreadPool]: Failed to rollback 'list_tesla_project_main'
[0m19:57:30.915858 [debug] [ThreadPool]: On list_tesla_project_main: Close
[0m19:57:30.916935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bf120ec-1fcb-4a55-9083-06966dfdd348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EB6A3E80>]}
[0m19:57:30.922536 [debug] [Thread-1 (]: Began running node analysis.project_tesla.top_investment_opportunities
[0m19:57:30.923542 [debug] [Thread-1 (]: Acquiring new duckdb connection 'analysis.project_tesla.top_investment_opportunities'
[0m19:57:30.923542 [debug] [Thread-1 (]: Began compiling node analysis.project_tesla.top_investment_opportunities
[0m19:57:30.929542 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.project_tesla.top_investment_opportunities"
[0m19:57:30.930542 [debug] [Thread-1 (]: Began executing node analysis.project_tesla.top_investment_opportunities
[0m19:57:30.931557 [debug] [Thread-1 (]: Finished running node analysis.project_tesla.top_investment_opportunities
[0m19:57:30.932536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:30.932536 [debug] [MainThread]: Connection 'list_tesla_project_main' was properly closed.
[0m19:57:30.932536 [debug] [MainThread]: Connection 'analysis.project_tesla.top_investment_opportunities' was properly closed.
[0m19:57:30.933539 [debug] [MainThread]: Command end result
[0m19:57:30.955537 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:57:30.957540 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:57:30.964546 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\run_results.json
[0m19:57:30.965544 [info ] [MainThread]: Compiled node 'top_investment_opportunities' is:
-- Top 10 Tesla vehicles by investment score with market intelligence
select 
    vin,
    model,
    trim_name,
    year,
    price,
    country,
    city,
    market_tier,
    investment_score,
    market_position,
    price_vs_market_avg,
    price_premium_pct
from tesla_market_intelligence 
order by investment_score desc 
limit 10
[0m19:57:30.966543 [debug] [MainThread]: Command `dbt compile` succeeded at 19:57:30.966543 after 1.56 seconds
[0m19:57:30.967544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ECB53220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ECE7CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EF6DD900>]}
[0m19:57:30.967544 [debug] [MainThread]: Flushing usage events
[0m19:57:31.377633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:49.425437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F29A3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F3D60D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F3D60B80>]}


============================== 19:57:49.429676 | 50cd70f8-2db6-4c0d-92ab-e2c5b1568bad ==============================
[0m19:57:49.429676 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:57:49.430681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla_sql\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt compile --select analyses/join_analysis_demonstration.sql', 'send_anonymous_usage_stats': 'True'}
[0m19:57:49.761719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50cd70f8-2db6-4c0d-92ab-e2c5b1568bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F3F02E60>]}
[0m19:57:49.832298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50cd70f8-2db6-4c0d-92ab-e2c5b1568bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F3D1C2B0>]}
[0m19:57:49.834299 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:57:50.040620 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:57:50.290826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:57:50.291800 [debug] [MainThread]: Partial parsing: added file: project_tesla://analyses\join_analysis_demonstration.sql
[0m19:57:50.614175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50cd70f8-2db6-4c0d-92ab-e2c5b1568bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F54AC0D0>]}
[0m19:57:50.738233 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:57:50.740225 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:57:50.764224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50cd70f8-2db6-4c0d-92ab-e2c5b1568bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F54AE740>]}
[0m19:57:50.765224 [info ] [MainThread]: Found 7 models, 1 snapshot, 4 analyses, 1 seed, 4 data tests, 1 source, 432 macros
[0m19:57:50.766224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50cd70f8-2db6-4c0d-92ab-e2c5b1568bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F54907C0>]}
[0m19:57:50.768224 [info ] [MainThread]: 
[0m19:57:50.768224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:50.769224 [info ] [MainThread]: 
[0m19:57:50.770233 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:57:50.776224 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_tesla_project_main'
[0m19:57:50.844870 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:57:50.845876 [debug] [ThreadPool]: On list_tesla_project_main: BEGIN
[0m19:57:50.845876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:50.859877 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m19:57:50.860869 [debug] [ThreadPool]: Using duckdb connection "list_tesla_project_main"
[0m19:57:50.860869 [debug] [ThreadPool]: On list_tesla_project_main: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "project_tesla", "target_name": "dev", "connection_name": "list_tesla_project_main"} */
select
      'tesla_project' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'tesla_project'
  
[0m19:57:50.872882 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m19:57:50.873880 [debug] [ThreadPool]: On list_tesla_project_main: ROLLBACK
[0m19:57:50.874890 [debug] [ThreadPool]: Failed to rollback 'list_tesla_project_main'
[0m19:57:50.874890 [debug] [ThreadPool]: On list_tesla_project_main: Close
[0m19:57:50.876871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50cd70f8-2db6-4c0d-92ab-e2c5b1568bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F54AC910>]}
[0m19:57:50.881304 [debug] [Thread-1 (]: Began running node analysis.project_tesla.join_analysis_demonstration
[0m19:57:50.881304 [debug] [Thread-1 (]: Acquiring new duckdb connection 'analysis.project_tesla.join_analysis_demonstration'
[0m19:57:50.882307 [debug] [Thread-1 (]: Began compiling node analysis.project_tesla.join_analysis_demonstration
[0m19:57:50.887302 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.project_tesla.join_analysis_demonstration"
[0m19:57:50.889294 [debug] [Thread-1 (]: Began executing node analysis.project_tesla.join_analysis_demonstration
[0m19:57:50.890304 [debug] [Thread-1 (]: Finished running node analysis.project_tesla.join_analysis_demonstration
[0m19:57:50.891294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:50.891294 [debug] [MainThread]: Connection 'list_tesla_project_main' was properly closed.
[0m19:57:50.892293 [debug] [MainThread]: Connection 'analysis.project_tesla.join_analysis_demonstration' was properly closed.
[0m19:57:50.892293 [debug] [MainThread]: Command end result
[0m19:57:50.914307 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\manifest.json
[0m19:57:50.917298 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\semantic_manifest.json
[0m19:57:50.925299 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\tanis\dbt-practice-tk\dbt-practice-tk\project_tesla_sql\target\run_results.json
[0m19:57:50.925299 [info ] [MainThread]: Compiled node 'join_analysis_demonstration' is:
-- Demonstration of join effects: Show how individual vehicles compare to both regional and model averages
select 
    model,
    trim_name,
    country,
    city,
    count(*) as vehicles_in_analysis,
    round(avg(price), 0) as individual_avg_price,
    round(avg(city_avg_price), 0) as regional_market_avg,
    round(avg(avg_model_price), 0) as model_type_avg,
    round(avg(price_vs_market_avg), 0) as avg_premium_vs_regional,
    round(avg(price_vs_model_avg), 0) as avg_premium_vs_model,
    string_agg(distinct market_tier, ', ') as market_tiers,
    string_agg(distinct availability_tier, ', ') as model_rarity
from tesla_market_intelligence 
where city_avg_price is not null and avg_model_price is not null
group by model, trim_name, country, city
having count(*) >= 2
order by avg(investment_score) desc
limit 15
[0m19:57:50.927809 [debug] [MainThread]: Command `dbt compile` succeeded at 19:57:50.926298 after 1.60 seconds
[0m19:57:50.927809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F29A3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F2CD01F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F3FCCC70>]}
[0m19:57:50.928813 [debug] [MainThread]: Flushing usage events
[0m19:57:51.328715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:02.333716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F903A07160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F904DC8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F904DC8A30>]}


============================== 20:08:02.337721 | d39c95c5-03a9-4f26-9858-2e03a6c6f662 ==============================
[0m20:08:02.337721 [info ] [MainThread]: Running with dbt=1.10.2
[0m20:08:02.337721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\tanis\\.dbt', 'log_path': 'C:\\Users\\tanis\\dbt-practice-tk\\dbt-practice-tk\\project_tesla_sql\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:08:02.651215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd39c95c5-03a9-4f26-9858-2e03a6c6f662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F900F028C0>]}
[0m20:08:02.723664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd39c95c5-03a9-4f26-9858-2e03a6c6f662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F904D8DB40>]}
